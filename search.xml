<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/post/HelloWorld/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>杂物间</category>
      </categories>
  </entry>
  <entry>
    <title>flask实战</title>
    <url>/post/backEnd/flask%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<blockquote>
<p>💡 学习flask是因为大创，需求是接收微信小程序发送来的音频，而后由学长的算法对该音频进行分析。</p>
</blockquote>
<h1 id="后端接收文件上传"><a href="#后端接收文件上传" class="headerlink" title="后端接收文件上传"></a>后端接收文件上传</h1><p>原生flask使用的是request包</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        file = request.files[<span class="string">&#x27;the_file&#x27;</span>]</span><br><span class="line">        file.save(<span class="string">f&quot;/var/www/uploads/<span class="subst">&#123;secure_filename(file.filename)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>但尝试这样接收小程序上传的文件时，报错</p>
<p><strong><code>&#39;Request&#39; object has no attribute &#39;File&#39;</code></strong></p>
<p>经过搜索得知，微信小程序的文件被包裹在FileField中，无法靠Request.file检索</p>
<p>要处理FileField式的文件上传，需要使用另外两个包</p>
<p>教程见 <a href="https://www.section.io/engineering-education/how-to-handle-file-uploads-with-flask/">How to Handle File Uploads with Flask</a> </p>
<p>我最终的代码如下, flask确实轻量，只用了30行不到</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm</span><br><span class="line"><span class="keyword">from</span> flask_wtf.file <span class="keyword">import</span> FileField</span><br><span class="line"><span class="keyword">from</span> flask_uploads <span class="keyword">import</span> configure_uploads,UploadSet,AUDIO</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># 进入调试模式</span></span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line"><span class="comment">#必须以UPLOADED_XXX_DEST的形式设置文件存放的地址，XXX取决于UploadSet的变量名大写形式</span></span><br><span class="line">app.config[<span class="string">&#x27;UPLOADED_SOUNDS_DEST&#x27;</span>] = <span class="string">&#x27;./uploads&#x27;</span></span><br><span class="line"><span class="comment">#必须设置密匙，否则会报跨域错误</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;heyheyhey&#x27;</span></span><br><span class="line"><span class="comment"># UploadSet的第二个参数取决于上传文件的形式，有哪些形式请自行翻看源码</span></span><br><span class="line">sounds = UploadSet(<span class="string">&#x27;sounds&#x27;</span>,AUDIO)</span><br><span class="line">configure_uploads(app,sounds)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    sound = FileField(<span class="string">&#x27;sound&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/upload2&quot;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    form = MyForm()</span><br><span class="line">    filename = sounds.save(form.sound.data)</span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>后端</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>后端</tag>
        <tag>flask</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>flask的学习—文档</title>
    <url>/post/backEnd/flask%E7%9A%84%E5%AD%A6%E4%B9%A0%E2%80%94%E6%96%87%E6%A1%A3/</url>
    <content><![CDATA[<blockquote>
<p>💡 出于大创的需要，跑去看了一下flask的官方文档，并且简单记录了一下。不过现在回过头看发现好像只是把标题翻译了一下。这种记录似乎没啥意义，可能还是先跟着实战教程跑，跑的过程中记录自己遇到的问题以及解决问题的文档好一点</p>
</blockquote>
<h1 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install flask</span><br></pre></td></tr></table></figure>

<p>基本示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/hello&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;p&gt;Hello, World!&lt;/p&gt;&quot;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Index Page&#x27;</span></span><br></pre></td></tr></table></figure>

<p>启动项目：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">//方法1：</span><br><span class="line">//将application实例所在文件命名为app.py, 而后在终端中执行</span><br><span class="line">$ flask run</span><br><span class="line"></span><br><span class="line">//方法2：</span><br><span class="line">//application实例的所在的文件名为name.py或wsgi.py，则在终端中执行</span><br><span class="line">$ flask --app name run</span><br></pre></td></tr></table></figure>

<p>将项目部署到局域网</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ flask --app name run --host=0.0.0.0</span><br></pre></td></tr></table></figure>

<h1 id="路由设置"><a href="#路由设置" class="headerlink" title="路由设置"></a>路由设置</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#访问/projects/ 或者 /projects 都行</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/projects/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">projects</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;The project page&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#只能访问/about, 访问/about/报错</span></span><br><span class="line"><span class="comment">#据说有助于保持这些资源的URL唯一</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/about&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">about</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;The about page&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> markupsafe <span class="keyword">import</span> escape</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_user_profile</span>(<span class="params">username</span>):</span><br><span class="line">    <span class="comment"># show the user profile for that user</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;User <span class="subst">&#123;escape(username)&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#规定可变部分的类型</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/post/&lt;int:post_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_post</span>(<span class="params">post_id</span>):</span><br><span class="line">    <span class="comment"># show the post with the given id, the id is an integer</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;Post <span class="subst">&#123;post_id&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/path/&lt;path:subpath&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_subpath</span>(<span class="params">subpath</span>):</span><br><span class="line">    <span class="comment"># show the subpath after /path/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;Subpath <span class="subst">&#123;escape(subpath)&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#escape是一个用来防止前端注入的函数</span></span><br><span class="line"><span class="comment">#以下是new bing对escape函数的解释</span></span><br><span class="line"><span class="comment">#escape()函数是用来对HTML文本进行转义的</span></span><br><span class="line"><span class="comment">#也就是把一些特殊字符替换成它们的HTML实体表示</span></span><br><span class="line"><span class="comment">#这样可以避免在网页中出现不安全或者不正确的内容。</span></span><br><span class="line"><span class="comment">#例如，如果你想在网页中显示一个用户的名字，但是用户的名字可能包含一些HTML标签</span></span><br><span class="line"><span class="comment">#那么你就需要用escape()函数来处理一下</span></span><br><span class="line"><span class="comment">#否则可能会影响网页的布局或者执行一些恶意的代码。</span></span><br></pre></td></tr></table></figure>

<p>可变部分的类型有以下几种</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>string</td>
<td>(default) accepts any text without a &#x2F;</td>
</tr>
<tr>
<td>int</td>
<td>accepts positive integers</td>
</tr>
<tr>
<td>float</td>
<td>accepts positive floating point values</td>
</tr>
<tr>
<td>path</td>
<td>like string but also accepts &#x2F;</td>
</tr>
<tr>
<td>uuid</td>
<td>accepts UUID strings</td>
</tr>
</tbody></table>
<h1 id="路由导航与错误"><a href="#路由导航与错误" class="headerlink" title="路由导航与错误"></a>路由导航与错误</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> abort, redirect, url_for</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="comment">#url_for(函数名)返回函数所在的路径</span></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    abort(<span class="number">401</span>)</span><br><span class="line">    this_is_never_executed()</span><br></pre></td></tr></table></figure>

<h1 id="区分请求方法（get-post等）"><a href="#区分请求方法（get-post等）" class="headerlink" title="区分请求方法（get,post等）"></a>区分请求方法（get,post等）</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> do_the_login()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> show_the_login_form()</span><br><span class="line"></span><br><span class="line"><span class="comment">#也可把get与post直接分开配置</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&#x27;/login&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_get</span>():</span><br><span class="line">    <span class="keyword">return</span> show_the_login_form()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&#x27;/login&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_post</span>():</span><br><span class="line">    <span class="keyword">return</span> do_the_login()</span><br></pre></td></tr></table></figure>

<h1 id="处理请求的数据"><a href="#处理请求的数据" class="headerlink" title="处理请求的数据"></a>处理请求的数据</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="comment">#请求体中的数据</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    error = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">				<span class="comment">#valid_login是需要自定义的函数</span></span><br><span class="line">        <span class="keyword">if</span> valid_login(request.form[<span class="string">&#x27;username&#x27;</span>],</span><br><span class="line">                       request.form[<span class="string">&#x27;password&#x27;</span>]):</span><br><span class="line">            <span class="keyword">return</span> log_the_user_in(request.form[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            error = <span class="string">&#x27;Invalid username/password&#x27;</span></span><br><span class="line">    <span class="comment"># the code below is executed if the request method</span></span><br><span class="line">    <span class="comment"># was GET or the credentials were invalid</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, error=error)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取路由中的数据</span></span><br><span class="line">searchword = request.args.get(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="上传文件："><a href="#上传文件：" class="headerlink" title="上传文件："></a>上传文件：</h1><blockquote>
<p>注！：前端的表单中需要设置enctype&#x3D;”multipart&#x2F;form-data”</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        file = request.files[<span class="string">&#x27;the_file&#x27;</span>]</span><br><span class="line">        file.save(<span class="string">f&quot;/var/www/uploads/<span class="subst">&#123;secure_filename(file.filename)&#125;</span>&quot;</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h1 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">		<span class="comment">#读cookies</span></span><br><span class="line">    username = request.cookies.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="comment"># use cookies.get(key) instead of cookies[key] to not get a</span></span><br><span class="line">    <span class="comment"># KeyError if the cookie is missing.</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">#存cookies</span></span><br><span class="line">		resp = make_response(render_template(...))</span><br><span class="line">    resp.set_cookie(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;the username&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure>

<h1 id="JSON的编码与解码"><a href="#JSON的编码与解码" class="headerlink" title="JSON的编码与解码"></a>JSON的编码与解码</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#dict与list结构的返回值再返回头中会自动转化为JSON格式</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/me&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">me_api</span>():</span><br><span class="line">    user = get_current_user()</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: user.username,</span><br><span class="line">        <span class="string">&quot;theme&quot;</span>: user.theme,</span><br><span class="line">        <span class="string">&quot;image&quot;</span>: url_for(<span class="string">&quot;user_image&quot;</span>, filename=user.image),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/users&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">users_api</span>():</span><br><span class="line">    users = get_all_users()</span><br><span class="line">    <span class="keyword">return</span> [user.to_json() <span class="keyword">for</span> user <span class="keyword">in</span> users]</span><br></pre></td></tr></table></figure>

<h1 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> session</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the secret key to some random bytes. Keep this really secret!</span></span><br><span class="line">app.secret_key = <span class="string">b&#x27;_5#y2L&quot;F4Q8z\n\xec]/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;Logged in as <span class="subst">&#123;session[<span class="string">&quot;username&quot;</span>]&#125;</span>&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;You are not logged in&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        session[<span class="string">&#x27;username&#x27;</span>] = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;form method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;&lt;input type=text name=username&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;&lt;input type=submit value=Login&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    <span class="comment"># remove the username from the session if it&#x27;s there</span></span><br><span class="line">    session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br></pre></td></tr></table></figure>

<!-- # api

| 名 | 作用 | 示例 |
| --- | --- | --- |
| url_for | 返回函数所在的路径 | print(url_for('profile', username='John Doe'))//profile为一以username为参数的函数。//结果：/user/John%20Doe | -->

<h1 id="未记录的部分"><a href="#未记录的部分" class="headerlink" title="未记录的部分"></a>未记录的部分</h1><p>静态资源的传输：Static Files</p>
<p>后端渲染：Rendering Templates</p>
<p>Accessing Request Data</p>
<p>404页面自定义：<a href="https://flask.palletsprojects.com/en/2.3.x/errorhandling/">Handling Application Errors — Flask Documentation (2.3.x) (palletsprojects.com)</a></p>
]]></content>
      <categories>
        <category>后端</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>后端</tag>
        <tag>flask</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>VeeValidate表单验证</title>
    <url>/post/fontEnd/VeeValidate/</url>
    <content><![CDATA[<blockquote>
<p>前言：element-ui 的表单用起来实在是太僵硬了，组长便让我去看一看VeeValidate的表单验证系统，粗略看了一下官方文档，确实要灵活好用很多，便在此记录一下用法</p>
</blockquote>
<h1 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h1><ul>
<li>无需使用v-model将input与变量绑定（但想的话也可以），而是使用v-bind与对应的field绑定。最后直接通过form的value读取。</li>
</ul>
<p>💡 导入<br><code>npm install --save vee-validate@next</code><br><code>import &#123; Form, Field, ErrorMessage &#125; from &#39;vee-validate&#39;;</code></p>
<p>官方文档：<a href="https://vee-validate.logaretm.com/v4/">VeeValidate: Painless Vue.js forms (logaretm.com)</a></p>
<h1 id="基础用法示例"><a href="#基础用法示例" class="headerlink" title="基础用法示例"></a><strong>基础用法示例</strong></h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">Form</span>, <span class="title class_">Field</span>, <span class="title class_">ErrorMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vee-validate&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">validateEmail</span> = (<span class="params">value: any</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">return</span> <span class="regexp">/@/</span>.<span class="title function_">test</span>(value) ? <span class="literal">true</span> : <span class="string">&#x27;邮箱格式错误&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">isRequired</span>=(<span class="params">value:string</span>)=&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (value &amp;&amp; value.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> <span class="string">&#x27;你没通过捏&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = (<span class="params">values</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">//values是一个对象，存有填好的表单的值，key是元素的name。</span></span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">console</span>.<span class="title function_">log</span>(values)</span></span><br><span class="line"><span class="language-javascript">	<span class="title function_">alert</span>(<span class="string">&#x27;验证通过时执行&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;Form&gt;包裹整个表单，&lt;Field&gt;包裹表单中的一个字段 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- @submit在所有Field都返回true时才触发 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span> <span class="attr">:validate-on-input</span>=<span class="string">&quot;true&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- field来自&lt;Field&gt;的v-slot, 意味着值的绑定与事件的绑定。在数据不方便双向绑定，如file时，或想自己配置绑定事件时不使用v-bind写法，具体请看官方文档 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- errMessage即为校验失败后显示的信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- onsubmit会监听内部每一个button的点击，点击时触发内部所有Field的验证 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="使用自定义输入框"><a href="#使用自定义输入框" class="headerlink" title="使用自定义输入框"></a><strong>使用自定义输入框</strong></h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;&#123; email: true &#125;&quot;</span>  #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, value &#125;&quot;</span>&gt;</span></span><br><span class="line">		//自定义组件推荐使用update:modelValue事件实现与Field的绑定</span><br><span class="line">		<span class="tag">&lt;<span class="name">CustomInput</span> <span class="attr">:modelValue</span>=<span class="string">&quot;value&quot;</span> @<span class="attr">update:modelValue</span>=<span class="string">&quot;handleChange&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="验证规则绑定"><a href="#验证规则绑定" class="headerlink" title="验证规则绑定"></a><strong>验证规则绑定</strong></h1><h2 id="声明验证规则"><a href="#声明验证规则" class="headerlink" title="声明验证规则"></a>声明验证规则</h2><p>验证规则有两种，一是直接使用函数，还有一种叫validator(个人感觉和函数区别也不大)</p>
<h3 id="使用函数"><a href="#使用函数" class="headerlink" title="使用函数"></a>使用函数</h3><p>声明一个函数，返回值是 bool或string 。return true 时errormessage为空， return false则errormessage为默认值， return string 则将该string赋值给errormessage。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">isRequired</span> = (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (value &amp;&amp; value.<span class="title function_">trim</span>()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;This is required&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后使用:rules绑定</p>
<p><code>&lt;Field name=&quot;field&quot; :rules=&quot;isRequired&quot; /&gt;</code></p>
<h3 id="使用validator"><a href="#使用validator" class="headerlink" title="使用validator"></a>使用validator</h3><p>声明一个validator, 类似函数</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineRule &#125; <span class="keyword">from</span> <span class="string">&#x27;vee-validate&#x27;</span>;</span><br><span class="line"><span class="title function_">defineRule</span>(<span class="string">&#x27;required&#x27;</span>, <span class="function">(<span class="params">value :string</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!value || !value.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;This field is required&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//需要参数的validator</span></span><br><span class="line"><span class="title function_">defineRule</span>(<span class="string">&#x27;minLength&#x27;</span>, <span class="function">(<span class="params">value, [limit]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// The field is empty so it should pass</span></span><br><span class="line">  <span class="keyword">if</span> (!value || !value.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (value.<span class="property">length</span> &lt; limit) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This field must be at least <span class="subst">$&#123;limit&#125;</span> characters`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">defineRule</span>(<span class="string">&#x27;minMax&#x27;</span>, <span class="function">(<span class="params">value, [min, max]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// The field is empty so it should pass</span></span><br><span class="line">  <span class="keyword">if</span> (!value || !value.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (value.<span class="property">length</span> &lt; min) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This field must be at least <span class="subst">$&#123;min&#125;</span> characters`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (value.<span class="property">length</span> &gt; max) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`This field must be at most <span class="subst">$&#123;max&#125;</span> characters`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>而后用:rules绑定</p>
<p><code>绑定单个&lt;Field name=&quot;username3&quot; :rules=&quot;&#39;resquired&#39;&quot; &gt;</code></p>
<p><code>绑定多个&lt;Field name=&quot;username3&quot; :rules=&quot;&#39;resquired|email&#39;&quot; &gt;</code></p>
<p><code>绑定带参数的validator &lt;Field name=&quot;username3&quot; :rules=&quot;&#39;resquired|minLength:8&#39;&quot; &gt;</code></p>
<p><code>绑定带多个参数的validator &lt;Field name=&quot;username3&quot; :rules=&quot;&#39;minMax:5,8|resquired&#39;&quot; &gt;</code></p>
<h2 id="绑定规则"><a href="#绑定规则" class="headerlink" title="绑定规则"></a>绑定规则</h2><p>除每个field单独绑定外，还可定义一个schema控制所有rules后通过name分配rule</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 给<span class="title class_">Form</span>绑定schema --&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">:validation-schema</span>=<span class="string">&quot;schema&quot;</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; errors &#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; errors.email &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; errors.password &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Form</span>, <span class="title class_">Field</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vee-validate&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> schema = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">email</span>: <span class="string">&#x27;required|email&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">password</span>: <span class="string">&#x27;required|minLength:8&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h1 id="验证时机的设置"><a href="#验证时机的设置" class="headerlink" title="验证时机的设置"></a><strong>验证时机的设置</strong></h1><h2 id="单一Field验证："><a href="#单一Field验证：" class="headerlink" title="单一Field验证："></a>单一Field验证：</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;&#123; email: true &#125;&quot;</span> <span class="attr">:validateOnInput</span>=<span class="string">&quot;true&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>与时机有关的prop</th>
<th>默认值</th>
<th>介绍</th>
</tr>
</thead>
<tbody><tr>
<td>validateOnMount</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>validateOnInput</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>validateOnChange</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>validateOnBlur</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>validateOnModelUpdate</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>bails</td>
<td>true</td>
<td>绑定多个验证规则时，有一个验证规则未通过，直接结束验证，而不再继续验证其他规则</td>
</tr>
</tbody></table>
<h2 id="全表验证："><a href="#全表验证：" class="headerlink" title="全表验证："></a>全表验证：</h2><p>除最后的提交之外，可能还有其他地方也需要进行全表验证，VeeValidate为此提供了validate模块</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 导入validate模块 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; validate &#125;&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username1&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username2&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span>  #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 使用validate模块 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;validate()&quot;</span>&gt;</span>11111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="状态管理（trigger）"><a href="#状态管理（trigger）" class="headerlink" title="状态管理（trigger）"></a>状态管理（trigger）</h1><h2 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;!-- 验证状态管理 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; meta &#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; meta &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="comment">//渲染结果&#123; &quot;initialValues&quot;: &#123;&#125;, &quot;touched&quot;: false, &quot;pending&quot;: false, &quot;valid&quot;: false, &quot;dirty&quot;: false &#125;</span></span><br><span class="line">meta.<span class="property">value</span>.<span class="property">initialValues</span>; <span class="comment">//一个对象，包含所有字段的初始值，key是字段的name</span></span><br><span class="line">meta.<span class="property">value</span>.<span class="property">touched</span>;<span class="comment">//是否有字段被focus过，并且已经blur</span></span><br><span class="line">meta.<span class="property">value</span>.<span class="property">pending</span>; <span class="comment">//是否有字段还在验证中</span></span><br><span class="line">meta.<span class="property">value</span>.<span class="property">valid</span>; <span class="comment">//是否全部通过验证</span></span><br><span class="line">meta.<span class="property">value</span>.<span class="property">dirty</span>; <span class="comment">//是否有字段更新</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 提交状态管理 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- isSubmitting在提交时值为true，提交完成后值变为false --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">v-form</span> <span class="attr">:validation-schema</span>=<span class="string">&quot;schema&quot;</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; isSubmitting &#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Field"><a href="#Field" class="headerlink" title="Field"></a>Field</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;validateEmail&quot;</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; field, meta &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">pre</span>&gt;</span>&#123;&#123; meta &#125;&#125;<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--渲染出的结果为&#123; &quot;touched&quot;: true, &quot;pending&quot;: false, &quot;valid&quot;: false, &quot;validated&quot;: false, &quot;dirty&quot;: true &#125;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="表单的提交"><a href="#表单的提交" class="headerlink" title="表单的提交"></a>表单的提交</h1><blockquote>
<p>You will rarely need to access the form values inside the template, but it is there if you ever need it. What’s interesting is that vee-validate follows the assumption that most likely you will need the form values at the submission phase.<br>您很少需要在提交这一步骤之外使用表单值，基于这个假设，vee-validate只在提交阶段提供表单值。但如果您有需要，请额外使用v-model绑定你想要的元素</p>
</blockquote>
<p>⬆️源自VeeValidate官方文档</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">Form</span>, <span class="title class_">Field</span>, <span class="title class_">ErrorMessage</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;vee-validate&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//values为表单内部的值，是一个对象，key为field的name</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">onSubmit</span> = (<span class="params">values</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">console</span>.<span class="title function_">log</span>(values);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//value为用户填入的值，results存有验证是否通过的信息，errors为错误信息</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">onInvalidSubmit</span>=(<span class="params">&#123;values, errors, results&#125;</span>)=&gt;&#123;</span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">console</span>.<span class="title function_">log</span>(values);</span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">console</span>.<span class="title function_">log</span>(errors);</span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">isRequired</span>=(<span class="params">value:string</span>)=&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (value &amp;&amp; value.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> <span class="string">&#x27;你没通过捏&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 在所有验证都通过时触发submit事件，其handler默认带表单值为参数。有验证不通过时触发invalid</span></span><br><span class="line"><span class="comment">Submit事件 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> @<span class="attr">invalid-submit</span>=<span class="string">&quot;onInvalidSubmit&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username1&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; field&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username2&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span>  #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- Form自动监听其间button的点击事件，点击则对所有field进行验证 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span>&gt;</span>一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><h2 id="绑定初始值"><a href="#绑定初始值" class="headerlink" title="绑定初始值"></a>绑定初始值</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 仍可以使用v-model来绑定初始值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">...</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!-- 定义初始值 --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">const formValues =&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">	username1:&#x27;test1&#x27;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">	username2:&#x27;test2&#x27;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 给Form绑定initialValues --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> <span class="attr">:initialValues</span>=<span class="string">&quot;formValues&quot;</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username1&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username2&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;isRequired&quot;</span>  #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span>&gt;</span>1212<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="错误信息的显示"><a href="#错误信息的显示" class="headerlink" title="错误信息的显示"></a>错误信息的显示</h2><p><code>&lt;*ErrorMessage* *name*=&quot;field&quot; *as*=&quot;div&quot; /&gt;</code></p>
<p>可以通过修改as的值，将错误信息改为自定义组件</p>
<h2 id="更改值"><a href="#更改值" class="headerlink" title="更改值"></a>更改值</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 行内函数更改 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Form</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; setFieldValue, setValues &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ErrorMessage</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ErrorMessage</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;setFieldValue(&#x27;email&#x27;, &#x27;test&#x27;)&quot;</span>&gt;</span>Set Field Value<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;setValues(&#123; email: &#x27;test&#x27;, password: &#x27;test12&#x27; &#125;)&quot;</span>&gt;</span></span><br><span class="line">    Set Multiple Values</span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- js中使用 ----------------------------------------------------------------------&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">...</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">const numval = ref(5)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!--获取ref--&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">const myForm = ref()</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!-- 更改一个值 --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">function changevalue()&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">	myForm.value.setFieldValue(&#x27;username1&#x27;,numval.value++)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="comment">&lt;!-- 更改多个值 --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">function changevalues()&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">	myForm.value.setValues(</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">		&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			username1: 1,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			username2: 2</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">		&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">	)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 获取ref --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Form</span> @<span class="attr">submit</span>=<span class="string">&quot;onSubmit&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myForm&quot;</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username1&quot;</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">Field</span> <span class="attr">name</span>=<span class="string">&quot;username2&quot;</span>  #<span class="attr">default</span>=<span class="string">&quot;&#123; errorMessage, field &#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">&quot;field&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; errorMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">Field</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;changevalue&quot;</span>&gt;</span>111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;changevalues&quot;</span>&gt;</span>222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>-表单验证</tag>
      </tags>
  </entry>
  <entry>
    <title>使用ssh代理加速github</title>
    <url>/post/forAll/speedgit/</url>
    <content><![CDATA[<h1 id="使用ssh代理加速github"><a href="#使用ssh代理加速github" class="headerlink" title="使用ssh代理加速github"></a>使用ssh代理加速github</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>💡 <strong>背景</strong>：在公司摸鱼时偷偷整了个小项目存在github上，回到寝室兴高采烈地打开自己的小破笔记本准备接着完善项目, 但看着全局代理情况下git clone 27kb &#x2F; s 的龟速，我血压一下子就上来了，于是去学了以下如何提速。（请注意：本方法需要科学上网）</p>
</blockquote>
<blockquote>
<p>本方法学自：<a href="https://zhuanlan.zhihu.com/p/481574024">设置代理解决github被墙 - 知乎 (zhihu.com)</a>,  但该文章中还存有一些可能导致困惑的地方，我将在本篇文章中尽量避免</p>
</blockquote>
<hr>
<h2 id="使用ssh代理加速github的步骤"><a href="#使用ssh代理加速github的步骤" class="headerlink" title="使用ssh代理加速github的步骤"></a>使用ssh代理加速github的步骤</h2><h3 id="1-确认自己梯子的本地代理端口号"><a href="#1-确认自己梯子的本地代理端口号" class="headerlink" title="1. 确认自己梯子的本地代理端口号"></a>1. 确认自己梯子的本地代理端口号</h3><p>以我使用的vray为例，红色箭头所指的为梯子的三个端口号，其中，33612是与代理服务器进行连接的端口，而socks 与 http 是本地的端口号，也是我们接下来需要使用到的端口。</p>
<p><img src="https://img-blog.csdnimg.cn/05fb991394904388a68ef53b06cf8727.png#pic_center" alt="Untitled"></p>
<h3 id="2-确认自己Git连接执行文件的文件路径"><a href="#2-确认自己Git连接执行文件的文件路径" class="headerlink" title="2.确认自己Git连接执行文件的文件路径"></a>2.确认自己Git连接执行文件的文件路径</h3><p>Git 的连接执行文件是connect.exe</p>
<p>所在的路径一般为: <code>git的安装目录\mingw64\bin\connect</code></p>
<p>我将git安装在E盘的App目录中，该路径就为 <code>E:\App\Git\mingw64\bin\connect</code></p>
<p><img src="https://img-blog.csdnimg.cn/382c55b0fad84b13a3986172e4814184.png#pic_center" alt="Untitled"></p>
<h3 id="3-修改ssh的配置"><a href="#3-修改ssh的配置" class="headerlink" title="3.修改ssh的配置"></a>3.修改ssh的配置</h3><p>进入你的.ssh目录，路径一般为 <code>C:\User\你使用的用户名\.ssh</code>， 在这个目录下新建一个config文件（无后缀），将以下内容写入该文件中。 </p>
<p>其中：</p>
<p><strong>路径1：</strong> 第二步中确定的路径，如我使用的：<code>E:\APP\Git\mingw64\bin\connect</code></p>
<p><strong>端口：</strong> 第一步中确认的两个端口中的任意一个，如我使用的为socks端口，<strong>10808</strong></p>
<p><strong>路径2：</strong>.ssh目录中以id_为前缀的文件的路径，如我的.ssh中该文件名称为id_ed25519, 则我的路径2为 <code>C:\Users\我使用的用户名\.ssh\id_ed25519</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#Windows用户，注意替换你的端口号和connect.exe的路径</span><br><span class="line">ProxyCommand &quot;路径1&quot; -S 127.0.0.1:端口 -a none %h %p</span><br><span class="line"></span><br><span class="line">#MacOS用户用下方这条命令，注意替换你的端口号</span><br><span class="line">#ProxyCommand nc -v -x 127.0.0.1:端口 %h %p</span><br><span class="line"></span><br><span class="line">Host github.com</span><br><span class="line">  User git</span><br><span class="line">  Port 22</span><br><span class="line">  Hostname github.com</span><br><span class="line">  # 注意修改路径为你的路径</span><br><span class="line">  IdentityFile &quot;路径2&quot;</span><br><span class="line">  TCPKeepAlive yes</span><br><span class="line"></span><br><span class="line">Host ssh.github.com</span><br><span class="line">  User git</span><br><span class="line">  Port 443</span><br><span class="line">  Hostname ssh.github.com</span><br><span class="line">  # 注意修改路径为你的路径</span><br><span class="line">  IdentityFile &quot;路径2&quot;</span><br><span class="line">  TCPKeepAlive yes</span><br></pre></td></tr></table></figure>

<h3 id="4-验证"><a href="#4-验证" class="headerlink" title="4.验证"></a>4.验证</h3><p>win+r 并输入cmd 进入控制台， 输入<code>ssh -T git@github.com</code> ，回车，查看结果。返回successful之类的就意味着成功了。</p>
<p><img src="https://img-blog.csdnimg.cn/97e936ef9bc74634808a2ed171339fb6.png#pic_center" alt="速度变成了4MB每秒"></p>
<p>速度变成了4MB每秒</p>
]]></content>
      <categories>
        <category>综合</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>加速</tag>
      </tags>
  </entry>
  <entry>
    <title>前端性能优化</title>
    <url>/post/fontEnd/fontEndImprove/</url>
    <content><![CDATA[<h1 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h1><p>概念：避免在短时间内重复触发同一个事件</p>
<p>依赖安装<code>npm i lodash</code></p>
<p>导入<code>import _ from &#39;lodash’</code></p>
<p>代码示例：</p>
<figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//随便定义一个函数：</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fun</span>= (<span class="params">str</span>)=&gt;&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//声明一个debounce变量</span></span><br><span class="line"><span class="keyword">const</span> fun1 = _.<span class="title function_">debounce</span>(fun,<span class="number">500</span>)</span><br><span class="line"><span class="comment">//其中，fun是一个函数，在fun1的声明中fun不带参数，此后，就把 fun1当fan用</span></span><br><span class="line"><span class="comment">//如：&lt;button @click=&quot;fun1(&#x27;11111&#x27;)&quot;&gt;&lt;/button&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="axios取消请求"><a href="#axios取消请求" class="headerlink" title="axios取消请求"></a>axios取消请求</h1><p>概念：当用户需频繁发送请求，并且新请求的数据会覆盖旧请求时，应该在新请求发送时取消旧请求</p>
<p>axios仓库页面：<a href="https://github.com/axios/axios#cancellation">axios&#x2F;axios: Promise based HTTP client for the browser and node.js (github.com)</a>，取消为Cancellation部分</p>
<p>底层原理挺复杂的（原理讲解见<a href="https://zhuanlan.zhihu.com/p/432732779#:~:text=%2F%2F%20Axios%2Flib%2Fadapters%2Fxhr.js%20%2F%2F...%20if%20%28config.cancelToken%20%7C%7C%20config.signal%29%20%7B,%3F%20onCanceled%28%29%20%3A%20config.signal.addEventListener%28%27abort%27%2C%20onCanceled%29%3B%20%7D%20%7D%20%2F%2F">这次终于弄懂Axios是如何中断请求了</a>），但实际用起来很简单。只需new 一个AbortController实例后，在要取消请求时调用这个实例的abort方法即可。</p>
<p>代码示例：</p>
<figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请求控制器</span></span><br><span class="line"><span class="keyword">const</span> controller = <span class="title function_">ref</span>(<span class="keyword">new</span> <span class="title class_">AbortController</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">//关联搜索框</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleInputList</span> = (<span class="params">val</span>) =&gt; &#123;</span><br><span class="line">		<span class="comment">//取消旧请求</span></span><br><span class="line">    controller.<span class="property">value</span>.<span class="title function_">abort</span>()</span><br><span class="line">		<span class="comment">//创建新控制器</span></span><br><span class="line">    controller.<span class="property">value</span> = <span class="keyword">new</span> <span class="title class_">AbortController</span>()</span><br><span class="line">		<span class="comment">//getMatchJobLists是一个封装了的axios方法,将controller.value.signal作为参数传入</span></span><br><span class="line">    <span class="title function_">getMatchJobLists</span>(&#123; <span class="attr">job</span>: val, <span class="attr">isSearch</span>: <span class="number">1</span> &#125;, controller.<span class="property">value</span>.<span class="property">signal</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        isInputSearchArr.<span class="property">value</span> = []</span><br><span class="line">        <span class="keyword">let</span> industry = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">let</span> direction = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">            res.<span class="property">data</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (item.<span class="property">industry</span>) &#123;</span><br><span class="line">                    industry = item.<span class="property">industry</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                item.<span class="property">direction</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item2</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (item2.<span class="property">direction</span>) &#123;</span><br><span class="line">                        direction = item2.<span class="property">direction</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    item2.<span class="property">jobs</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item3</span>) =&gt;</span> &#123;</span><br><span class="line">                        isInputSearchArr.<span class="property">value</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">                            <span class="attr">id</span>: item3.<span class="property">id</span>,</span><br><span class="line">                            <span class="attr">name</span>: item3.<span class="property">name</span>,</span><br><span class="line">                            industry,</span><br><span class="line">                            direction,</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该示例是一个类似浏览器的搜索下拉框，用户每次输入后都向服务器请求用户搜索的内容 ，用户打字较快的话，会在短时间内进行多次请求，而其中只有最后一次请求的结果有意义，因此可以通过取消之前的请求来提升性能。</p>
<p>代码段中的getMatchJobLists是一个封装了的axios方法，其定义如下：</p>
<figure class="highlight tsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getMatchJobLists = (<span class="attr">params</span>: <span class="built_in">any</span>, <span class="attr">signal</span>: <span class="title class_">GenericAbortSignal</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`/match_job_lists`</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">        signal,</span><br><span class="line">        params,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>性能</tag>
      </tags>
  </entry>
  <entry>
    <title>自定义修改小程序</title>
    <url>/post/fontEnd/changeMiniApp/</url>
    <content><![CDATA[<h1 id="跑步打卡配置——更改小程序"><a href="#跑步打卡配置——更改小程序" class="headerlink" title="跑步打卡配置——更改小程序"></a>跑步打卡配置——更改小程序</h1><blockquote>
<p>学校跑步打卡的小程序限制了使用的时间段以及开始跑步的位置，导致每次打卡都人流拥挤，很烦。因此就尝试去”fork“了一个小程序副本，并在副本上自定义更改了前端的检验规则</p>
</blockquote>
<p>该过程分为两步：反编译、抓包、改代码</p>
<h1 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h1><p>如何获取小程序的源码，这是个很大的问题。冲了一天浪，找到这么一个教程<a href="https://blog.csdn.net/m0_60571842/article/details/132577489">小程序应用&amp;解包反编译&amp;动态调试&amp;抓包&amp;静态分析&amp;源码架构_SuperherRo的博客-CSDN博客</a></p>
<p>其中讲的很详细，但为了防止该网页被删，我将其中的内容融合我自己的理解再复述一遍</p>
<h3 id="1-找到文件包的位置"><a href="#1-找到文件包的位置" class="headerlink" title="1.找到文件包的位置"></a>1.找到文件包的位置</h3><p><img src="https://img-blog.csdnimg.cn/24293f6c8d1541e19311b437cac737fe.png" alt="24293f6c8d1541e19311b437cac737fe.png"></p>
<p><img src="https://img-blog.csdnimg.cn/6b78a35223b0488f8073941b247ed569.png" alt="6b78a35223b0488f8073941b247ed569.png"></p>
<p>如果找不到就把该文件夹中的所有文件都删除，再重新打开小程序，重新出现的文件夹即为目标</p>
<h3 id="2-下载工具"><a href="#2-下载工具" class="headerlink" title="2.下载工具"></a>2.下载工具</h3><figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">流程如下：</span><br><span class="line"><span class="symbol">PC</span>端小程序</span><br><span class="line">解密工具：<span class="symbol">UnpackMiniApp</span>(一个exe工具已经放进wxappUnpacker目录下)</span><br><span class="line">该解密工具需要在当前目录创建一个wxapkg文件夹</span><br><span class="line">下载地址：https://gitee.com/steinven/wxpkg/blob/master/<span class="symbol">UnpackMiniApp</span>.exe</span><br><span class="line"></span><br><span class="line">先解密完后在反编译</span><br><span class="line">反编译工具：wxappUnpacker</span><br><span class="line">下载地址：https://gitee.com/steinven/wxpkg/blob/master/wxappUnpacker.zip</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本段代码来自<span class="symbol">CSDN</span>博主「<span class="symbol">SuperherRo</span>」的原创文章，遵循<span class="symbol">CC</span> <span class="number">4.0</span> <span class="symbol">BY</span>-<span class="symbol">SA</span>版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https://blog.csdn.net/m0_60571842/article/details/<span class="number">132577489</span></span><br></pre></td></tr></table></figure>

<h3 id="3-使用UnpackMiniApp"><a href="#3-使用UnpackMiniApp" class="headerlink" title="3.使用UnpackMiniApp"></a>3.使用UnpackMiniApp</h3><p>进入UnpackMiniApp下载的路径，在此路径下创建一个名为wxpack的文件夹</p>
<p><img src="https://img-blog.csdnimg.cn/e30a0a5907d64773b4dea176ea7ba448.png" alt="e30a0a5907d64773b4dea176ea7ba448.png"></p>
<p>运行该程序，选择相应的程序包，等待解密完成，解密完成后将在wxpack文件夹中生成程序包</p>
<p><img src="https://img-blog.csdnimg.cn/072463b58e9a4a5785247ac7dd3722ee.png" alt="072463b58e9a4a5785247ac7dd3722ee.png"></p>
<h3 id="4-使用wxappUnpacker-需要配置node环境"><a href="#4-使用wxappUnpacker-需要配置node环境" class="headerlink" title="4.使用wxappUnpacker(需要配置node环境)"></a>4.使用wxappUnpacker(需要配置node环境)</h3><p>wxappUnpacker并不是一个可执行文件，而是一个js脚本，需要在nodejs环境下运行</p>
<p><img src="https://img-blog.csdnimg.cn/7d7418c3d98241b3b878151db076535a.png" alt="7d7418c3d98241b3b878151db076535a.png"></p>
<p>该路径下打开终端或bash,输入命令</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">//请根据第三步解密好的包的路径更改这行命令</span><br><span class="line">node wuWxapkg.js <span class="symbol">C</span>:/<span class="symbol">Users</span>/<span class="symbol">Admin</span>/<span class="symbol">Desktop</span>/wxappUnpacker/wxpack/wxd7aa85d403a49335.wxapkg</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/0349d434c4384efe99538cc947d43424.png" alt="0349d434c4384efe99538cc947d43424.png"></p>
<p>File done后可在与解密包同文件夹处找到反编译完成的包，这个包按理说是能直接运行的（跑步打卡的包由于基础库版本的原因并不能直接就运行，如何修改将在之后进行讲解）</p>
<h1 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h1><p>跑步打卡的程序是根据openid与userid的值来判断用户的，直接在副本上登陆微信号的话，未必会给我们分配一个与原版本相同的openid，因此需要自己通过抓包获取自己原版本的openid与userid</p>
<p>对于抓包，该博主也有较为深入的讲解<a href="https://blog.csdn.net/m0_60571842/article/details/132564881">抓包技术&amp;HTTPS协议&amp;APP&amp;小程序&amp;PC应用&amp;WEB_SuperherRo的博客-CSDN博客</a></p>
<p>在博主讲解的基础上打开任意一个跑步打卡程序发出的包，即能获取到所需要的openid与userid</p>
<p>由于抓包难度较低，并且被删可能较小，便不在此详细说明</p>
<h1 id="修改源代码"><a href="#修改源代码" class="headerlink" title="修改源代码"></a>修改源代码</h1><p>下载微信开发者工具，并打开反编译完成的文件</p>
<p>反编译获得的代码没有注释，并且格式紊乱，看得我头皮发麻，因此费了大量时间。需修改的地方有如下几处</p>
<h3 id="1-修改43BA1E1353E228FF25DC7614A0117075-js文件"><a href="#1-修改43BA1E1353E228FF25DC7614A0117075-js文件" class="headerlink" title="1.修改43BA1E1353E228FF25DC7614A0117075.js文件"></a>1.修改43BA1E1353E228FF25DC7614A0117075.js文件</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//可能文件名会有变化，请以下面这行代码为主，哪有这行删哪个</span></span><br><span class="line"><span class="comment">//删除第一行的</span></span><br><span class="line">requirePlugin(<span class="string">&quot;WechatSI&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-将app-json文件修改成如下"><a href="#2-将app-json文件修改成如下" class="headerlink" title="2.将app.json文件修改成如下"></a>2.将app.json文件修改成如下</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/profile&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/rank&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/xianlu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/paobu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/guiji&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/mapgj&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/index/guize&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/logs/logs&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/tice&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/tcdetail&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/feedbook&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/feeddetail&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/webview&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/webviewlogin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/gymevidencelist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/message/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/message/messagelist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/message/content&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/studentauth&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/authinfo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/shili&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/record&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/edituserinfo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/setting&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/questionlist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/questiondetail&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/updateEvidence&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/usecode&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/questionSetting&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/kefu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/updateuser&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/selectgymclass&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/selectgymstudent&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/recordstu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/guijistu&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/hisrecord&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/user/hisguiji&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/prescriptionInfo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;pages/dating/gymevidence&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;window&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;backgroundTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;light&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#fff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;运动&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tabBar&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#B2B2B2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;selectedColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#0196FD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;borderStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;list&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;运动&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_1_disabled.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_1_enabled.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;大厅&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/dating/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_2_disabled.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_2_enabled.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;消息&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/message/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_3_disabled.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_3_enabled.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我的&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/user/index&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_4_disabled.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;images/nav_4_enabled.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;networkTimeout&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="number">6000</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sitemapLocation&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sitemap.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;permission&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scope.userLocation&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;为了给您提供更好的服务，请授权您的地理位置信息&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scope.userInfo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;为了给您提供更好的服务，请授权您的用户信息&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scope.userLocationBackground&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;为了给您提供更好的服务，请授权您的地理位置信息&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;requiredPrivateinfos&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;getLocation&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;onLocationChange&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;startLocationUpdate&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;startLocationUpdateBackground&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-修改合法域名"><a href="#3-修改合法域名" class="headerlink" title="3.修改合法域名"></a>3.修改合法域名</h3><p>点击右上角 详情→本地设置，将”不检验合法域名、web-view、TLS版本以及HTTPS证书“打上√</p>
<h3 id="4-删除-plugin-文件夹"><a href="#4-删除-plugin-文件夹" class="headerlink" title="4.删除__plugin__文件夹"></a>4.删除__plugin__文件夹</h3><h3 id="5-修改app-js文件"><a href="#5-修改app-js文件" class="headerlink" title="5.修改app.js文件"></a>5.修改app.js文件</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//找到onLaunch函数，更改为一下内容，记得添加自己的openid和userid：</span></span><br><span class="line"><span class="title class_">App</span>(&#123;</span><br><span class="line">    <span class="attr">globalData</span>: &#123;</span><br><span class="line">        <span class="attr">userLocationBackground</span>: !<span class="number">1</span>,</span><br><span class="line">        <span class="attr">userLocation</span>: !<span class="number">1</span>,</span><br><span class="line">        <span class="attr">apiurl</span>: <span class="string">&quot;https://run.csu.edu.cn/&quot;</span>,</span><br><span class="line">        <span class="attr">datakey</span>: <span class="string">&quot;a966a9ed603bd81d1e311547df205040&quot;</span>,</span><br><span class="line">        <span class="attr">navBarHeight</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">statusBarHeight</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">windowWidth</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">windowHeight</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">screenHeight</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">userInfo</span>: &#123;</span><br><span class="line">            <span class="attr">avatarUrl</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">nickName</span>: <span class="string">&quot;微信用户&quot;</span>,</span><br><span class="line">            <span class="attr">mileageTarget</span>: <span class="number">100</span>,</span><br><span class="line">            <span class="attr">runTarget</span>: <span class="number">50</span>,</span><br><span class="line">            <span class="attr">realName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">mobileNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">sex</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="attr">mileage</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">validCount</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">mileagePercent</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">countPercent</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">scorePercent</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">venueRun</span>: <span class="number">30</span>,</span><br><span class="line">            <span class="attr">venueCount</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">venuePercent</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">sportScore</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">runScore</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">ranking</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">userStatus</span>: &#123;</span><br><span class="line">            <span class="attr">openid</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">userid</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">approveStatus</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">isExist</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">studentNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">userType</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">schoolInfo</span>: &#123;</span><br><span class="line">            <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">academicYear</span>: <span class="string">&quot;2122&quot;</span>,</span><br><span class="line">            <span class="attr">term</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">schoolStatus</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">            <span class="attr">runType</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">accessType</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">prescription</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">uniappStatus</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">uniappUrl</span>: <span class="string">&quot;https://uniapp.sportoa.com&quot;</span>,</span><br><span class="line">            <span class="attr">runScoreType</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">runRegular</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">runScoreStatus</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">venueFlag</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">getHome</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">getVenuedata</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">getPersonaldata</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">getMessageList2</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLaunch</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, e = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">setKeepScreenOn</span>(&#123;</span><br><span class="line">            <span class="attr">keepScreenOn</span>: !<span class="number">0</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> a = wx.<span class="title function_">getSystemInfoSync</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">globalData</span>.<span class="property">windowWidth</span> = a.<span class="property">windowWidth</span>, <span class="variable language_">this</span>.<span class="property">globalData</span>.<span class="property">windowHeight</span> = a.<span class="property">windowHeight</span>, </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">globalData</span>.<span class="property">statusBarHeight</span> = a.<span class="property">statusBarHeight</span>, <span class="variable language_">this</span>.<span class="property">globalData</span>.<span class="property">screenHeight</span> = a.<span class="property">screenHeight</span>;</span><br><span class="line">        <span class="keyword">var</span> o = wx.<span class="title function_">getMenuButtonBoundingClientRect</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">globalData</span>.<span class="property">navBarHeight</span> = o.<span class="property">bottom</span></span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userStatus&quot;</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>)</span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;openid&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userid&quot;</span>, <span class="string">&quot;&quot;</span>) </span><br><span class="line">        <span class="keyword">var</span> n = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;userStatus&quot;</span>);</span><br><span class="line">        e.<span class="property">globalData</span>.<span class="property">userStatus</span> = n;</span><br><span class="line">        wx.<span class="title function_">getSetting</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                t.<span class="property">globalData</span>.<span class="property">userLocationBackground</span> = <span class="number">1</span>, </span><br><span class="line">                t.<span class="property">globalData</span>.<span class="property">userLocation</span> = e.<span class="property">authSetting</span>[<span class="string">&quot;scope.userLocation&quot;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      wx.<span class="title function_">authorize</span>(&#123;<span class="attr">scope</span>: <span class="string">&#x27;scope.userLocationBackground&#x27;</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<h3 id="6-修改pages-index-index-js文件"><a href="#6-修改pages-index-index-js文件" class="headerlink" title="6.修改pages&#x2F;index&#x2F;index.js文件"></a>6.修改pages&#x2F;index&#x2F;index.js文件</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> e = <span class="title function_">getApp</span>(), t = <span class="built_in">require</span>(<span class="string">&quot;../../43BA1E1353E228FF25DC7614A0117075.js&quot;</span>), a = <span class="built_in">require</span>(<span class="string">&quot;../../9E8EA57053E228FFF8E8CD77A2E07075.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">nvabarData</span>: &#123;</span><br><span class="line">            <span class="attr">showCapsule</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;运动&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">navheight</span>: e.<span class="property">globalData</span>.<span class="property">navBarHeight</span>,</span><br><span class="line">        <span class="attr">winWidth</span>: e.<span class="property">globalData</span>.<span class="property">windowWidth</span>,</span><br><span class="line">        <span class="attr">winHeight</span>: e.<span class="property">globalData</span>.<span class="property">windowHeight</span>,</span><br><span class="line">        <span class="attr">userInfo</span>: e.<span class="property">globalData</span>.<span class="property">userInfo</span>,</span><br><span class="line">        <span class="attr">schoolInfo</span>: e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>,</span><br><span class="line">        <span class="attr">currentData</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">deviceId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">runExplain1</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">runExplain2</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">runExplain3</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">columnCanvasData</span>: &#123;</span><br><span class="line">            <span class="attr">canvasId</span>: <span class="string">&quot;columnCanvas&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">runType</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">hisdata</span>: &#123;</span><br><span class="line">            <span class="attr">datedata</span>: [ <span class="string">&quot;9.21&quot;</span> ],</span><br><span class="line">            <span class="attr">kilodata</span>: [ <span class="number">0</span> ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">locationEnabled</span>: !<span class="number">1</span>,</span><br><span class="line">        <span class="attr">endcontent</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent1</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent2</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">runstatus</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">isBlueOpen</span>: !<span class="number">1</span>,</span><br><span class="line">        <span class="attr">venueFlag</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">messageList</span>: [],</span><br><span class="line">        <span class="attr">messageIds</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">messageSize</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">noticeStatus</span>: !<span class="number">0</span>,</span><br><span class="line">        <span class="attr">dayStartRunStatus</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">timeStartRunStatus</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">timeStatus</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">fileId</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">applyCount</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">suspendStatus</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">swiperLeft</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">index</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">index</span> - <span class="number">1</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">swiperRight</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">index</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">index</span> + <span class="number">1</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">bindchangeNotice</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">index</span>: e.<span class="property">detail</span>.<span class="property">current</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">openLocationAdapter</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>, t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">locationEnabled</span>: a.<span class="property">locationEnabled</span></span><br><span class="line">                &#125;), !e.<span class="property">data</span>.<span class="property">locationEnabled</span>) <span class="keyword">return</span> t.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeEvent2</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        e.<span class="title function_">hideAlertView</span>(), <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span> || e.<span class="title function_">showAlertView</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">openBluetoothAdapter</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                e.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">isBlueOpen</span>: t.<span class="property">bluetoothEnabled</span></span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">var</span> a = e.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (!e.<span class="property">data</span>.<span class="property">isBlueOpen</span>) <span class="keyword">return</span> a.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeBlueEvent</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>).<span class="title function_">hideAlertView</span>(), <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getTimeStatus</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, a = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#timeview&quot;</span>), o = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() / <span class="number">1e3</span>).<span class="title function_">toString</span>(), n = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, i = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, r = e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">schoolId</span>, s = e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">runType</span>;</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getTimeStatus?mobileTime=&quot;</span> + o + <span class="string">&quot;&amp;userid=&quot;</span> + n + <span class="string">&quot;&amp;openid=&quot;</span> + i + <span class="string">&quot;&amp;schoolId=&quot;</span> + r + <span class="string">&quot;&amp;runType=&quot;</span> + s,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>) wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getTimeStatus500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;); <span class="keyword">else</span> <span class="keyword">if</span> (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">timeStatus</span>: e.<span class="property">data</span>.<span class="property">timeStatus</span>,</span><br><span class="line">                    <span class="attr">timeStartRunStatus</span>: e.<span class="property">data</span>.<span class="property">timeStartRunStatus</span></span><br><span class="line">                &#125;), <span class="number">0</span> == e.<span class="property">data</span>.<span class="property">timeStatus</span>) <span class="keyword">return</span> a.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getTimeStatus2&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeTimeEvent</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#timeview&quot;</span>).<span class="title function_">hideAlertView</span>(), <span class="variable language_">this</span>.<span class="title function_">getTimeStatus</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">goTochang</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>), a = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">isBlueOpen</span> ? <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span> ? <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">dayStartRunStatus</span> ? (wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;未在运动日期&quot;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">2e3</span></span><br><span class="line">        &#125;), !<span class="number">1</span>) : <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">timeStartRunStatus</span> ? (wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;未在运动时间&quot;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), !<span class="number">1</span>) : <span class="keyword">void</span> (e.<span class="property">globalData</span>.<span class="property">userLocationBackground</span> &amp;&amp; e.<span class="property">globalData</span>.<span class="property">userLocation</span> &amp;&amp; <span class="number">1</span> == e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">isExist</span> ? wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/changguang/cglist&quot;</span></span><br><span class="line">        &#125;) : wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/profile&quot;</span></span><br><span class="line">        &#125;)) : (a.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>) : (t.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">schoolRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">alertview</span>.<span class="title function_">hideAlertView</span>(), wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/xianlu?runType=1&amp;suspendStatus=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">freeRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">alertview</span>.<span class="title function_">hideAlertView</span>(), wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/paobu?runType=2&amp;lineId=0&amp;startType=0&amp;suspendStatus=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">bindchange</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">currentData</span>: e.<span class="property">detail</span>.<span class="property">current</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">alertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview&quot;</span>), <span class="variable language_">this</span>.<span class="property">gpsalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">userlocationalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#userlocationalertview&quot;</span>), <span class="variable language_">this</span>.<span class="property">authview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#authview&quot;</span>), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">endview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview2&quot;</span>), <span class="variable language_">this</span>.<span class="property">inselectalertview2</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#inselectalertview2&quot;</span>), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">inselectalertview3</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#inselectalertview3&quot;</span>), <span class="variable language_">this</span>.<span class="property">endalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview&quot;</span>), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">endalertview3</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview3&quot;</span>), <span class="variable language_">this</span>.<span class="property">inselectalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#inselectalertview&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoAuth</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        e.<span class="property">globalData</span>.<span class="property">userLocationBackground</span> &amp;&amp; e.<span class="property">globalData</span>.<span class="property">userLocation</span> &amp;&amp; <span class="number">1</span> == e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">isExist</span> ? (<span class="variable language_">this</span>.<span class="property">authview</span>.<span class="title function_">hideAlertView</span>(), </span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/user/studentauth&quot;</span></span><br><span class="line">        &#125;)) : wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/profile&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">authLogin</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">login</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">                    <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/wx/authLogin?code=&quot;</span> + t.<span class="property">code</span>,</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                        <span class="number">200</span> != t.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,服务器异常authLogin500&quot;</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">2e3</span></span><br><span class="line">                        &#125;) : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ? (e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span> = t.<span class="property">data</span>.<span class="property">openid</span>, </span><br><span class="line">                        e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span> = t.<span class="property">data</span>.<span class="property">userid</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">approveStatus</span> = t.<span class="property">data</span>.<span class="property">approveStatus</span>, </span><br><span class="line">                        e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">isExist</span> = <span class="number">1</span>, wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userStatus&quot;</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>), </span><br><span class="line">                        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;openid&quot;</span>, t.<span class="property">data</span>.<span class="property">openid</span>), wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userid&quot;</span>, t.<span class="property">data</span>.<span class="property">userid</span>)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常authLogin&quot;</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">2e3</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;wx.login方法异常&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getHome</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;userid&quot;</span>), a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>), o = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/getHome?openid=&quot;</span> + a + <span class="string">&quot;&amp;userid=&quot;</span> + t,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != t.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getHome500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ? (e.<span class="property">globalData</span>.<span class="property">getHome</span> = <span class="number">1</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">mileageTarget</span> = t.<span class="property">data</span>.<span class="property">mileageTarget</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">runTarget</span> = t.<span class="property">data</span>.<span class="property">runTarget</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">sportScore</span> = t.<span class="property">data</span>.<span class="property">sportScore</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">venueFlag</span> = t.<span class="property">data</span>.<span class="property">venueFlag</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">avatarUrl</span> = t.<span class="property">data</span>.<span class="property">headUrl</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">nickName</span> = t.<span class="property">data</span>.<span class="property">nickName</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">realName</span> = t.<span class="property">data</span>.<span class="property">realName</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">mobileNo</span> = t.<span class="property">data</span>.<span class="property">mobileNo</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">sex</span> = t.<span class="property">data</span>.<span class="property">sex</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">schoolId</span> = t.<span class="property">data</span>.<span class="property">schoolId</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">academicYear</span> = t.<span class="property">data</span>.<span class="property">academicYear</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">term</span> = t.<span class="property">data</span>.<span class="property">term</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">schoolStatus</span> = t.<span class="property">data</span>.<span class="property">schoolStatus</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">runType</span> = t.<span class="property">data</span>.<span class="property">runType</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">accessType</span> = t.<span class="property">data</span>.<span class="property">accessType</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">prescription</span> = t.<span class="property">data</span>.<span class="property">prescription</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">uniappStatus</span> = t.<span class="property">data</span>.<span class="property">uniappStatus</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">uniappUrl</span> = t.<span class="property">data</span>.<span class="property">uniappUrl</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">runScoreType</span> = t.<span class="property">data</span>.<span class="property">runScoreType</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>.<span class="property">runRegular</span> = t.<span class="property">data</span>.<span class="property">runRegular</span> ? t.<span class="property">data</span>.<span class="property">runRegular</span> : <span class="number">1</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span> = t.<span class="property">data</span>.<span class="property">openid</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span> = t.<span class="property">data</span>.<span class="property">userid</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">approveStatus</span> = t.<span class="property">data</span>.<span class="property">approveStatus</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">isExist</span> = t.<span class="property">data</span>.<span class="property">isExist</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">studentNo</span> = t.<span class="property">data</span>.<span class="property">studentNo</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userType</span> = t.<span class="property">data</span>.<span class="property">userType</span>, </span><br><span class="line">                wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userStatus&quot;</span>, e.<span class="property">globalData</span>.<span class="property">userStatus</span>), wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;schoolInfo&quot;</span>, e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>), </span><br><span class="line">                wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userInfo&quot;</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>), wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;openid&quot;</span>, t.<span class="property">data</span>.<span class="property">openid</span>), </span><br><span class="line">                wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userid&quot;</span>, t.<span class="property">data</span>.<span class="property">userid</span>), o.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">userInfo</span>: e.<span class="property">globalData</span>.<span class="property">userInfo</span>,</span><br><span class="line">                    <span class="attr">schoolInfo</span>: e.<span class="property">globalData</span>.<span class="property">schoolInfo</span>,</span><br><span class="line">                    <span class="attr">runType</span>: t.<span class="property">data</span>.<span class="property">runType</span>,</span><br><span class="line">                    <span class="attr">applyCount</span>: t.<span class="property">data</span>.<span class="property">applyCount</span>,</span><br><span class="line">                    <span class="attr">runExplain1</span>: t.<span class="property">data</span>.<span class="property">runExplain1</span>,</span><br><span class="line">                    <span class="attr">runExplain2</span>: t.<span class="property">data</span>.<span class="property">runExplain2</span>,</span><br><span class="line">                    <span class="attr">runExplain3</span>: t.<span class="property">data</span>.<span class="property">runExplain3</span>,</span><br><span class="line">                    <span class="attr">venueFlag</span>: t.<span class="property">data</span>.<span class="property">venueFlag</span>,</span><br><span class="line">                    <span class="attr">dayStartRunStatus</span>: t.<span class="property">data</span>.<span class="property">dayStartRunStatus</span>,</span><br><span class="line">                    <span class="attr">message</span>: t.<span class="property">data</span>.<span class="property">message</span>,</span><br><span class="line">                    <span class="attr">suspendStatus</span>: t.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">                &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getHome&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getPersonaldata</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;userid&quot;</span>), a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>), o = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getPersonaldata?openid=&quot;</span> + a + <span class="string">&quot;&amp;userid=&quot;</span> + t,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != t.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getPersonaldata500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ? (e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">mileage</span> = t.<span class="property">data</span>.<span class="property">mileage</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">validCount</span> = t.<span class="property">data</span>.<span class="property">validCount</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">mileagePercent</span> = t.<span class="property">data</span>.<span class="property">mileagePercent</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">countPercent</span> = t.<span class="property">data</span>.<span class="property">countPercent</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">ranking</span> = t.<span class="property">data</span>.<span class="property">ranking</span> ? t.<span class="property">data</span>.<span class="property">ranking</span> : <span class="number">0</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">runScore</span> = t.<span class="property">data</span>.<span class="property">runScore</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>.<span class="property">scorePercent</span> = t.<span class="property">data</span>.<span class="property">scorePercent</span>, </span><br><span class="line">                e.<span class="property">globalData</span>.<span class="property">getPersonaldata</span> = <span class="number">1</span>, wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;userInfo&quot;</span>, e.<span class="property">globalData</span>.<span class="property">userInfo</span>), </span><br><span class="line">                o.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">userInfo</span>: e.<span class="property">globalData</span>.<span class="property">userInfo</span></span><br><span class="line">                &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getPersonaldata&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">removeRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileage&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runmeters&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;minTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;filePath&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runType&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lineArray&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;markers&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;punchCardSum&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>), </span><br><span class="line">        wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;stoppoint&quot;</span>), <span class="variable language_">this</span>.<span class="property">inselectalertview3</span>.<span class="title function_">hideAlertView</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getExerciseStatus</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, a = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, o = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), n = <span class="variable language_">this</span>, i = &#123;&#125;;</span><br><span class="line">        i.<span class="property">openid</span> = a, i.<span class="property">userid</span> = t, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getExerciseStatus?openid=&quot;</span> + a + <span class="string">&quot;&amp;detailId=&quot;</span> + o,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>) wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常venueCardTotal500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;); <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!n.<span class="property">data</span>.<span class="property">locationEnabled</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) : <span class="number">0</span>;</span><br><span class="line">                        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>, t + <span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">1</span> == e.<span class="property">data</span>.<span class="property">runStatus</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>);</span><br><span class="line">                        a = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> * a) / <span class="number">100</span>, n.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                            <span class="attr">endcontent</span>: <span class="string">&quot;此次跑步已结束！您本次跑程距离为&quot;</span>,</span><br><span class="line">                            <span class="attr">endcontent1</span>: a,</span><br><span class="line">                            <span class="attr">endcontent2</span>: <span class="string">&quot;km，防止数据丢失，请截图后！！再结束上次跑步数据？&quot;</span></span><br><span class="line">                        &#125;), n.<span class="property">inselectalertview3</span>.<span class="title function_">showAlertView</span>();</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">2</span> == e.<span class="property">data</span>.<span class="property">runStatus</span>) &#123;</span><br><span class="line">                        a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>);</span><br><span class="line">                        a = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> * a) / <span class="number">100</span>, n.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                            <span class="attr">endcontent</span>: <span class="string">&quot;暂无运动明细！您本次跑程距离为&quot;</span>,</span><br><span class="line">                            <span class="attr">endcontent1</span>: a,</span><br><span class="line">                            <span class="attr">endcontent2</span>: <span class="string">&quot;km，防止数据丢失，请截图后！！再结束上次跑步数据？&quot;</span></span><br><span class="line">                        &#125;), n.<span class="property">inselectalertview3</span>.<span class="title function_">showAlertView</span>();</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> ((a = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> * a) / <span class="number">100</span>) &lt; wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>)) n.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                            <span class="attr">endcontent</span>: <span class="string">&quot;由于低于目标里程，结束将&quot;</span>,</span><br><span class="line">                            <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">                            <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。 您确定要结束吗？&quot;</span></span><br><span class="line">                        &#125;), n.<span class="property">endview</span>.<span class="title function_">showAlertView</span>(); <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">var</span> o = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>);</span><br><span class="line">                            <span class="number">0</span> == o || <span class="number">1</span> == o ? (n.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                <span class="attr">endcontent</span>: <span class="string">&quot;您本次跑程距离为&quot;</span>,</span><br><span class="line">                                <span class="attr">endcontent1</span>: a,</span><br><span class="line">                                <span class="attr">endcontent2</span>: <span class="string">&quot;km，您确定要结束吗？&quot;</span></span><br><span class="line">                            &#125;), n.<span class="property">endview</span>.<span class="title function_">showAlertView</span>()) : (n.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                <span class="attr">endcontent</span>: <span class="string">&quot;您本次跑程距离为&quot;</span>,</span><br><span class="line">                                <span class="attr">endcontent1</span>: a,</span><br><span class="line">                                <span class="attr">endcontent2</span>: <span class="string">&quot;km，请前往打卡点结束？&quot;</span></span><br><span class="line">                            &#125;), n.<span class="property">inselectalertview2</span>.<span class="title function_">showAlertView</span>());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常getExerciseStatus&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">hisData</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, a = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, o = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>;</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getRunsituation?userid=&quot;</span> + a + <span class="string">&quot;&amp;openid=&quot;</span> + o + <span class="string">&quot;&amp;dateDay=&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>) wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常venueCardTotal500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;); <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> a = [], o = [], n = e.<span class="property">data</span>.<span class="property">detailList</span>, i = <span class="number">0</span>; i &lt; n.<span class="property">length</span>; i++) a.<span class="title function_">push</span>(n[i].<span class="property">runDate</span>), </span><br><span class="line">                    o.<span class="title function_">push</span>(<span class="number">3</span> * n[i].<span class="property">mileage</span>);</span><br><span class="line">                    t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">hisdata</span>: &#123;</span><br><span class="line">                            <span class="attr">datedata</span>: a,</span><br><span class="line">                            <span class="attr">kilodata</span>: o</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">var</span> r = &#123;&#125;;</span><br><span class="line">                    r[<span class="string">&quot;columnCanvasData.yAxis.minData&quot;</span>] = <span class="number">0</span>, r[<span class="string">&quot;columnCanvasData.yAxis.maxData&quot;</span>] = <span class="number">50</span>, </span><br><span class="line">                    r[<span class="string">&quot;columnCanvasData.series&quot;</span>] = [ &#123;</span><br><span class="line">                        <span class="attr">data</span>: t.<span class="property">data</span>.<span class="property">hisdata</span>.<span class="property">kilodata</span></span><br><span class="line">                    &#125; ], r[<span class="string">&quot;columnCanvasData.xAxis.data&quot;</span>] = t.<span class="property">data</span>.<span class="property">hisdata</span>.<span class="property">datedata</span>, t.<span class="title function_">setData</span>(r);</span><br><span class="line">                &#125; <span class="keyword">else</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常venueCardTotal&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeEvent</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">alertview</span>.<span class="title function_">hideAlertView</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeEvent3</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#authview&quot;</span>).<span class="title function_">hideAlertView</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">cancelEvent</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>), t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(), <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">isBlueOpen</span> ? (<span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span> ? (<span class="variable language_">this</span>.<span class="property">endalertview3</span>.<span class="title function_">hideAlertView</span>(), <span class="keyword">void</span> wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/changguang/cgqiandao&quot;</span></span><br><span class="line">        &#125;)) : (t.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>)) : (e.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">venueCardEnd</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>, o = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, n = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, i = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;venueId&quot;</span>), r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardid&quot;</span>), s = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;deviceId&quot;</span>), u = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() / <span class="number">1e3</span>).<span class="title function_">toString</span>();</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/venueCardStart?openid=&quot;</span> + o + <span class="string">&quot;&amp;userid=&quot;</span> + n + <span class="string">&quot;&amp;venueId=&quot;</span> + i + <span class="string">&quot;&amp;cardFlag=2&amp;cardid=&quot;</span> + r + <span class="string">&quot;&amp;deviceId=&quot;</span> + s + <span class="string">&quot;&amp;timestamp=&quot;</span> + u + <span class="string">&quot;&amp;endFlag=1&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != t.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常venueCardTotal500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ? (e.<span class="property">globalData</span>.<span class="property">getVenuedata</span> = <span class="number">1</span>, wx.<span class="title function_">hideLoading</span>(), </span><br><span class="line">                a.<span class="title function_">stopLocationUpdate</span>(), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardid&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueId&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueName&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;itemName&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardRate&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardRateMax&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardNumber&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastdata&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runnewdata&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;starttime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;qiandaoStatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailsArray&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;yxvalidCount&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;invalidCount&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardArray&quot;</span>), </span><br><span class="line">                a.<span class="property">endalertview3</span>.<span class="title function_">hideAlertView</span>()) : (wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;));</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常venueCardStart&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getMessageList2</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, a = &#123;&#125;;</span><br><span class="line">        a.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, a.<span class="property">userid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, </span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getMessageList2&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: a,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != a.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getMessageList2500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == a.<span class="property">data</span>.<span class="property">retcode</span> ? (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">messageList</span>: a.<span class="property">data</span>.<span class="property">messageList</span>,</span><br><span class="line">                    <span class="attr">messageIds</span>: a.<span class="property">data</span>.<span class="property">messageIds</span>,</span><br><span class="line">                    <span class="attr">messageSize</span>: a.<span class="property">data</span>.<span class="property">messageSize</span></span><br><span class="line">                &#125;), t.<span class="property">data</span>.<span class="property">messageSize</span> &gt; <span class="number">0</span> ? wx.<span class="title function_">setTabBarBadge</span>(&#123;</span><br><span class="line">                    <span class="attr">index</span>: <span class="number">2</span>,</span><br><span class="line">                    <span class="attr">text</span>: t.<span class="property">data</span>.<span class="property">messageSize</span>.<span class="title function_">toString</span>()</span><br><span class="line">                &#125;) : wx.<span class="title function_">removeTabBarBadge</span>(&#123;</span><br><span class="line">                    <span class="attr">index</span>: <span class="number">2</span></span><br><span class="line">                &#125;), e.<span class="property">globalData</span>.<span class="property">getMessageList2</span> = <span class="number">1</span>) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: a.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常getMessageList2&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">addMessageUser</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, a = &#123;&#125;;</span><br><span class="line">        a.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, a.<span class="property">userid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, </span><br><span class="line">        a.<span class="property">messageId</span> = t.<span class="property">data</span>.<span class="property">messageIds</span>, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/addMessageUser&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: a,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常addMessageUser2500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">messageSize</span>: <span class="number">0</span></span><br><span class="line">                &#125;) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常addMessageUser&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">invenueCardEnd</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>, o = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, n = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>, i = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;venueId&quot;</span>), r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardid&quot;</span>), s = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;deviceId&quot;</span>), u = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() / <span class="number">1e3</span>).<span class="title function_">toString</span>();</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/venueCardStart?openid=&quot;</span> + o + <span class="string">&quot;&amp;userid=&quot;</span> + n + <span class="string">&quot;&amp;venueId=&quot;</span> + i + <span class="string">&quot;&amp;cardFlag=2&amp;cardid=&quot;</span> + r + <span class="string">&quot;&amp;deviceId=&quot;</span> + s + <span class="string">&quot;&amp;timestamp=&quot;</span> + u + <span class="string">&quot;&amp;endFlag=2&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != t.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常venueCardTotal500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ? (e.<span class="property">globalData</span>.<span class="property">getVenuedata</span> = <span class="number">1</span>, a.<span class="title function_">stopLocationUpdate</span>(), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceId&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardid&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueId&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;venueName&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;itemName&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardRate&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardRateMax&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardNumber&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastdata&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runnewdata&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;starttime&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;qiandaoStatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailsArray&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;yxvalidCount&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;invalidCount&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;cardArray&quot;</span>), a.<span class="property">inselectalertview</span>.<span class="title function_">hideAlertView</span>()) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常venueCardStart&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onShow</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t;</span><br><span class="line">        (<span class="number">0</span> == e.<span class="property">globalData</span>.<span class="property">getHome</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getHome</span>(), <span class="number">0</span> == e.<span class="property">globalData</span>.<span class="property">getPersonaldata</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getPersonaldata</span>(), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(), <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getExerciseStatus</span>(), </span><br><span class="line">        <span class="number">0</span> == e.<span class="property">globalData</span>.<span class="property">getMessageList2</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getMessageList2</span>(), <span class="literal">null</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardid&quot;</span>) &amp;&amp; <span class="string">&quot;&quot;</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardid&quot;</span>)) &amp;&amp; (<span class="keyword">new</span> <span class="title class_">Date</span>() - wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;lastdata&quot;</span>) &lt;= <span class="number">216e5</span> ? ((t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;yxvalidCount&quot;</span>)) &lt; wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardNumber&quot;</span>) ? <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">endcontent</span>: <span class="string">&quot;由于低于打卡有效规定次数，结束将&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。 您确定要结束吗？&quot;</span></span><br><span class="line">        &#125;) : <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">endcontent</span>: <span class="string">&quot;您本次有效打卡次数为&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent1</span>: t,</span><br><span class="line">            <span class="attr">endcontent2</span>: <span class="string">&quot;次，您确定要结束吗？&quot;</span></span><br><span class="line">        &#125;), <span class="variable language_">this</span>.<span class="property">endalertview3</span>.<span class="title function_">showAlertView</span>()) : ((t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;yxvalidCount&quot;</span>)) &lt; wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;cardNumber&quot;</span>) ? <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">endcontent</span>: <span class="string">&quot;由于低于打卡有效规定次数，结束将&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。 您确定要结束吗？&quot;</span></span><br><span class="line">        &#125;) : <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">endcontent</span>: <span class="string">&quot;您本次有效打卡次数为&quot;</span>,</span><br><span class="line">            <span class="attr">endcontent1</span>: t,</span><br><span class="line">            <span class="attr">endcontent2</span>: <span class="string">&quot;次，您确定要结束吗？&quot;</span></span><br><span class="line">        &#125;), <span class="variable language_">this</span>.<span class="property">inselectalertview</span>.<span class="title function_">showAlertView</span>()));</span><br><span class="line">        <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">timeStartRunStatus</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getTimeStatus</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">writeFile</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = <span class="variable language_">this</span>, n = wx.<span class="title function_">getFileSystemManager</span>(), i = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>);</span><br><span class="line">        n.<span class="title function_">access</span>(&#123;</span><br><span class="line">            <span class="attr">path</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">r</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">var</span> s = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>(), u = &#123;&#125;;</span><br><span class="line">                u.<span class="property">openid</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>), u.<span class="property">fileType</span> = <span class="number">2</span>, u.<span class="property">imageType</span> = <span class="number">1</span>, u.<span class="property">batchNo</span> = s;</span><br><span class="line">                <span class="keyword">var</span> l = t.<span class="title function_">sortKey</span>(u, e.<span class="property">globalData</span>.<span class="property">datakey</span>), d = a.<span class="title function_">hexMD5</span>(l);</span><br><span class="line">                wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">                    <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">                    <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">                    <span class="attr">header</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">formData</span>: &#123;</span><br><span class="line">                        <span class="attr">openid</span>: wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>),</span><br><span class="line">                        <span class="attr">fileType</span>: <span class="number">2</span>,</span><br><span class="line">                        <span class="attr">imageType</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                        <span class="attr">batchNo</span>: s,</span><br><span class="line">                        <span class="attr">sign</span>: d,</span><br><span class="line">                        <span class="attr">detailId</span>: i,</span><br><span class="line">                        <span class="attr">uploadImagetype</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                        wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                        &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? (o.<span class="property">data</span>.<span class="property">fileId</span> = e.<span class="property">data</span>.<span class="property">fileId</span>, n.<span class="title function_">unlink</span>(&#123;</span><br><span class="line">                            <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;,</span><br><span class="line">                            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;</span><br><span class="line">                        &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                        wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常uploadFile&quot;</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">r</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">var</span> s = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>).<span class="title function_">join</span>(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">                    n.<span class="title function_">writeFile</span>(&#123;</span><br><span class="line">                        <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                        <span class="attr">data</span>: s,</span><br><span class="line">                        <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">                        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">r</span>) &#123;</span><br><span class="line">                            wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">                                <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="keyword">var</span> s = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>(), u = &#123;&#125;;</span><br><span class="line">                            u.<span class="property">openid</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>), u.<span class="property">fileType</span> = <span class="number">2</span>, u.<span class="property">imageType</span> = <span class="number">1</span>, u.<span class="property">batchNo</span> = s;</span><br><span class="line">                            <span class="keyword">var</span> l = t.<span class="title function_">sortKey</span>(u, e.<span class="property">globalData</span>.<span class="property">datakey</span>), d = a.<span class="title function_">hexMD5</span>(l);</span><br><span class="line">                            wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">                                <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">                                <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                                <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">                                <span class="attr">header</span>: &#123;</span><br><span class="line">                                    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">formData</span>: &#123;</span><br><span class="line">                                    <span class="attr">openid</span>: wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>),</span><br><span class="line">                                    <span class="attr">fileType</span>: <span class="number">2</span>,</span><br><span class="line">                                    <span class="attr">imageType</span>: <span class="number">1</span>,</span><br><span class="line">                                    <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                                    <span class="attr">batchNo</span>: s,</span><br><span class="line">                                    <span class="attr">sign</span>: d,</span><br><span class="line">                                    <span class="attr">detailId</span>: i,</span><br><span class="line">                                    <span class="attr">uploadImagetype</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                                    wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                        <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                        <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                    &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? (o.<span class="property">data</span>.<span class="property">fileId</span> = e.<span class="property">data</span>.<span class="property">fileId</span>, n.<span class="title function_">unlink</span>(&#123;</span><br><span class="line">                                        <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                                        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;,</span><br><span class="line">                                        <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;</span><br><span class="line">                                    &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                        <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                                        <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                                        <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                                    wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                        <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常uploadFile&quot;</span>,</span><br><span class="line">                                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                        <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopRunBut</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fileId</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">writeFile</span>(), <span class="number">4</span> == wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>) ? <span class="variable language_">this</span>.<span class="title function_">apiStopRun</span>() : <span class="variable language_">this</span>.<span class="title function_">stopRun</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">apiStopRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = <span class="variable language_">this</span>;</span><br><span class="line">        o.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">        <span class="keyword">var</span> n = &#123;&#125;, i = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) / <span class="number">1e3</span>, r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) || <span class="number">0</span>;</span><br><span class="line">        n.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, n.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">        n.<span class="property">longitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">latitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">runType</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>), n.<span class="property">endTime</span> = i, </span><br><span class="line">        n.<span class="property">mileage</span> = r;</span><br><span class="line">        <span class="keyword">var</span> s = t.<span class="title function_">sortKey</span>(n, e.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">        n.<span class="property">sign</span> = a.<span class="title function_">hexMD5</span>(s), n.<span class="property">extentStatus</span> = <span class="number">1</span>, n.<span class="property">continueCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>) : <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">positionCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) : <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">seqNo</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) : <span class="number">0</span>, n.<span class="property">runBitmap</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>) : <span class="string">&quot;&quot;</span>, </span><br><span class="line">        n.<span class="property">remarks</span> = <span class="string">&quot;999999&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> u = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) : [], l = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) : [], d = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) : <span class="number">0</span>, c = u.<span class="property">length</span>;</span><br><span class="line">        <span class="keyword">if</span> (c == l.<span class="property">length</span>) n.<span class="property">suspendTime</span> = d / <span class="number">1e3</span>; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> g = i - u[c - <span class="number">1</span>];</span><br><span class="line">            n.<span class="property">suspendTime</span> = (d + g) / <span class="number">1e3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        n.<span class="property">suspendCount</span> = c, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/stopSchoolRun&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: n,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。服务器异常stopSchoolRun&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? (o.<span class="title function_">getPersonaldata</span>(), o.<span class="title function_">getHome</span>(), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileage&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runmeters&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;minTime&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;filePath&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startType&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lineArray&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;markers&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;punchCardSum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;stoppoint&quot;</span>), o.<span class="property">endview</span>.<span class="title function_">hideAlertView</span>()) : <span class="string">&quot;000015&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopSchoolRun&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopRun&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = <span class="variable language_">this</span>;</span><br><span class="line">        o.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">        <span class="keyword">var</span> n = &#123;&#125;, i = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()), r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) || <span class="number">0</span>;</span><br><span class="line">        r = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="number">100</span> * r) / <span class="number">100</span>, n.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, n.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">        n.<span class="property">longitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">latitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">endTime</span> = i / <span class="number">1e3</span>, n.<span class="property">mileage</span> = r, n.<span class="property">runType</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> s = t.<span class="title function_">sortKey</span>(n, e.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">        n.<span class="property">sign</span> = a.<span class="title function_">hexMD5</span>(s), n.<span class="property">extentStatus</span> = <span class="number">1</span>, n.<span class="property">continueCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>) || <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">positionCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) || <span class="number">0</span>, n.<span class="property">seqNo</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) : <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">remarks</span> = <span class="string">&quot;999999&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> u = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) : [], l = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) : [], d = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) : <span class="number">0</span>, c = u.<span class="property">length</span>;</span><br><span class="line">        <span class="keyword">if</span> (c == l.<span class="property">length</span>) n.<span class="property">suspendTime</span> = d / <span class="number">1e3</span>; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> g = i - u[c - <span class="number">1</span>];</span><br><span class="line">            n.<span class="property">suspendTime</span> = (d + g) / <span class="number">1e3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        n.<span class="property">suspendCount</span> = c, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/stopRun&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: n,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常2500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? (o.<span class="title function_">getPersonaldata</span>(), o.<span class="title function_">getHome</span>(), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileage&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runmeters&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;minTime&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;filePath&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>), o.<span class="property">endview</span>.<span class="title function_">hideAlertView</span>()) : <span class="string">&quot;000015&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常stopRun2&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">instopRunBut</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fileId</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">writeFile</span>(), <span class="number">4</span> == wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>) ? <span class="variable language_">this</span>.<span class="title function_">apiStopRun</span>() : <span class="variable language_">this</span>.<span class="title function_">instopRun</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">instopRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = <span class="variable language_">this</span>;</span><br><span class="line">        o.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">        <span class="keyword">var</span> n = &#123;&#125;, i = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()), r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) : <span class="number">0</span>;</span><br><span class="line">        r = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="number">100</span> * r) / <span class="number">100</span>, n.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, n.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">        n.<span class="property">longitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">latitude</span> = <span class="string">&quot;&quot;</span>, n.<span class="property">endTime</span> = i / <span class="number">1e3</span>, n.<span class="property">mileage</span> = r, n.<span class="property">runType</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> s = t.<span class="title function_">sortKey</span>(n, e.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">        n.<span class="property">sign</span> = a.<span class="title function_">hexMD5</span>(s), n.<span class="property">extentStatus</span> = <span class="number">1</span>, n.<span class="property">continueCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>) : <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">positionCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>) : <span class="number">0</span>, </span><br><span class="line">        n.<span class="property">seqNo</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) : <span class="number">0</span>, n.<span class="property">remarks</span> = <span class="string">&quot;999999&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> u = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>) : [], l = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>) : [], d = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>) : <span class="number">0</span>, c = u.<span class="property">length</span>;</span><br><span class="line">        <span class="keyword">if</span> (c == l.<span class="property">length</span>) n.<span class="property">suspendTime</span> = d / <span class="number">1e3</span>; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> g = i - u[c - <span class="number">1</span>];</span><br><span class="line">            n.<span class="property">suspendTime</span> = (d + g) / <span class="number">1e3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        n.<span class="property">suspendCount</span> = c, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/stopRun&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: n,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常stopRun2500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;) : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? (o.<span class="title function_">getPersonaldata</span>(), o.<span class="title function_">getHome</span>(), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;detailId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileage&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runmeters&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;minTime&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;filePath&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;runType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;startType&quot;</span>), wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>), </span><br><span class="line">                wx.<span class="title function_">removeStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>), o.<span class="property">inselectalertview2</span>.<span class="title function_">hideAlertView</span>()) : <span class="string">&quot;000015&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span> ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，网络或服务器异常stopRun2&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopLocationUpdate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">offLocationChange</span>(), wx.<span class="title function_">stopLocationUpdate</span>(&#123;</span><br><span class="line">            <span class="attr">complete</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>), t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(), !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">isBlueOpen</span>) <span class="keyword">return</span> e.<span class="title function_">showAlertView</span>(), </span><br><span class="line">        !<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span>) <span class="keyword">return</span> t.<span class="title function_">showAlertView</span>(), </span><br><span class="line">        !<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">runstatus</span>: <span class="number">1</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>), o = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>) : <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">endview</span>.<span class="title function_">hideAlertView</span>(), wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/paobu?runType=&quot;</span> + a + <span class="string">&quot;&amp;startType=&quot;</span> + o + <span class="string">&quot;&amp;suspendStatus=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">ingotoRun</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>), t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(), !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">isBlueOpen</span>) <span class="keyword">return</span> e.<span class="title function_">showAlertView</span>(), </span><br><span class="line">        !<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span>) <span class="keyword">return</span> t.<span class="title function_">showAlertView</span>(), </span><br><span class="line">        !<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">runstatus</span>: <span class="number">1</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runType&quot;</span>), o = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>) : <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">inselectalertview2</span>.<span class="title function_">hideAlertView</span>(), wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/paobu?runType=&quot;</span> + a + <span class="string">&quot;&amp;startType=&quot;</span> + o + <span class="string">&quot;&amp;suspendStatus=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">goToPanbao</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">             wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;/pages/index/xianlu?runType=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span> + <span class="string">&quot;&amp;applyCount=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">applyCount</span> + <span class="string">&quot;&amp;suspendStatus=&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">suspendStatus</span></span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoSeting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/user/setting&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoRank</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/rank&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoHelp</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/index/guize&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">gotoRecord</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;/pages/user/record&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onReady</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">onPullDownRefresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="number">0</span> == e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">isExist</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">authLogin</span>(), <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">dayStartRunStatus</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getHome</span>(), </span><br><span class="line">        <span class="number">0</span> == e.<span class="property">globalData</span>.<span class="property">getMessageList2</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getMessageList2</span>(), <span class="number">0</span> != <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">dayStartRunStatus</span> &amp;&amp; <span class="number">0</span> != <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">timeStartRunStatus</span> || <span class="variable language_">this</span>.<span class="title function_">getTimeStatus</span>(), </span><br><span class="line">        wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getExerciseStatus</span>(), wx.<span class="title function_">stopPullDownRefresh</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="8-修改pages-index-xinalu-js"><a href="#8-修改pages-index-xinalu-js" class="headerlink" title="8.修改pages&#x2F;index&#x2F;xinalu.js"></a>8.修改pages&#x2F;index&#x2F;xinalu.js</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="built_in">require</span>(<span class="string">&quot;../../@babel/runtime/helpers/defineProperty&quot;</span>), e = <span class="title function_">getApp</span>(), a = <span class="keyword">new</span> (<span class="built_in">require</span>(<span class="string">&quot;../../0D86247153E228FF6BE04C7685F07075.js&quot;</span>))(&#123;</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&quot;AT6BZ-AHKKU-4GFVL-2NJGZ-DM4HQ-3AFLV&quot;</span></span><br><span class="line">&#125;), i = <span class="built_in">require</span>(<span class="string">&quot;../../43BA1E1353E228FF25DC7614A0117075.js&quot;</span>), o = <span class="built_in">require</span>(<span class="string">&quot;../../9E8EA57053E228FFF8E8CD77A2E07075.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">n</span>(<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> e = t.<span class="title function_">slice</span>(<span class="number">7</span>, <span class="number">13</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span>.<span class="title function_">call</span>(<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(e), <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;00&quot;</span> + t.<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">slice</span>(-<span class="number">2</span>);</span><br><span class="line">    &#125;).<span class="title function_">join</span>(<span class="string">&quot;:&quot;</span>).<span class="title function_">toUpperCase</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">navbarData</span>: &#123;</span><br><span class="line">            <span class="attr">showCapsule</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;线路&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">navheight</span>: e.<span class="property">globalData</span>.<span class="property">navBarHeight</span>,</span><br><span class="line">        <span class="attr">winHeight</span>: e.<span class="property">globalData</span>.<span class="property">windowHeight</span>,</span><br><span class="line">        <span class="attr">statusBarHeight</span>: e.<span class="property">globalData</span>.<span class="property">statusBarHeight</span>,</span><br><span class="line">        <span class="attr">screenHeight</span>: e.<span class="property">globalData</span>.<span class="property">screenHeight</span>,</span><br><span class="line">        <span class="attr">latitude</span>: <span class="number">39.908836</span>,</span><br><span class="line">        <span class="attr">longitude</span>: <span class="number">116.397463</span>,</span><br><span class="line">        <span class="attr">initlatitude</span>: <span class="number">39.908836</span>,</span><br><span class="line">        <span class="attr">initlongitude</span>: <span class="number">116.397463</span>,</span><br><span class="line">        <span class="attr">polyline</span>: [],</span><br><span class="line">        <span class="attr">markers</span>: [],</span><br><span class="line">        <span class="attr">lineArray</span>: [],</span><br><span class="line">        <span class="attr">from</span>: &#123;</span><br><span class="line">            <span class="attr">latitude</span>: <span class="number">39.908836</span>,</span><br><span class="line">            <span class="attr">longitude</span>: <span class="number">116.397463</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">to</span>: &#123;</span><br><span class="line">            <span class="attr">latitude</span>: <span class="number">39.908836</span>,</span><br><span class="line">            <span class="attr">longitude</span>: <span class="number">116.397463</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">extendType</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">runType</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">applyCount</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">lineId</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">deviceId</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">distance</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">inregion</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">startType</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">fileName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">filePath</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">batchNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">runCheckStatus</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">uploadType</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">deviceType</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">fileId</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">suspendStatus</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopBluetooth</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">stopBluetoothDevicesDiscovery</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">closeBluetoothAdapter</span>(&#123;</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">runPaobu</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="variable language_">this</span>;</span><br><span class="line">        e.<span class="title function_">stopLocationUpdate</span>(),</span><br><span class="line">        e.<span class="title function_">stopBluetooth</span>(),</span><br><span class="line">        wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">          <span class="attr">url</span>:</span><br><span class="line">            <span class="string">&quot;/pages/index/paobu?runType=&quot;</span> +</span><br><span class="line">            e.<span class="property">data</span>.<span class="property">runType</span> +</span><br><span class="line">            <span class="string">&quot;&amp;lineId=&quot;</span> +</span><br><span class="line">            e.<span class="property">data</span>.<span class="property">lineId</span> +</span><br><span class="line">            <span class="string">&quot;&amp;batchNo=&quot;</span> +</span><br><span class="line">            e.<span class="property">data</span>.<span class="property">batchNo</span> +</span><br><span class="line">            <span class="string">&quot;&amp;startType=&quot;</span> +</span><br><span class="line">            e.<span class="property">data</span>.<span class="property">startType</span> +</span><br><span class="line">            <span class="string">&quot;&amp;suspendStatus=&quot;</span> +</span><br><span class="line">            e.<span class="property">data</span>.<span class="property">suspendStatus</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getLocation</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">getLocation</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;gcj02&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">latitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">                    <span class="attr">longitude</span>: e.<span class="property">longitude</span>,</span><br><span class="line">                    <span class="attr">initlatitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">                    <span class="attr">initlongitude</span>: e.<span class="property">longitude</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;getLocation错误&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">sdrunPunchCard</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> == t.<span class="property">data</span>.<span class="property">deviceType</span>) wx.<span class="title function_">getBluetoothDevices</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> d = <span class="number">0</span>; d &lt; a.<span class="property">devices</span>.<span class="property">length</span>; d++) <span class="keyword">if</span> ((<span class="string">&quot;xBeacon&quot;</span> == a.<span class="property">devices</span>[d].<span class="property">localName</span> || <span class="string">&quot;xBeacon&quot;</span> == a.<span class="property">devices</span>[d].<span class="property">name</span>) &amp;&amp; <span class="literal">null</span> != a.<span class="property">devices</span>[d].<span class="property">serviceData</span> &amp;&amp; <span class="literal">null</span> != a.<span class="property">devices</span>[d].<span class="property">serviceData</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a.<span class="property">devices</span>[d].<span class="property">serviceData</span>.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;00001529-0000-1000-8000-00805F9B34FB&quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> s = <span class="number">0</span>; s &lt; t.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>; s++) <span class="keyword">if</span> (t.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceAddress</span> == <span class="title function_">n</span>(a.<span class="property">devices</span>[d].<span class="property">serviceData</span>[<span class="string">&quot;00001529-0000-1000-8000-00805F9B34FB&quot;</span>])) &#123;</span><br><span class="line">                            <span class="keyword">var</span> l, r;</span><br><span class="line">                            <span class="keyword">if</span> (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                <span class="attr">inregion</span>: <span class="number">1</span>,</span><br><span class="line">                                <span class="attr">deviceId</span>: t.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceId</span></span><br><span class="line">                            &#125;), t.<span class="property">data</span>.<span class="property">deviceId</span> &gt; <span class="number">0</span> &amp;&amp; <span class="number">1</span> == t.<span class="property">data</span>.<span class="property">startType</span> || <span class="number">0</span> == t.<span class="property">data</span>.<span class="property">startType</span>) !<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                l = &#123;&#125;;</span><br><span class="line">                                <span class="keyword">var</span> a = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>();</span><br><span class="line">                                l.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, l.<span class="property">fileType</span> = <span class="number">1</span>, l.<span class="property">imageType</span> = <span class="number">5</span>, l.<span class="property">schoolId</span> = t.<span class="property">data</span>.<span class="property">schoolId</span>, </span><br><span class="line">                                l.<span class="property">batchNo</span> = a;</span><br><span class="line">                                <span class="keyword">var</span> n = i.<span class="title function_">sortKey</span>(l, e.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">                                r = o.<span class="title function_">hexMD5</span>(n), wx.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">                                    <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">                                    <span class="attr">sizeType</span>: [ <span class="string">&quot;compressed&quot;</span> ],</span><br><span class="line">                                    <span class="attr">sourceType</span>: [ <span class="string">&quot;camera&quot;</span> ],</span><br><span class="line">                                    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">i</span>) &#123;</span><br><span class="line">                                        <span class="keyword">var</span> o = i.<span class="property">tempFilePaths</span>[<span class="number">0</span>];</span><br><span class="line">                                        wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">                                            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">                                            <span class="attr">filePath</span>: o,</span><br><span class="line">                                            <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">                                            <span class="attr">header</span>: &#123;</span><br><span class="line">                                                <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">                                            &#125;,</span><br><span class="line">                                            <span class="attr">formData</span>: &#123;</span><br><span class="line">                                                <span class="attr">openid</span>: e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>,</span><br><span class="line">                                                <span class="attr">fileType</span>: <span class="number">1</span>,</span><br><span class="line">                                                <span class="attr">schoolId</span>: t.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">                                                <span class="attr">imageType</span>: <span class="number">5</span>,</span><br><span class="line">                                                <span class="attr">batchNo</span>: a,</span><br><span class="line">                                                <span class="attr">sign</span>: r,</span><br><span class="line">                                                <span class="attr">detailId</span>: t.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">                                                <span class="attr">uploadImagetype</span>: <span class="number">1</span></span><br><span class="line">                                            &#125;,</span><br><span class="line">                                            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                                                <span class="keyword">var</span> a = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(e.<span class="property">data</span>);</span><br><span class="line">                                                <span class="string">&quot;000000&quot;</span> == a.<span class="property">retcode</span> ? (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                                    <span class="attr">fileName</span>: a.<span class="property">fileName</span>,</span><br><span class="line">                                                    <span class="attr">filePath</span>: a.<span class="property">fileUrl</span>,</span><br><span class="line">                                                    <span class="attr">batchNo</span>: a.<span class="property">batchNo</span></span><br><span class="line">                                                &#125;), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                                    <span class="attr">title</span>: <span class="string">&quot;上传成功&quot;</span>,</span><br><span class="line">                                                    <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                                                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                                                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                                &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                                    <span class="attr">title</span>: <span class="string">&quot;上传失败&quot;</span>,</span><br><span class="line">                                                    <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                                                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                                                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                                &#125;);</span><br><span class="line">                                            &#125;,</span><br><span class="line">                                            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                                    <span class="attr">title</span>: <span class="string">&quot;网络异常&quot;</span>,</span><br><span class="line">                                                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                                                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                                &#125;);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                    &#125;,</span><br><span class="line">                                    <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                            <span class="attr">title</span>: <span class="string">&quot;照片拍摄失败&quot;</span>,</span><br><span class="line">                                            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                                            <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                        &#125;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;);</span><br><span class="line">                            &#125;();</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="number">1</span> == t.<span class="property">data</span>.<span class="property">inregion</span>) &#123;</span><br><span class="line">                            t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                <span class="attr">inregion</span>: <span class="number">0</span></span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="number">0</span> == t.<span class="property">data</span>.<span class="property">inregion</span> &amp;&amp; wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&quot;请前往指定区域&quot;</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">3e3</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">            <span class="attr">complete</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;</span><br><span class="line">        &#125;); <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> a = t.<span class="property">data</span>.<span class="property">lineArray</span>;</span><br><span class="line">            <span class="keyword">if</span> (i.<span class="title function_">getDistanceMarkgpsks</span>(a, t.<span class="property">data</span>.<span class="property">latitude</span>, t.<span class="property">data</span>.<span class="property">longitude</span>, t.<span class="property">data</span>.<span class="property">searchDiam</span>) &gt; <span class="number">0</span> &amp;&amp; <span class="number">1</span> == t.<span class="property">data</span>.<span class="property">startType</span> || <span class="number">0</span> == t.<span class="property">data</span>.<span class="property">startType</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> d = &#123;&#125;, s = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>();</span><br><span class="line">                d.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, d.<span class="property">fileType</span> = <span class="number">1</span>, d.<span class="property">imageType</span> = <span class="number">5</span>, d.<span class="property">schoolId</span> = t.<span class="property">data</span>.<span class="property">schoolId</span>, </span><br><span class="line">                d.<span class="property">batchNo</span> = s;</span><br><span class="line">                <span class="keyword">var</span> l = i.<span class="title function_">sortKey</span>(d, e.<span class="property">globalData</span>.<span class="property">datakey</span>), r = o.<span class="title function_">hexMD5</span>(l);</span><br><span class="line">                wx.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">                    <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">sizeType</span>: [ <span class="string">&quot;compressed&quot;</span> ],</span><br><span class="line">                    <span class="attr">sourceType</span>: [ <span class="string">&quot;camera&quot;</span> ],</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> i = a.<span class="property">tempFilePaths</span>[<span class="number">0</span>];</span><br><span class="line">                        wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">                            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">                            <span class="attr">filePath</span>: i,</span><br><span class="line">                            <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">                            <span class="attr">header</span>: &#123;</span><br><span class="line">                                <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="attr">formData</span>: &#123;</span><br><span class="line">                                <span class="attr">openid</span>: e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>,</span><br><span class="line">                                <span class="attr">fileType</span>: <span class="number">1</span>,</span><br><span class="line">                                <span class="attr">schoolId</span>: t.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">                                <span class="attr">imageType</span>: <span class="number">5</span>,</span><br><span class="line">                                <span class="attr">batchNo</span>: s,</span><br><span class="line">                                <span class="attr">sign</span>: r,</span><br><span class="line">                                <span class="attr">detailId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                                <span class="attr">uploadImagetype</span>: <span class="number">1</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                                <span class="keyword">var</span> a = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(e.<span class="property">data</span>);</span><br><span class="line">                                <span class="string">&quot;000000&quot;</span> == a.<span class="property">retcode</span> ? (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                                    <span class="attr">fileName</span>: a.<span class="property">fileName</span>,</span><br><span class="line">                                    <span class="attr">filePath</span>: a.<span class="property">fileUrl</span>,</span><br><span class="line">                                    <span class="attr">batchNo</span>: a.<span class="property">batchNo</span></span><br><span class="line">                                &#125;), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                    <span class="attr">title</span>: <span class="string">&quot;上传成功&quot;</span>,</span><br><span class="line">                                    <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                &#125;)) : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                    <span class="attr">title</span>: <span class="string">&quot;上传失败&quot;</span>,</span><br><span class="line">                                    <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                &#125;);</span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                    <span class="attr">title</span>: <span class="string">&quot;网络异常&quot;</span>,</span><br><span class="line">                                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                                &#125;);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                            <span class="attr">title</span>: <span class="string">&quot;照片拍摄失败&quot;</span>,</span><br><span class="line">                            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                            <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;请前往指定区域&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">3e3</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">fromtoMap</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">mapCtx</span>.<span class="title function_">includePoints</span>(&#123;</span><br><span class="line">            <span class="attr">padding</span>: [ <span class="number">80</span>, <span class="number">50</span>, <span class="number">80</span>, <span class="number">50</span> ],</span><br><span class="line">            <span class="attr">points</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">markers</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getSchoolRunLine</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>, i = &#123;&#125;;</span><br><span class="line">        i.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, i.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">longitude</span>, i.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">latitude</span>, </span><br><span class="line">        i.<span class="property">extendType</span> = a.<span class="property">data</span>.<span class="property">extendType</span>, i.<span class="property">applyCount</span> = a.<span class="property">data</span>.<span class="property">applyCount</span>, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getSchoolRunLine&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: i,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>) wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getSchoolRunLine500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;); <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> i;</span><br><span class="line">                    <span class="number">1</span> == e.<span class="property">data</span>.<span class="property">deviceType</span> &amp;&amp; wx.<span class="title function_">openBluetoothAdapter</span>(&#123;</span><br><span class="line">                        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                            wx.<span class="title function_">startBluetoothDevicesDiscovery</span>(&#123;</span><br><span class="line">                                <span class="attr">powerLevel</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">                                <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                                <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                    wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                        <span class="attr">title</span>: <span class="string">&quot;开始搜寻蓝牙外围设备失败，请检查微信蓝牙权限设置&quot;</span>,</span><br><span class="line">                                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                        <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                                        <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&quot;初始化蓝牙模块失败，请检查微信蓝牙权限设置&quot;</span>,</span><br><span class="line">                                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                                <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">var</span> o = [], n = [], d = &#123;</span><br><span class="line">                        <span class="attr">id</span>: <span class="number">0</span></span><br><span class="line">                    &#125;;</span><br><span class="line">                    d.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">latitude</span>, d.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">longitude</span>, d.<span class="property">iconPath</span> = <span class="string">&quot;/images/run.png&quot;</span>, </span><br><span class="line">                    d.<span class="property">width</span> = <span class="number">25</span>, d.<span class="property">height</span> = <span class="number">25</span>, o.<span class="title function_">push</span>(d);</span><br><span class="line">                    <span class="keyword">var</span> s = &#123;&#125;;</span><br><span class="line">                    s.<span class="property">id</span> = e.<span class="property">data</span>.<span class="property">deviceId</span>, s.<span class="property">deviceId</span> = e.<span class="property">data</span>.<span class="property">deviceId</span>, s.<span class="property">latitude</span> = e.<span class="property">data</span>.<span class="property">latitude</span>, </span><br><span class="line">                    s.<span class="property">longitude</span> = e.<span class="property">data</span>.<span class="property">longitude</span>, s.<span class="property">deviceAddress</span> = e.<span class="property">data</span>.<span class="property">deviceAddress</span>, s.<span class="property">iconPath</span> = <span class="string">&quot;/images/21_position.png&quot;</span>, </span><br><span class="line">                    s.<span class="property">width</span> = <span class="number">25</span>, s.<span class="property">height</span> = <span class="number">25</span>, o.<span class="title function_">push</span>(s), n.<span class="title function_">push</span>(s);</span><br><span class="line">                    a.<span class="title function_">setData</span>((<span class="title function_">t</span>(i = &#123;&#125;, <span class="string">&quot;from.latitude&quot;</span>, a.<span class="property">data</span>.<span class="property">latitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;from.longitude&quot;</span>, a.<span class="property">data</span>.<span class="property">longitude</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;to.latitude&quot;</span>, e.<span class="property">data</span>.<span class="property">latitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;to.longitude&quot;</span>, e.<span class="property">data</span>.<span class="property">longitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;startType&quot;</span>, e.<span class="property">data</span>.<span class="property">startType</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;lineId&quot;</span>, e.<span class="property">data</span>.<span class="property">lineId</span>), <span class="title function_">t</span>(i, <span class="string">&quot;deviceType&quot;</span>, e.<span class="property">data</span>.<span class="property">deviceType</span>), <span class="title function_">t</span>(i, <span class="string">&quot;deviceAddress&quot;</span>, e.<span class="property">data</span>.<span class="property">deviceAddress</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;searchDiam&quot;</span>, e.<span class="property">data</span>.<span class="property">searchDiam</span>), <span class="title function_">t</span>(i, <span class="string">&quot;lineArray&quot;</span>, n), <span class="title function_">t</span>(i, <span class="string">&quot;markers&quot;</span>, o), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;schoolId&quot;</span>, e.<span class="property">data</span>.<span class="property">schoolId</span>), <span class="title function_">t</span>(i, <span class="string">&quot;runCheckStatus&quot;</span>, e.<span class="property">data</span>.<span class="property">runCheckStatus</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;uploadType&quot;</span>, e.<span class="property">data</span>.<span class="property">uploadType</span>), i)), a.<span class="title function_">direction</span>(), a.<span class="title function_">fromtoMap</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getSchoolRunLine&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getRunLineBtn</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="number">4</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span> ? <span class="variable language_">this</span>.<span class="title function_">getSchoolRunLine</span>() : <span class="variable language_">this</span>.<span class="title function_">getRunLine</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getRunLine</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>, i = &#123;&#125;;</span><br><span class="line">        i.<span class="property">openid</span> = e.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>, i.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">longitude</span>, i.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">latitude</span>, </span><br><span class="line">        i.<span class="property">extendType</span> = a.<span class="property">data</span>.<span class="property">extendType</span>, i.<span class="property">applyCount</span> = a.<span class="property">data</span>.<span class="property">applyCount</span>, wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">        &#125;), wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: e.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getRunLine&quot;</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: i,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>) wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getRunLine500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                    <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                &#125;); <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> i;</span><br><span class="line">                    <span class="number">1</span> == e.<span class="property">data</span>.<span class="property">deviceType</span> &amp;&amp; wx.<span class="title function_">openBluetoothAdapter</span>(&#123;</span><br><span class="line">                        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">                            wx.<span class="title function_">startBluetoothDevicesDiscovery</span>(&#123;</span><br><span class="line">                                <span class="attr">powerLevel</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">                                <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                                <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                                    wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                        <span class="attr">title</span>: <span class="string">&quot;开始搜寻蓝牙外围设备失败，请检查微信蓝牙权限设置&quot;</span>,</span><br><span class="line">                                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                        <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                                        <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                                <span class="attr">title</span>: <span class="string">&quot;初始化蓝牙模块失败，请检查微信蓝牙权限设置&quot;</span>,</span><br><span class="line">                                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                                <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                                <span class="attr">mask</span>: !<span class="number">0</span></span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">var</span> o = [], n = &#123;</span><br><span class="line">                        <span class="attr">id</span>: <span class="number">0</span></span><br><span class="line">                    &#125;;</span><br><span class="line">                    n.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">latitude</span>, n.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">longitude</span>, n.<span class="property">iconPath</span> = <span class="string">&quot;/images/run.png&quot;</span>, </span><br><span class="line">                    n.<span class="property">width</span> = <span class="number">25</span>, n.<span class="property">height</span> = <span class="number">25</span>, o.<span class="title function_">push</span>(n);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> d = <span class="number">0</span>; d &lt; e.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>; d++) &#123;</span><br><span class="line">                        <span class="keyword">var</span> s = &#123;&#125;;</span><br><span class="line">                        s.<span class="property">id</span> = e.<span class="property">data</span>.<span class="property">lineArray</span>[d].<span class="property">deviceId</span>, s.<span class="property">latitude</span> = e.<span class="property">data</span>.<span class="property">lineArray</span>[d].<span class="property">latitude</span>, </span><br><span class="line">                        s.<span class="property">longitude</span> = e.<span class="property">data</span>.<span class="property">lineArray</span>[d].<span class="property">longitude</span>, <span class="number">1</span> == e.<span class="property">data</span>.<span class="property">lineArray</span>[d].<span class="property">deviceStatus</span> ? s.<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span> : s.<span class="property">iconPath</span> = <span class="string">&quot;/images/21_position.png&quot;</span>, </span><br><span class="line">                        <span class="number">3</span> == e.<span class="property">data</span>.<span class="property">lineArray</span>[d].<span class="property">deviceType</span> &amp;&amp; (s.<span class="property">callout</span> = &#123;</span><br><span class="line">                            <span class="attr">content</span>: <span class="string">&quot;训练杆&quot;</span>,</span><br><span class="line">                            <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                            <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                            <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                            <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                            <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                            <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                            <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span></span><br><span class="line">                        &#125;), s.<span class="property">width</span> = <span class="number">25</span>, s.<span class="property">height</span> = <span class="number">25</span>, o.<span class="title function_">push</span>(s);</span><br><span class="line">                    &#125;</span><br><span class="line">                    wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;startdeviceId&quot;</span>, e.<span class="property">data</span>.<span class="property">lineArray</span>[<span class="number">0</span>].<span class="property">deviceId</span>),</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">11111111</span>)</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startdeviceId&quot;</span>))</span><br><span class="line">                    a.<span class="title function_">setData</span>((<span class="title function_">t</span>(i = &#123;&#125;, <span class="string">&quot;from.latitude&quot;</span>, a.<span class="property">data</span>.<span class="property">latitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;from.longitude&quot;</span>, a.<span class="property">data</span>.<span class="property">longitude</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;to.latitude&quot;</span>, e.<span class="property">data</span>.<span class="property">latitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;to.longitude&quot;</span>, e.<span class="property">data</span>.<span class="property">longitude</span>), <span class="title function_">t</span>(i, <span class="string">&quot;startType&quot;</span>, e.<span class="property">data</span>.<span class="property">startType</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;lineId&quot;</span>, e.<span class="property">data</span>.<span class="property">lineId</span>), <span class="title function_">t</span>(i, <span class="string">&quot;deviceType&quot;</span>, e.<span class="property">data</span>.<span class="property">deviceType</span>), <span class="title function_">t</span>(i, <span class="string">&quot;deviceAddress&quot;</span>, e.<span class="property">data</span>.<span class="property">deviceAddress</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;searchDiam&quot;</span>, e.<span class="property">data</span>.<span class="property">searchDiam</span>), <span class="title function_">t</span>(i, <span class="string">&quot;lineArray&quot;</span>, e.<span class="property">data</span>.<span class="property">lineArray</span>), <span class="title function_">t</span>(i, <span class="string">&quot;markers&quot;</span>, o), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;schoolId&quot;</span>, e.<span class="property">data</span>.<span class="property">schoolId</span>), <span class="title function_">t</span>(i, <span class="string">&quot;runCheckStatus&quot;</span>, e.<span class="property">data</span>.<span class="property">runCheckStatus</span>), </span><br><span class="line">                    <span class="title function_">t</span>(i, <span class="string">&quot;uploadType&quot;</span>, e.<span class="property">data</span>.<span class="property">uploadType</span>), i)), a.<span class="title function_">direction</span>(), a.<span class="title function_">fromtoMap</span>();</span><br><span class="line">                &#125; <span class="keyword">else</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(), wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getRunLine&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">direction</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">        a.<span class="title function_">direction</span>(&#123;</span><br><span class="line">            <span class="attr">mode</span>: <span class="string">&quot;walking&quot;</span>,</span><br><span class="line">            <span class="attr">from</span>: t.<span class="property">data</span>.<span class="property">from</span>,</span><br><span class="line">            <span class="attr">to</span>: t.<span class="property">data</span>.<span class="property">to</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> a = e, i = a.<span class="property">result</span>.<span class="property">routes</span>[<span class="number">0</span>].<span class="property">polyline</span>, o = [], n = <span class="number">2</span>; n &lt; i.<span class="property">length</span>; n++) i[n] = <span class="title class_">Number</span>(i[n - <span class="number">2</span>]) + <span class="title class_">Number</span>(i[n]) / <span class="number">1e6</span>;</span><br><span class="line">                <span class="keyword">for</span> (n = <span class="number">0</span>; n &lt; i.<span class="property">length</span>; n += <span class="number">2</span>) o.<span class="title function_">push</span>(&#123;</span><br><span class="line">                    <span class="attr">latitude</span>: i[n],</span><br><span class="line">                    <span class="attr">longitude</span>: i[n + <span class="number">1</span>]</span><br><span class="line">                &#125;);</span><br><span class="line">                t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">distance</span>: a.<span class="property">result</span>.<span class="property">routes</span>[<span class="number">0</span>].<span class="property">distance</span>,</span><br><span class="line">                    <span class="attr">duration</span>: a.<span class="property">result</span>.<span class="property">routes</span>[<span class="number">0</span>].<span class="property">duration</span>,</span><br><span class="line">                    <span class="attr">latitude</span>: o[<span class="number">0</span>].<span class="property">latitude</span>,</span><br><span class="line">                    <span class="attr">longitude</span>: o[<span class="number">0</span>].<span class="property">longitude</span>,</span><br><span class="line">                    <span class="attr">polyline</span>: [ &#123;</span><br><span class="line">                        <span class="attr">points</span>: o,</span><br><span class="line">                        <span class="attr">color</span>: <span class="string">&quot;#427CFF&quot;</span>,</span><br><span class="line">                        <span class="attr">width</span>: <span class="number">6</span>,</span><br><span class="line">                        <span class="attr">style</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                        <span class="attr">arrowLine</span>: !<span class="number">0</span></span><br><span class="line">                    &#125; ]</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">            <span class="attr">complete</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">openLocationAdapter</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>, e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">locationEnabled</span>: a.<span class="property">locationEnabled</span></span><br><span class="line">                &#125;), !t.<span class="property">data</span>.<span class="property">locationEnabled</span>) <span class="keyword">return</span> e.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeEvent2</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">        t.<span class="title function_">hideAlertView</span>(), <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(), <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span> || t.<span class="title function_">showAlertView</span>(), </span><br><span class="line">        wx.<span class="title function_">showTabBar</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">openBluetoothAdapter</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">isBlueOpen</span>: e.<span class="property">bluetoothEnabled</span></span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">var</span> a = t.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (!t.<span class="property">data</span>.<span class="property">isBlueOpen</span>) <span class="keyword">return</span> a.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">closeBlueEvent</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>).<span class="title function_">hideAlertView</span>(), <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">startLocationUpdate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">        wx.<span class="title function_">startLocationUpdate</span>(&#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">onLocationChange</span>(<span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                    t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">latitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">                        <span class="attr">longitude</span>: e.<span class="property">longitude</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopLocationUpdate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">offLocationChange</span>(), wx.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLoad</span>: <span class="keyword">function</span>(<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">navheight</span>: e.<span class="property">globalData</span>.<span class="property">navBarHeight</span>,</span><br><span class="line">            <span class="attr">winHeight</span>: e.<span class="property">globalData</span>.<span class="property">windowHeight</span>,</span><br><span class="line">            <span class="attr">statusBarHeight</span>: e.<span class="property">globalData</span>.<span class="property">statusBarHeight</span>,</span><br><span class="line">            <span class="attr">screenHeight</span>: e.<span class="property">globalData</span>.<span class="property">screenHeight</span>,</span><br><span class="line">            <span class="attr">runType</span>: t.<span class="property">runType</span>,</span><br><span class="line">            <span class="attr">applyCount</span>: t.<span class="property">applyCount</span>,</span><br><span class="line">            <span class="attr">suspendStatus</span>: t.<span class="property">suspendStatus</span></span><br><span class="line">        &#125;), <span class="variable language_">this</span>.<span class="title function_">getLocation</span>(), <span class="variable language_">this</span>.<span class="title function_">startLocationUpdate</span>(), <span class="variable language_">this</span>.<span class="property">endview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview2&quot;</span>), </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">mapCtx</span> = wx.<span class="title function_">createMapContext</span>(<span class="string">&quot;map&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onReady</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">onShow</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(), <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onHide</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">onUnload</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onPullDownRefresh</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">onReachBottom</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="9-修改pagas-index-paobu-js"><a href="#9-修改pagas-index-paobu-js" class="headerlink" title="9.修改pagas&#x2F;index&#x2F;paobu.js"></a>9.修改pagas&#x2F;index&#x2F;paobu.js</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> t,</span><br><span class="line">  e = <span class="built_in">require</span>(<span class="string">&quot;../../43BA1E1353E228FF25DC7614A0117075.js&quot;</span>),</span><br><span class="line">  a = <span class="built_in">require</span>(<span class="string">&quot;../../A0C5818153E228FFC6A3E986C6017075.js&quot;</span>),</span><br><span class="line">  i = <span class="built_in">require</span>(<span class="string">&quot;../../9E8EA57053E228FFF8E8CD77A2E07075.js&quot;</span>),</span><br><span class="line">  o = <span class="title function_">getApp</span>(),</span><br><span class="line">  r = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">navbarData</span>: &#123;</span><br><span class="line">      <span class="attr">showCapsule</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">fakedivceId</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="attr">fakelongti</span>:[<span class="number">112.93816433376736</span>,<span class="number">112.93817247178819</span>,<span class="number">112.93818549262153</span>,<span class="number">112.93420437282987</span>],</span><br><span class="line">    <span class="attr">fakelatitu</span>:[<span class="number">28.16078857421875</span>,<span class="number">28.16057644314236</span>,<span class="number">28.1603515625</span>,<span class="number">28.160025499131944</span>],</span><br><span class="line">    <span class="attr">fakemeil</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="attr">navheight</span>: o.<span class="property">globalData</span>.<span class="property">navBarHeight</span>,</span><br><span class="line">    <span class="attr">winHeight</span>: o.<span class="property">globalData</span>.<span class="property">windowHeight</span>,</span><br><span class="line">    <span class="attr">screenHeight</span>: o.<span class="property">globalData</span>.<span class="property">screenHeight</span>,</span><br><span class="line">    <span class="attr">latitude</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">longitude</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">seqNo</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">polyline</span>: [],</span><br><span class="line">    <span class="attr">points</span>: [],</span><br><span class="line">    <span class="attr">cal</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">speed</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">av_speed</span>: <span class="string">&quot;0&#x27;00&#x27;&#x27;&quot;</span>,</span><br><span class="line">    <span class="attr">avSpeedNum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">mins</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">seconds</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">meters</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">runmeters</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">times</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">time</span>: <span class="string">&quot;00:00:00&quot;</span>,</span><br><span class="line">    <span class="attr">bgcolor</span>: <span class="string">&quot;#ffffff&quot;</span>,</span><br><span class="line">    <span class="attr">fontcolor</span>: <span class="string">&quot;#000000&quot;</span>,</span><br><span class="line">    <span class="attr">layerstyle</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">animationData</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">showModalStatus</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">runstatus</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">isstop</span>: !<span class="number">1</span>,</span><br><span class="line">    <span class="attr">alertview</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">modelview</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">modeltopview</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">array</span>: [<span class="string">&quot;每2分钟&quot;</span>, <span class="string">&quot;每5分钟&quot;</span>, <span class="string">&quot;每10分钟&quot;</span>, <span class="string">&quot;每15分钟&quot;</span>],</span><br><span class="line">    <span class="attr">btntxt</span>: <span class="string">&quot;暂停&quot;</span>,</span><br><span class="line">    <span class="attr">runType</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">countDownNum</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">initlatitude</span>: <span class="number">39.908836</span>,</span><br><span class="line">    <span class="attr">initlongitude</span>: <span class="number">116.397463</span>,</span><br><span class="line">    <span class="attr">detailId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">aniHeigh</span>: <span class="number">1e3</span>,</span><br><span class="line">    <span class="attr">boxheight</span>: <span class="number">220</span>,</span><br><span class="line">    <span class="attr">ispenvido</span>: !<span class="number">0</span>,</span><br><span class="line">    <span class="attr">volume</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">markers</span>: [],</span><br><span class="line">    <span class="attr">endcontent</span>: <span class="string">&quot;由于跑程距离过短，结束将&quot;</span>,</span><br><span class="line">    <span class="attr">endcontent1</span>: <span class="string">&quot;不保存&quot;</span>,</span><br><span class="line">    <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。 您确定要结束吗？&quot;</span>,</span><br><span class="line">    <span class="attr">minTime</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">maxTime</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">mileageTarget</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">maxSpaceTime</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">polylines</span>: [],</span><br><span class="line">    <span class="attr">voiceSwitch</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">voiceCount</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">voiceMinute</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">voiceSecond</span>: <span class="number">300</span>,</span><br><span class="line">    <span class="attr">screenSwitch</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">isbackground</span>: !<span class="number">1</span>,</span><br><span class="line">    <span class="attr">voiceNumber</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">updatatime</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">isdaojishi</span>: !<span class="number">0</span>,</span><br><span class="line">    <span class="attr">lastDkDeviceid</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">lineArray</span>: [],</span><br><span class="line">    <span class="attr">stopArray</span>: [],</span><br><span class="line">    <span class="attr">lineId</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">offyesqy</span>: !<span class="number">0</span>,</span><br><span class="line">    <span class="attr">openPageNum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">searchDiam</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">uploadDetailNum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">uploadType</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">runCheckStatus</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">batchNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">fileName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">filePath</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">getLocationerr</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">continueCount</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">positionCount</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">fileId</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">deviceType</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">startRunDate</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">punchCardSum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">punchCardNum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">startType</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">punchCardArray</span>: [],</span><br><span class="line">    <span class="attr">runBitmap</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">remarks</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">timeoutArray</span>: [],</span><br><span class="line">    <span class="attr">timerunArray</span>: [],</span><br><span class="line">    <span class="attr">timestopArray</span>: [],</span><br><span class="line">    <span class="attr">timestopsum</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">suspendStatus</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">suspendCardArray</span>: [],</span><br><span class="line">    <span class="attr">random</span>:<span class="number">30</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">count_down</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> a =</span><br><span class="line">          (<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) - t.<span class="property">data</span>.<span class="property">startRunDate</span> - t.<span class="property">data</span>.<span class="property">timestopsum</span>) /</span><br><span class="line">          <span class="number">1e3</span>,</span><br><span class="line">        i = e.<span class="title function_">date_format</span>(a);</span><br><span class="line">        <span class="keyword">var</span> o = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(a / t.<span class="property">data</span>.<span class="property">fakemeil</span>), n = <span class="title class_">Math</span>.<span class="title function_">floor</span>(o / <span class="number">60</span>), d = o % <span class="number">60</span>;</span><br><span class="line">        t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">times</span>: a,</span><br><span class="line">          <span class="attr">time</span>: i,</span><br><span class="line">          <span class="attr">mins</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">fakemeil</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(a/<span class="number">48</span>*<span class="number">25</span> - t.<span class="property">data</span>.<span class="property">random</span>)/<span class="number">100</span>,</span><br><span class="line">          <span class="attr">seconds</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">av_speed</span>: n + <span class="string">&quot;&#x27;&quot;</span> + d + <span class="string">&quot;&#x27;&#x27;&quot;</span>,</span><br><span class="line">          <span class="attr">avSpeedNum</span>: n + d / <span class="number">100</span></span><br><span class="line">        &#125;);</span><br><span class="line">      a % <span class="number">5</span> == <span class="number">0</span> &amp;&amp; t.<span class="title function_">openLocationAdapter</span>(),</span><br><span class="line">        (r = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          t.<span class="title function_">count_down</span>(t);</span><br><span class="line">        &#125;, <span class="number">1e3</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">openBluetoothAdapter</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">    wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">isBlueOpen</span>: e.<span class="property">bluetoothEnabled</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> a = t.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!t.<span class="property">data</span>.<span class="property">isBlueOpen</span>) <span class="keyword">return</span> a.<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">ab2hext</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span></span><br><span class="line">      .<span class="title function_">call</span>(<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(t), <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;00&quot;</span> + t.<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">slice</span>(-<span class="number">2</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">startLocationUpdateBackground</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    wx.<span class="title function_">startLocationUpdate</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    wx.<span class="title function_">startLocationUpdateBackground</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onLocationChange</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>;</span><br><span class="line">    wx.<span class="title function_">onLocationChange</span>(<span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">1</span> == a.<span class="property">data</span>.<span class="property">runstatus</span>) &#123;</span><br><span class="line">        e.<span class="title function_">playYuying</span>(<span class="string">&quot;/images/goingrun.mp3&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> o = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        (t.<span class="property">lastlatitude</span> = i.<span class="property">latitude</span>),</span><br><span class="line">          (t.<span class="property">lastlongitude</span> = i.<span class="property">longitude</span>),</span><br><span class="line">          (t.<span class="property">yeslastlatitude</span> = i.<span class="property">latitude</span>),</span><br><span class="line">          (t.<span class="property">yeslastlongitude</span> = i.<span class="property">longitude</span>),</span><br><span class="line">          (t.<span class="property">yeslasttime</span> = o),</span><br><span class="line">          t.<span class="title function_">startRun</span>(i.<span class="property">longitude</span>, i.<span class="property">latitude</span>),</span><br><span class="line">          a.<span class="property">data</span>.<span class="property">timerunArray</span>.<span class="title function_">push</span>(o);</span><br><span class="line">        <span class="keyword">var</span> r = a.<span class="property">data</span>.<span class="property">timerunArray</span>.<span class="property">length</span> - <span class="number">1</span>,</span><br><span class="line">          d = a.<span class="property">data</span>.<span class="property">timerunArray</span>[r] - a.<span class="property">data</span>.<span class="property">timeoutArray</span>[r];</span><br><span class="line">        a.<span class="property">data</span>.<span class="property">timestopArray</span>.<span class="title function_">push</span>(d),</span><br><span class="line">          a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">runstatus</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">latitude</span>: i.<span class="property">latitude</span>,</span><br><span class="line">            <span class="attr">longitude</span>: i.<span class="property">longitude</span>,</span><br><span class="line">            <span class="attr">timestopsum</span>: a.<span class="property">data</span>.<span class="property">timestopsum</span> + d,</span><br><span class="line">          &#125;),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>, a.<span class="property">data</span>.<span class="property">timerunArray</span>),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>, a.<span class="property">data</span>.<span class="property">timestopsum</span>),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>, <span class="number">0</span>),</span><br><span class="line">          a.<span class="title function_">count_down</span>(a),</span><br><span class="line">          a.<span class="title function_">recoveryRun</span>(i.<span class="property">longitude</span>, i.<span class="property">latitude</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        t.<span class="title function_">saveData</span>(i);</span><br><span class="line">        <span class="keyword">var</span> s = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> * t.<span class="property">runmeters</span>) / <span class="number">100</span>,</span><br><span class="line">          u = a.<span class="property">data</span>.<span class="property">punchCardArray</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">2</span> == a.<span class="property">data</span>.<span class="property">runType</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">4</span> == a.<span class="property">data</span>.<span class="property">runType</span>) &#123;</span><br><span class="line">          <span class="number">0</span> !=</span><br><span class="line">            (c = e.<span class="title function_">getDistanceMark</span>(</span><br><span class="line">              u,</span><br><span class="line">              i.<span class="property">latitude</span>,</span><br><span class="line">              i.<span class="property">longitude</span>,</span><br><span class="line">              a.<span class="property">data</span>.<span class="property">searchDiam</span></span><br><span class="line">            )) &amp;&amp;</span><br><span class="line">            <span class="number">1</span> != c &amp;&amp;</span><br><span class="line">            c != a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span> &amp;&amp;</span><br><span class="line">            a.<span class="title function_">schoolRunPunchCard</span>(c);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> c;</span><br><span class="line">          <span class="number">0</span> !=</span><br><span class="line">            (c = e.<span class="title function_">getDistanceMark</span>(</span><br><span class="line">              u,</span><br><span class="line">              i.<span class="property">latitude</span>,</span><br><span class="line">              i.<span class="property">longitude</span>,</span><br><span class="line">              a.<span class="property">data</span>.<span class="property">searchDiam</span></span><br><span class="line">            )) &amp;&amp;</span><br><span class="line">            <span class="number">1</span> != c &amp;&amp;</span><br><span class="line">            c != a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span> &amp;&amp;</span><br><span class="line">            a.<span class="title function_">runPunchCard</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">voiceSwitch</span> &amp;&amp;</span><br><span class="line">          <span class="title class_">Math</span>.<span class="title function_">floor</span>(a.<span class="property">data</span>.<span class="property">times</span> / a.<span class="property">data</span>.<span class="property">voiceSecond</span>) == a.<span class="property">data</span>.<span class="property">voiceNumber</span> </span><br><span class="line">        <span class="keyword">var</span> l = e.<span class="title function_">getKal</span>(s),</span><br><span class="line">          h = a.<span class="property">data</span>.<span class="property">markers</span>;</span><br><span class="line">        ((S = &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;).<span class="property">latitude</span> = t.<span class="property">latitude</span>),</span><br><span class="line">          (S.<span class="property">longitude</span> = t.<span class="property">longitude</span>),</span><br><span class="line">          (S.<span class="property">iconPath</span> = <span class="string">&quot;/images/run.png&quot;</span>),</span><br><span class="line">          (S.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">          (S.<span class="property">height</span> = <span class="number">25</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>, g = <span class="number">0</span>; g &lt; h.<span class="property">length</span>; g++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="number">0</span> == h[g].<span class="property">id</span>) &#123;</span><br><span class="line">            h[g] = S;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          p++;</span><br><span class="line">        &#125;</span><br><span class="line">        h.<span class="property">length</span> == p &amp;&amp; h.<span class="title function_">push</span>(S);</span><br><span class="line">        <span class="keyword">var</span> w = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (w[<span class="number">0</span>]) &#123;</span><br><span class="line">          <span class="keyword">var</span> m = w[<span class="number">0</span>].<span class="property">points</span>[<span class="number">0</span>];</span><br><span class="line">          ((S = &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          &#125;).<span class="property">latitude</span> = m.<span class="property">latitude</span>),</span><br><span class="line">            (S.<span class="property">longitude</span> = m.<span class="property">longitude</span>),</span><br><span class="line">            (S.<span class="property">iconPath</span> = <span class="string">&quot;/images/qid.png&quot;</span>),</span><br><span class="line">            (S.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">            (S.<span class="property">height</span> = <span class="number">25</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> S;</span><br><span class="line">          ((S = &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          &#125;).<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">initlatitude</span>),</span><br><span class="line">            (S.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">initlongitude</span>),</span><br><span class="line">            (S.<span class="property">iconPath</span> = <span class="string">&quot;/images/qid.png&quot;</span>),</span><br><span class="line">            (S.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">            (S.<span class="property">height</span> = <span class="number">25</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (g = <span class="number">0</span>; g &lt; h.<span class="property">length</span>; g++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="number">1</span> == h[g].<span class="property">id</span>) &#123;</span><br><span class="line">            h[g] = S;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          y++;</span><br><span class="line">        &#125;</span><br><span class="line">        h.<span class="property">length</span> == y &amp;&amp; h.<span class="title function_">push</span>(S),</span><br><span class="line">          a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">polylines</span>: t.<span class="title function_">getPolyline</span>(),</span><br><span class="line">            <span class="attr">longitude</span>: t.<span class="property">longitude</span>,</span><br><span class="line">            <span class="attr">latitude</span>: t.<span class="property">latitude</span>,</span><br><span class="line">            <span class="attr">markers</span>: h,</span><br><span class="line">            <span class="attr">runmeters</span>: s,</span><br><span class="line">            <span class="attr">cal</span>: l,</span><br><span class="line">            <span class="attr">seqNo</span>: t.<span class="property">seqNo</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">          a.<span class="property">data</span>.<span class="property">offyesqy</span> &amp;&amp; a.<span class="title function_">fromtoMap</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">offyesQuyu</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// this.setData(&#123;</span></span><br><span class="line">    <span class="comment">//   offyesqy: !this.data.offyesqy,</span></span><br><span class="line">    <span class="comment">// &#125;);</span></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>&lt;<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">punchCardSum</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;模拟打卡&quot;</span>)</span><br><span class="line">     <span class="keyword">var</span> deviceid = <span class="title class_">Number</span>(wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startdeviceId&quot;</span>))</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(deviceid + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">runPunchCard2</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>+deviceid,<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakelongti</span>[<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>],<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakelatitu</span>[<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>])</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      fakedivceId : <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>+<span class="number">1</span>,</span><br><span class="line">      punchCardNum : <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">punchCardNum</span> + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">   &#125; </span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakedivceId</span>,<span class="string">&quot;已完成打卡&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">fromtoMap</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    (<span class="variable language_">this</span>.<span class="property">mapCtx</span> = wx.<span class="title function_">createMapContext</span>(<span class="string">&quot;myMap&quot;</span>)),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">mapCtx</span>.<span class="title function_">includePoints</span>(&#123;</span><br><span class="line">        <span class="attr">padding</span>: [<span class="number">120</span>, <span class="number">50</span>, <span class="number">80</span>, <span class="number">50</span>],</span><br><span class="line">        <span class="attr">points</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">markers</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">startLocationUpdate</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    wx.<span class="title function_">startLocationUpdate</span>(&#123;</span><br><span class="line">      <span class="attr">complete</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">stopLocationUpdate</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    wx.<span class="title function_">offLocationChange</span>(),</span><br><span class="line">      wx.<span class="title function_">stopLocationUpdate</span>(&#123;</span><br><span class="line">        <span class="attr">complete</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">endRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fileId</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">writeFile</span>(),</span><br><span class="line">      <span class="number">4</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span> ? <span class="variable language_">this</span>.<span class="title function_">apiStopSchoolRun</span>() : <span class="variable language_">this</span>.<span class="title function_">apiStopRun</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">apiStopSchoolRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;进入apiStopSchoolRun&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">apiStopRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>;</span><br><span class="line">    a.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">    <span class="keyword">var</span> n = &#123;&#125;,</span><br><span class="line">      d = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    (n.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (n.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (n.<span class="property">longitude</span> = <span class="string">&quot;&quot;</span>),</span><br><span class="line">      (n.<span class="property">latitude</span> = <span class="string">&quot;&quot;</span>),</span><br><span class="line">      (n.<span class="property">runType</span> = a.<span class="property">data</span>.<span class="property">runType</span>),</span><br><span class="line">      (n.<span class="property">endTime</span> = d / <span class="number">1e3</span>),</span><br><span class="line">      (n.<span class="property">mileage</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakemeil</span>);</span><br><span class="line">    <span class="comment">// n.mileage = Math.ceil(100 * t.runmeters) / 100;</span></span><br><span class="line">    <span class="keyword">var</span> s = e.<span class="title function_">sortKey</span>(n, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (n.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(s)),</span><br><span class="line">      (n.<span class="property">extentStatus</span> = <span class="number">1</span>),</span><br><span class="line">      (n.<span class="property">continueCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>)</span><br><span class="line">        ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>)</span><br><span class="line">        : <span class="number">0</span>),</span><br><span class="line">      (n.<span class="property">positionCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>)</span><br><span class="line">        ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>)</span><br><span class="line">        : <span class="number">0</span>),</span><br><span class="line">      (n.<span class="property">seqNo</span> = a.<span class="property">data</span>.<span class="property">seqNo</span>),</span><br><span class="line">      (n.<span class="property">remarks</span> = a.<span class="property">data</span>.<span class="property">remarks</span>);</span><br><span class="line">    <span class="keyword">var</span> u = a.<span class="property">data</span>.<span class="property">timeoutArray</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">if</span> (u == a.<span class="property">data</span>.<span class="property">timerunArray</span>.<span class="property">length</span>)</span><br><span class="line">      n.<span class="property">suspendTime</span> = a.<span class="property">data</span>.<span class="property">timestopsum</span> / <span class="number">1e3</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> c = d - a.<span class="property">data</span>.<span class="property">timeoutArray</span>[u - <span class="number">1</span>];</span><br><span class="line">      n.<span class="property">suspendTime</span> = (a.<span class="property">data</span>.<span class="property">timestopsum</span> + c) / <span class="number">1e3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    (n.<span class="property">suspendCount</span> = u),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/stopRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: n,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != e.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>:</span><br><span class="line">                    <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。服务器异常stopRun2&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">              ? ((o.<span class="property">globalData</span>.<span class="property">getPersonaldata</span> = <span class="number">0</span>),</span><br><span class="line">                (o.<span class="property">globalData</span>.<span class="property">getHome</span> = <span class="number">0</span>),</span><br><span class="line">                <span class="built_in">clearTimeout</span>(r),</span><br><span class="line">                t.<span class="title function_">clearRunCacheData</span>(),</span><br><span class="line">                a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">time</span>: <span class="string">&quot;00:00:00&quot;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">                wx.<span class="title function_">switchTab</span>(&#123;</span><br><span class="line">                  <span class="attr">url</span>: <span class="string">&quot;/pages/index/index&quot;</span>,</span><br><span class="line">                &#125;))</span><br><span class="line">              : <span class="string">&quot;000015&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>:</span><br><span class="line">                    <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopRun2&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>:</span><br><span class="line">                <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopRun2&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">              <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">writeFile</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>,</span><br><span class="line">      n = wx.<span class="title function_">getFileSystemManager</span>();</span><br><span class="line">    n.<span class="title function_">access</span>(&#123;</span><br><span class="line">      <span class="attr">path</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + a.<span class="property">data</span>.<span class="property">detailId</span> + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">          <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">var</span> r = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>(),</span><br><span class="line">          d = &#123;&#125;;</span><br><span class="line">        (d.<span class="property">openid</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>)),</span><br><span class="line">          (d.<span class="property">fileType</span> = <span class="number">2</span>),</span><br><span class="line">          (d.<span class="property">imageType</span> = <span class="number">1</span>),</span><br><span class="line">          (d.<span class="property">batchNo</span> = r);</span><br><span class="line">        <span class="keyword">var</span> s = e.<span class="title function_">sortKey</span>(d, o.<span class="property">globalData</span>.<span class="property">datakey</span>),</span><br><span class="line">          u = i.<span class="title function_">hexMD5</span>(s);</span><br><span class="line">        wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">          <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">          <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + a.<span class="property">data</span>.<span class="property">detailId</span> + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">          <span class="attr">header</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">formData</span>: &#123;</span><br><span class="line">            <span class="attr">openid</span>: wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>),</span><br><span class="line">            <span class="attr">fileType</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">imageType</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">batchNo</span>: r,</span><br><span class="line">            <span class="attr">sign</span>: u,</span><br><span class="line">            <span class="attr">detailId</span>: a.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">            <span class="attr">uploadImagetype</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">              <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">                ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;)</span><br><span class="line">                : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">                ? ((a.<span class="property">data</span>.<span class="property">fileId</span> = t.<span class="property">data</span>.<span class="property">fileId</span>),</span><br><span class="line">                  n.<span class="title function_">unlink</span>(&#123;</span><br><span class="line">                    <span class="attr">filePath</span>:</span><br><span class="line">                      wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + a.<span class="property">data</span>.<span class="property">detailId</span> + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                  &#125;))</span><br><span class="line">                : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常uploadFile&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">r</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> d = t.<span class="property">runpoints</span>.<span class="title function_">join</span>(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        n.<span class="title function_">writeFile</span>(&#123;</span><br><span class="line">          <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + a.<span class="property">data</span>.<span class="property">detailId</span> + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">          <span class="attr">data</span>: d,</span><br><span class="line">          <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">          <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">            wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">              <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">var</span> r = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">valueOf</span>(),</span><br><span class="line">              d = &#123;&#125;;</span><br><span class="line">            (d.<span class="property">openid</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>)),</span><br><span class="line">              (d.<span class="property">fileType</span> = <span class="number">2</span>),</span><br><span class="line">              (d.<span class="property">imageType</span> = <span class="number">1</span>),</span><br><span class="line">              (d.<span class="property">batchNo</span> = r);</span><br><span class="line">            <span class="keyword">var</span> s = e.<span class="title function_">sortKey</span>(d, o.<span class="property">globalData</span>.<span class="property">datakey</span>),</span><br><span class="line">              u = i.<span class="title function_">hexMD5</span>(s);</span><br><span class="line">            wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">              <span class="attr">filePath</span>: wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> + <span class="string">&quot;/&quot;</span> + a.<span class="property">data</span>.<span class="property">detailId</span> + <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">              <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">formData</span>: &#123;</span><br><span class="line">                <span class="attr">openid</span>: wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;openid&quot;</span>),</span><br><span class="line">                <span class="attr">fileType</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="attr">imageType</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">schoolId</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="attr">batchNo</span>: r,</span><br><span class="line">                <span class="attr">sign</span>: u,</span><br><span class="line">                <span class="attr">detailId</span>: a.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">                <span class="attr">uploadImagetype</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">                  <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">                    ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                      &#125;)</span><br><span class="line">                    : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">                    ? ((a.<span class="property">data</span>.<span class="property">fileId</span> = t.<span class="property">data</span>.<span class="property">fileId</span>),</span><br><span class="line">                      n.<span class="title function_">unlink</span>(&#123;</span><br><span class="line">                        <span class="attr">filePath</span>:</span><br><span class="line">                          wx.<span class="property">env</span>.<span class="property">USER_DATA_PATH</span> +</span><br><span class="line">                          <span class="string">&quot;/&quot;</span> +</span><br><span class="line">                          a.<span class="property">data</span>.<span class="property">detailId</span> +</span><br><span class="line">                          <span class="string">&quot;.txt&quot;</span>,</span><br><span class="line">                        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">                      &#125;))</span><br><span class="line">                    : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                      &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">                  wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常uploadFile&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;&#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">backmusic</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">isbackground</span>) <span class="keyword">return</span> !<span class="number">1</span>;</span><br><span class="line">    !(<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>) &#123;</span><br><span class="line">      (backgroundAudioManager.<span class="property">src</span> = <span class="string">&quot;/images/test.mp3&quot;</span>),</span><br><span class="line">        (backgroundAudioManager.<span class="property">title</span> = <span class="string">&quot;&quot;</span>),</span><br><span class="line">        backgroundAudioManager.<span class="title function_">onEnded</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">t</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getLocation</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">    wx.<span class="title function_">getLocation</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;gcj02&quot;</span>,</span><br><span class="line">      <span class="attr">isHighAccuracy</span>: !<span class="number">0</span>,</span><br><span class="line">      <span class="attr">highAccuracyExpireTime</span>: <span class="number">3e3</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">initlatitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">          <span class="attr">initlongitude</span>: e.<span class="property">longitude</span>,</span><br><span class="line">          <span class="attr">latitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">          <span class="attr">longitude</span>: e.<span class="property">longitude</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">      <span class="attr">complete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onLoad</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">random</span>: <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">40</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      (<span class="variable language_">this</span>.<span class="title function_">runSet</span>(),</span><br><span class="line">      <span class="literal">null</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) &amp;&amp;</span><br><span class="line">        <span class="string">&quot;&quot;</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>))</span><br><span class="line">    )</span><br><span class="line">      <span class="keyword">var</span> o = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;polylinecache&quot;</span>)</span><br><span class="line">          : [&#123;&#125;],</span><br><span class="line">        n = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileage&quot;</span>) : <span class="number">0</span>,</span><br><span class="line">        r = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;pointscache&quot;</span>)</span><br><span class="line">          : [],</span><br><span class="line">        d = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        s = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runpoints&quot;</span>)</span><br><span class="line">          : [],</span><br><span class="line">        u = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;seqNo&quot;</span>) : <span class="number">0</span>,</span><br><span class="line">        c = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;stoppoint&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;stoppoint&quot;</span>)</span><br><span class="line">          : &#123;&#125;;</span><br><span class="line">    <span class="keyword">else</span> (o = [&#123;&#125;]), (n = <span class="number">0</span>), (r = []), (d = <span class="string">&quot;&quot;</span>), (s = []), (u = <span class="number">0</span>), (c = &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      ((t = <span class="keyword">new</span> <span class="title function_">a</span>(&#123;</span><br><span class="line">        <span class="attr">latitude</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">latitude</span>,</span><br><span class="line">        <span class="attr">longitude</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">longitude</span>,</span><br><span class="line">        <span class="attr">polyline</span>: o,</span><br><span class="line">        <span class="attr">runmeters</span>: n,</span><br><span class="line">        <span class="attr">points</span>: r,</span><br><span class="line">        <span class="attr">detailId</span>: d,</span><br><span class="line">        <span class="attr">runpoints</span>: s,</span><br><span class="line">        <span class="attr">seqNo</span>: u,</span><br><span class="line">        <span class="attr">stoppoint</span>: c,</span><br><span class="line">      &#125;)),</span><br><span class="line">      <span class="literal">null</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>) &amp;&amp;</span><br><span class="line">        <span class="string">&quot;&quot;</span> != wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>))</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">var</span> l = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>),</span><br><span class="line">        h = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>),</span><br><span class="line">        p = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>),</span><br><span class="line">        g = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>),</span><br><span class="line">        w = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>),</span><br><span class="line">        m = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>),</span><br><span class="line">        S = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>),</span><br><span class="line">        y = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>),</span><br><span class="line">        x = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>),</span><br><span class="line">        f = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;minTime&quot;</span>),</span><br><span class="line">        T = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>),</span><br><span class="line">        v = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>),</span><br><span class="line">        D = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>),</span><br><span class="line">        C = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>),</span><br><span class="line">        A = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;filePath&quot;</span>) ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;filePath&quot;</span>) : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        k = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>)</span><br><span class="line">          : <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()),</span><br><span class="line">        b = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;startType&quot;</span>),</span><br><span class="line">        I = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>),</span><br><span class="line">        N = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>)</span><br><span class="line">          : [],</span><br><span class="line">        L = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timerunArray&quot;</span>)</span><br><span class="line">          : [],</span><br><span class="line">        P = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>)</span><br><span class="line">          ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;timestopsum&quot;</span>)</span><br><span class="line">          : <span class="number">0</span>,</span><br><span class="line">        R = N.<span class="property">length</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">0</span> == R)</span><br><span class="line">        <span class="keyword">var</span> M = (<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) - k) / <span class="number">1e3</span>,</span><br><span class="line">          q = e.<span class="title function_">date_format</span>(M);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (R == L.<span class="property">length</span>)</span><br><span class="line">        (M = (<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) - k - P) / <span class="number">1e3</span>), (q = e.<span class="title function_">date_format</span>(M));</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> _ = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        (M = (_ - k - P - (_ - N[R - <span class="number">1</span>])) / <span class="number">1e3</span>), (q = e.<span class="title function_">date_format</span>(M));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> F = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> * t.<span class="property">runmeters</span>) / <span class="number">100</span>,</span><br><span class="line">        B = e.<span class="title function_">getKal</span>(F),</span><br><span class="line">        V = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(M / F),</span><br><span class="line">        U = <span class="title class_">Math</span>.<span class="title function_">floor</span>(V / <span class="number">60</span>),</span><br><span class="line">        H = V % <span class="number">60</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">polylines</span>: t.<span class="property">polyline</span>,</span><br><span class="line">        <span class="attr">lastDkDeviceid</span>: x,</span><br><span class="line">        <span class="attr">isdaojishi</span>: !<span class="number">1</span>,</span><br><span class="line">        <span class="attr">detailId</span>: t.<span class="property">detailId</span>,</span><br><span class="line">        <span class="attr">runmeters</span>: F,</span><br><span class="line">        <span class="attr">cal</span>: B,</span><br><span class="line">        <span class="attr">av_speed</span>: U + <span class="string">&quot;&#x27;&quot;</span> + H + <span class="string">&quot;&#x27;&#x27;&quot;</span>,</span><br><span class="line">        <span class="attr">avSpeedNum</span>: U + H / <span class="number">100</span>,</span><br><span class="line">        <span class="attr">runType</span>: i.<span class="property">runType</span>,</span><br><span class="line">        <span class="attr">openPageNum</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">openPageNum</span> + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">schoolId</span>: l,</span><br><span class="line">        <span class="attr">uploadDetailNum</span>: h,</span><br><span class="line">        <span class="attr">uploadType</span>: p,</span><br><span class="line">        <span class="attr">runCheckStatus</span>: g,</span><br><span class="line">        <span class="attr">initlatitude</span>: w,</span><br><span class="line">        <span class="attr">initlongitude</span>: m,</span><br><span class="line">        <span class="attr">continueCount</span>: S + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">positionCount</span>: y,</span><br><span class="line">        <span class="attr">minTime</span>: f,</span><br><span class="line">        <span class="attr">maxTime</span>: T,</span><br><span class="line">        <span class="attr">mileageTarget</span>: v,</span><br><span class="line">        <span class="attr">maxSpaceTime</span>: D,</span><br><span class="line">        <span class="attr">deviceType</span>: C,</span><br><span class="line">        <span class="attr">filePath</span>: A,</span><br><span class="line">        <span class="attr">startRunDate</span>: k,</span><br><span class="line">        <span class="attr">startType</span>: b,</span><br><span class="line">        <span class="attr">runstatus</span>: I,</span><br><span class="line">        <span class="attr">timeoutArray</span>: N,</span><br><span class="line">        <span class="attr">timerunArray</span>: L,</span><br><span class="line">        <span class="attr">timestopsum</span>: P,</span><br><span class="line">        <span class="attr">times</span>: M,</span><br><span class="line">        <span class="attr">time</span>: q,</span><br><span class="line">        <span class="attr">suspendStatus</span>: i.<span class="property">suspendStatus</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>, <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">continueCount</span>),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">startLocationUpdateBackground</span>(),</span><br><span class="line">        <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runstatus</span> &amp;&amp;</span><br><span class="line">          (<span class="variable language_">this</span>.<span class="title function_">onLocationChange</span>(), <span class="variable language_">this</span>.<span class="title function_">count_down</span>(<span class="variable language_">this</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">runType</span>: i.<span class="property">runType</span>,</span><br><span class="line">        <span class="attr">lineId</span>: i.<span class="property">lineId</span>,</span><br><span class="line">        <span class="attr">batchNo</span>: i.<span class="property">batchNo</span>,</span><br><span class="line">        <span class="attr">openPageNum</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">openPageNum</span> + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">startType</span>: i.<span class="property">startType</span>,</span><br><span class="line">        <span class="attr">suspendStatus</span>: i.<span class="property">suspendStatus</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">        (t.<span class="property">runType</span> = i.<span class="property">runType</span>),</span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runType&quot;</span>, i.<span class="property">runType</span>),</span><br><span class="line">        wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;startType&quot;</span>, i.<span class="property">startType</span>),</span><br><span class="line">        (<span class="variable language_">this</span>.<span class="property">daojishi</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#daojishi&quot;</span>)),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">daojishi</span>.<span class="title function_">countDown</span>(<span class="variable language_">this</span>),</span><br><span class="line">        e.<span class="title function_">playYuying</span>(<span class="string">&quot;/images/321run.mp3&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">endRunShowBox</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endalertview&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fakemeil</span> &lt; <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">mileageTarget</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">endcontent</span>:</span><br><span class="line">          <span class="string">&quot;由于低于目标里程&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">mileageTarget</span> + <span class="string">&quot;公里，结束将&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。您确定要结束吗？&quot;</span>,</span><br><span class="line">        <span class="attr">remarks</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">punchCardNum</span> &lt; <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">punchCardSum</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">endcontent</span>:</span><br><span class="line">          <span class="string">&quot;由于低于指定打卡点&quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">punchCardSum</span> + <span class="string">&quot;个，结束将&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。您确定要结束吗？&quot;</span>,</span><br><span class="line">        <span class="attr">remarks</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">avSpeedNum</span> &lt; <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">minTime</span> ||</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">avSpeedNum</span> &gt; <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">maxTime</span></span><br><span class="line">    )</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">endcontent</span>: <span class="string">&quot;由于配速超过规定范围，结束将&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent1</span>: <span class="string">&quot;无效&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent2</span>: <span class="string">&quot;此次记录。您确定要结束吗？&quot;</span>,</span><br><span class="line">        <span class="attr">remarks</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">filePath</span> &amp;&amp; <span class="number">1</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runCheckStatus</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;请上传人脸照片&quot;</span>,</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">2</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">startType</span> || <span class="number">3</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">startType</span>)</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          <span class="number">0</span> ==</span><br><span class="line">          e.<span class="title function_">getEndDistanceMark</span>(</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">stopArray</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">latitude</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">longitude</span>,</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">searchDiam</span></span><br><span class="line">          )</span><br><span class="line">        )</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">void</span> wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;请前往打卡点结束或点击右下强制结束&quot;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">endcontent</span>: <span class="string">&quot;您本次跑程距离为&quot;</span>,</span><br><span class="line">        <span class="attr">endcontent1</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">meters</span>,</span><br><span class="line">        <span class="attr">endcontent2</span>: <span class="string">&quot;km，您确定要结束吗？&quot;</span>,</span><br><span class="line">        <span class="attr">remarks</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endalertview</span>.<span class="title function_">showAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">stopNoRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    (<span class="variable language_">this</span>.<span class="property">endnoalertview</span> = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#endnoalertview&quot;</span>)),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">endnoalertview</span>.<span class="title function_">showAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">cancelNoEvent</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endnoalertview</span>.<span class="title function_">hideAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">endNoRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="number">0</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">fileId</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">writeFile</span>(),</span><br><span class="line">      <span class="number">4</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span> ? <span class="variable language_">this</span>.<span class="title function_">apiStopRun</span>() : <span class="variable language_">this</span>.<span class="title function_">finishendNoRun</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">finishendNoRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>;</span><br><span class="line">    a.<span class="title function_">stopLocationUpdate</span>();</span><br><span class="line">    <span class="keyword">var</span> n = &#123;&#125;,</span><br><span class="line">      d = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    (n.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (n.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (n.<span class="property">longitude</span> = <span class="string">&quot;&quot;</span>),</span><br><span class="line">      (n.<span class="property">latitude</span> = <span class="string">&quot;&quot;</span>),</span><br><span class="line">      (n.<span class="property">runType</span> = a.<span class="property">data</span>.<span class="property">runType</span>),</span><br><span class="line">      (n.<span class="property">endTime</span> = d / <span class="number">1e3</span>),</span><br><span class="line">      (n.<span class="property">mileage</span> = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="number">100</span> * t.<span class="property">runmeters</span>) / <span class="number">100</span>);</span><br><span class="line">    <span class="keyword">var</span> s = e.<span class="title function_">sortKey</span>(n, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (n.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(s)),</span><br><span class="line">      (n.<span class="property">extentStatus</span> = <span class="number">0</span>),</span><br><span class="line">      (n.<span class="property">continueCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>)</span><br><span class="line">        ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>)</span><br><span class="line">        : <span class="number">0</span>),</span><br><span class="line">      (n.<span class="property">positionCount</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>)</span><br><span class="line">        ? wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>)</span><br><span class="line">        : <span class="number">0</span>),</span><br><span class="line">      (n.<span class="property">seqNo</span> = a.<span class="property">data</span>.<span class="property">seqNo</span>),</span><br><span class="line">      (n.<span class="property">remarks</span> = a.<span class="property">data</span>.<span class="property">remarks</span>);</span><br><span class="line">    <span class="keyword">var</span> u = a.<span class="property">data</span>.<span class="property">timeoutArray</span>.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">if</span> (u == a.<span class="property">data</span>.<span class="property">timerunArray</span>.<span class="property">length</span>)</span><br><span class="line">      n.<span class="property">suspendTime</span> = a.<span class="property">data</span>.<span class="property">timestopsum</span> / <span class="number">1e3</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> c = d - a.<span class="property">data</span>.<span class="property">timeoutArray</span>[u - <span class="number">1</span>];</span><br><span class="line">      n.<span class="property">suspendTime</span> = (a.<span class="property">data</span>.<span class="property">timestopsum</span> + c) / <span class="number">1e3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    (n.<span class="property">suspendCount</span> = u),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/stopRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: n,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != e.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>:</span><br><span class="line">                    <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。服务器异常stopRun&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">              ? ((o.<span class="property">globalData</span>.<span class="property">getPersonaldata</span> = <span class="number">0</span>),</span><br><span class="line">                (o.<span class="property">globalData</span>.<span class="property">getHome</span> = <span class="number">0</span>),</span><br><span class="line">                <span class="built_in">clearTimeout</span>(r),</span><br><span class="line">                t.<span class="title function_">clearRunCacheData</span>(),</span><br><span class="line">                a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">time</span>: <span class="string">&quot;00:00:00&quot;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">                wx.<span class="title function_">switchTab</span>(&#123;</span><br><span class="line">                  <span class="attr">url</span>: <span class="string">&quot;/pages/index/index&quot;</span>,</span><br><span class="line">                &#125;))</span><br><span class="line">              : <span class="string">&quot;000015&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>:</span><br><span class="line">                    <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopRun&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>:</span><br><span class="line">                <span class="string">&quot;距离够截图后~联系客服页面~认真阅读文字描述。网络或服务器异常stopRun&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">              <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onReady</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="attr">getRuntime</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>,</span><br><span class="line">      e = &#123;&#125;;</span><br><span class="line">    (e.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (e.<span class="property">detailId</span> = t.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (e.<span class="property">openPageNum</span> = t.<span class="property">data</span>.<span class="property">openPageNum</span>),</span><br><span class="line">      <span class="number">0</span> != t.<span class="property">data</span>.<span class="property">detailId</span> &amp;&amp;</span><br><span class="line">        wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">          <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getRunTime&quot;</span>,</span><br><span class="line">          <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">          <span class="attr">data</span>: e,</span><br><span class="line">          <span class="attr">header</span>: &#123;</span><br><span class="line">            <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">              <span class="number">200</span> != e.<span class="property">statusCode</span></span><br><span class="line">                ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getRunTime500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;)</span><br><span class="line">                : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">                ? (<span class="number">0</span> == e.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">                    ? t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">screenSwitch</span>: e.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceCount</span>: e.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                        <span class="attr">voiceSwitch</span>: e.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceMinute</span>: <span class="number">2</span>,</span><br><span class="line">                        <span class="attr">voiceSecond</span>: <span class="number">120</span>,</span><br><span class="line">                      &#125;)</span><br><span class="line">                    : <span class="number">1</span> == e.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">                    ? t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">screenSwitch</span>: e.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceCount</span>: e.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                        <span class="attr">voiceSwitch</span>: e.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceMinute</span>: <span class="number">5</span>,</span><br><span class="line">                        <span class="attr">voiceSecond</span>: <span class="number">300</span>,</span><br><span class="line">                      &#125;)</span><br><span class="line">                    : <span class="number">2</span> == e.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">                    ? t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">screenSwitch</span>: e.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceCount</span>: e.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                        <span class="attr">voiceSwitch</span>: e.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceMinute</span>: <span class="number">10</span>,</span><br><span class="line">                        <span class="attr">voiceSecond</span>: <span class="number">600</span>,</span><br><span class="line">                      &#125;)</span><br><span class="line">                    : t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">screenSwitch</span>: e.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceCount</span>: e.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                        <span class="attr">voiceSwitch</span>: e.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                        <span class="attr">voiceMinute</span>: <span class="number">15</span>,</span><br><span class="line">                        <span class="attr">voiceSecond</span>: <span class="number">900</span>,</span><br><span class="line">                      &#125;),</span><br><span class="line">                  t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                    <span class="attr">time</span>: <span class="literal">null</span> == e.<span class="property">data</span>.<span class="property">runTime</span> ? <span class="string">&quot;00:00:00&quot;</span> : e.<span class="property">data</span>.<span class="property">runTime</span>,</span><br><span class="line">                    <span class="attr">startRunDate</span>: e.<span class="property">data</span>.<span class="property">startTime</span>,</span><br><span class="line">                    <span class="attr">voiceNumber</span>:</span><br><span class="line">                      <span class="title class_">Math</span>.<span class="title function_">floor</span>(e.<span class="property">data</span>.<span class="property">runSecond</span> / t.<span class="property">data</span>.<span class="property">voiceSecond</span>) + <span class="number">1</span>,</span><br><span class="line">                  &#125;))</span><br><span class="line">                : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getRunTime&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">closeEvent4</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#erroruploading&quot;</span>).<span class="title function_">hideAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">uploadPoint</span>: <span class="keyword">function</span> (<span class="params">a, n</span>) &#123;</span><br><span class="line">    (<span class="string">&quot;&quot;</span> != <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">detailId</span> &amp;&amp; <span class="literal">null</span> != <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">detailId</span>) ||</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#erroruploading&quot;</span>).<span class="title function_">showAlertView</span>();</span><br><span class="line">    <span class="keyword">var</span> r = &#123;&#125;;</span><br><span class="line">    (r.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (r.<span class="property">detailId</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (r.<span class="property">uploadType</span> = <span class="string">&quot;0&quot;</span>),</span><br><span class="line">      (r.<span class="property">longitude</span> = t.<span class="property">longitude</span>),</span><br><span class="line">      (r.<span class="property">latitude</span> = t.<span class="property">latitude</span>),</span><br><span class="line">      (r.<span class="property">mileage</span> = t.<span class="property">runmeters</span>),</span><br><span class="line">      (r.<span class="property">seqNo</span> = <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">var</span> d = e.<span class="title function_">sortKey</span>(r, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      ((r.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(d)),</span><br><span class="line">      (r.<span class="property">runArray</span> = t.<span class="property">runArray</span>),</span><br><span class="line">      <span class="number">0</span> == t.<span class="property">runArray</span>.<span class="property">length</span>)</span><br><span class="line">    )</span><br><span class="line">      <span class="keyword">return</span> !<span class="number">1</span>;</span><br><span class="line">    wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">      <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/locaAllTrajectory&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: r,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常locaAllTrajectory500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ||</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常locaAllTrajectory&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">openLocationAdapter</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>,</span><br><span class="line">      e = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">    wx.<span class="title function_">getSystemInfo</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">locationEnabled</span>: a.<span class="property">locationEnabled</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">          !t.<span class="property">data</span>.<span class="property">locationEnabled</span>)</span><br><span class="line">        )</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            e.<span class="title function_">showAlertView</span>(),</span><br><span class="line">            t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">positionCount</span>: t.<span class="property">data</span>.<span class="property">positionCount</span> + <span class="number">1</span>,</span><br><span class="line">            &#125;),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>, t.<span class="property">data</span>.<span class="property">positionCount</span>),</span><br><span class="line">            !<span class="number">1</span></span><br><span class="line">          );</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">closeEvent2</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#gpsalertview&quot;</span>);</span><br><span class="line">    t.<span class="title function_">hideAlertView</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">locationEnabled</span> || t.<span class="title function_">showAlertView</span>(),</span><br><span class="line">      wx.<span class="title function_">showTabBar</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">closeBlueEvent</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#blueView&quot;</span>).<span class="title function_">hideAlertView</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onShow</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      (<span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">openPageNum</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">openPageNum</span> + <span class="number">1</span>,</span><br><span class="line">        <span class="attr">navheight</span>: o.<span class="property">globalData</span>.<span class="property">navBarHeight</span>,</span><br><span class="line">        <span class="attr">winHeight</span>: o.<span class="property">globalData</span>.<span class="property">windowHeight</span>,</span><br><span class="line">        <span class="attr">screenHeight</span>: o.<span class="property">globalData</span>.<span class="property">screenHeight</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">openBluetoothAdapter</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">openLocationAdapter</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">startLocationUpdateBackground</span>(),</span><br><span class="line">      !wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>))</span><br><span class="line">    )</span><br><span class="line">      <span class="keyword">return</span> !<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">4</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> t = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;lineArray&quot;</span>),</span><br><span class="line">        e = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;markers&quot;</span>),</span><br><span class="line">        a = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;punchCardSum&quot;</span>),</span><br><span class="line">        i = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>),</span><br><span class="line">        n = [];</span><br><span class="line">      t.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; n.<span class="title function_">push</span>(t[<span class="number">0</span>]),</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">lineArray</span>: t,</span><br><span class="line">          <span class="attr">markers</span>: e,</span><br><span class="line">          <span class="attr">punchCardArray</span>: n,</span><br><span class="line">          <span class="attr">punchCardSum</span>: a,</span><br><span class="line">          <span class="attr">punchCardNum</span>: a - t.<span class="property">length</span>,</span><br><span class="line">          <span class="attr">runBitmap</span>: i,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="number">2</span> == <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">runType</span> || <span class="variable language_">this</span>.<span class="title function_">getPunchCard</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onHide</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">isbackground</span>: !<span class="number">0</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onUnload</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="attr">changeVido</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      <span class="attr">ispenvido</span>: !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">ispenvido</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">ispenvido</span></span><br><span class="line">        ? <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">volume</span>: <span class="number">1</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">        : <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">volume</span>: <span class="number">0</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">cancelEvent</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endalertview</span>.<span class="title function_">hideAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">confirmEvent</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endalertview</span>.<span class="title function_">hideAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">closeEvent3</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">selectComponent</span>(<span class="string">&quot;#errorrun&quot;</span>).<span class="title function_">hideAlertView</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">closeToindex</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">stopLocationUpdate</span>(),</span><br><span class="line">      <span class="built_in">clearTimeout</span>(r),</span><br><span class="line">      t.<span class="title function_">clearRunCacheData</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">time</span>: <span class="string">&quot;00:00:00&quot;</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">switchTab</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;/pages/index/index&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">initstartRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>;</span><br><span class="line">    wx.<span class="title function_">getLocation</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;gcj02&quot;</span>,</span><br><span class="line">      <span class="attr">isHighAccuracy</span>: !<span class="number">0</span>,</span><br><span class="line">      <span class="attr">highAccuracyExpireTime</span>: <span class="number">3e3</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">          (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">            <span class="attr">initlatitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">            <span class="attr">initlongitude</span>: e.<span class="property">longitude</span>,</span><br><span class="line">            <span class="attr">latitude</span>: e.<span class="property">latitude</span>,</span><br><span class="line">            <span class="attr">longitude</span>: e.<span class="property">longitude</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;positionCount&quot;</span>, <span class="number">0</span>),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;continueCount&quot;</span>, <span class="number">0</span>),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;initlatitude&quot;</span>, e.<span class="property">latitude</span>),</span><br><span class="line">          wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;initlongitude&quot;</span>, e.<span class="property">longitude</span>),</span><br><span class="line">          <span class="literal">null</span> == e.<span class="property">longitude</span> ||</span><br><span class="line">            <span class="literal">null</span> == e.<span class="property">longitude</span> ||</span><br><span class="line">            <span class="string">&quot;&quot;</span> == e.<span class="property">longitude</span> ||</span><br><span class="line">            <span class="literal">null</span> == e.<span class="property">latitude</span> ||</span><br><span class="line">            <span class="literal">null</span> == e.<span class="property">latitude</span> ||</span><br><span class="line">            <span class="string">&quot;&quot;</span> == e.<span class="property">latitude</span>)</span><br><span class="line">        )</span><br><span class="line">          <span class="keyword">return</span> t.<span class="title function_">selectComponent</span>(<span class="string">&quot;#errorrun&quot;</span>).<span class="title function_">showAlertView</span>(), !<span class="number">1</span>;</span><br><span class="line">        <span class="number">4</span> == t.<span class="property">data</span>.<span class="property">runType</span></span><br><span class="line">          ? t.<span class="title function_">apiStartSchoolRun</span>(e.<span class="property">longitude</span>, e.<span class="property">latitude</span>)</span><br><span class="line">          : t.<span class="title function_">apiStartRun</span>(e.<span class="property">longitude</span>, e.<span class="property">latitude</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;位置获取失败，getLocation异常&quot;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">          t.<span class="title function_">selectComponent</span>(<span class="string">&quot;#errorrun&quot;</span>).<span class="title function_">showAlertView</span>(),</span><br><span class="line">          !<span class="number">1</span></span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">apiStartSchoolRun</span>: <span class="keyword">function</span> (<span class="params">a, r</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="variable language_">this</span>,</span><br><span class="line">      s = &#123;&#125;;</span><br><span class="line">    (s.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (s.<span class="property">longitude</span> = a),</span><br><span class="line">      (s.<span class="property">latitude</span> = r);</span><br><span class="line">    <span class="keyword">var</span> u = e.<span class="title function_">sortKey</span>(s, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (s.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(u)),</span><br><span class="line">      (s.<span class="property">runType</span> = d.<span class="property">data</span>.<span class="property">runType</span>),</span><br><span class="line">      (s.<span class="property">lineId</span> = d.<span class="property">data</span>.<span class="property">lineId</span> ? d.<span class="property">data</span>.<span class="property">lineId</span> : <span class="number">0</span>),</span><br><span class="line">      (s.<span class="property">userid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>),</span><br><span class="line">      (s.<span class="property">batchNo</span> = d.<span class="property">data</span>.<span class="property">batchNo</span> ? d.<span class="property">data</span>.<span class="property">batchNo</span> : <span class="string">&quot;&quot;</span>),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/startSchoolRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: s,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != a.<span class="property">statusCode</span>))</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常startSchoolRun500&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;),</span><br><span class="line">              d.<span class="title function_">selectComponent</span>(<span class="string">&quot;#erroruploading&quot;</span>).<span class="title function_">showAlertView</span>(),</span><br><span class="line">              !<span class="number">1</span></span><br><span class="line">            );</span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> != a.<span class="property">data</span>.<span class="property">retcode</span>)</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">          d.<span class="title function_">count_down</span>(d), d.<span class="title function_">onLocationChange</span>();</span><br><span class="line">          <span class="keyword">for</span> (</span><br><span class="line">            <span class="keyword">var</span> i = d.<span class="property">data</span>.<span class="property">markers</span>, o = d.<span class="property">data</span>.<span class="property">lineArray</span>, r = [], s = <span class="number">0</span>;</span><br><span class="line">            s &lt; a.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>;</span><br><span class="line">            s++</span><br><span class="line">          ) &#123;</span><br><span class="line">            <span class="keyword">var</span> u = &#123;&#125;;</span><br><span class="line">            (u.<span class="property">id</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceId</span>),</span><br><span class="line">              (u.<span class="property">deviceId</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceId</span>),</span><br><span class="line">              (u.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">latitude</span>),</span><br><span class="line">              (u.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">longitude</span>),</span><br><span class="line">              (u.<span class="property">lineOrder</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">lineOrder</span>),</span><br><span class="line">              (u.<span class="property">iconPath</span> =</span><br><span class="line">                <span class="string">&quot;/images/blue&quot;</span> + a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">lineOrder</span> + <span class="string">&quot;.png&quot;</span>),</span><br><span class="line">              (u.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">              (u.<span class="property">height</span> = <span class="number">25</span>),</span><br><span class="line">              s == a.<span class="property">data</span>.<span class="property">uploadDetailNum</span> &amp;&amp;</span><br><span class="line">                <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">uploadType</span> &amp;&amp;</span><br><span class="line">                (u.<span class="property">callout</span> = &#123;</span><br><span class="line">                  <span class="attr">content</span>: <span class="string">&quot;上传人脸&quot;</span>,</span><br><span class="line">                  <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                  <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                  <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                  <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                  <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                  <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                  <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">              <span class="number">0</span> == s ? (i.<span class="title function_">push</span>(u), o.<span class="title function_">push</span>(u), r.<span class="title function_">push</span>(u)) : o.<span class="title function_">push</span>(u);</span><br><span class="line">          &#125;</span><br><span class="line">          (t.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">            d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">startRunDate</span>: <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()),</span><br><span class="line">              <span class="attr">runstatus</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">detailId</span>: a.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">              <span class="attr">aniHeigh</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">markers</span>: i,</span><br><span class="line">              <span class="attr">punchCardArray</span>: r,</span><br><span class="line">              <span class="attr">runBitmap</span>: a.<span class="property">data</span>.<span class="property">runBitmap</span>,</span><br><span class="line">              <span class="attr">minTime</span>: a.<span class="property">data</span>.<span class="property">minTime</span>,</span><br><span class="line">              <span class="attr">maxTime</span>: a.<span class="property">data</span>.<span class="property">maxTime</span>,</span><br><span class="line">              <span class="attr">mileageTarget</span>: a.<span class="property">data</span>.<span class="property">mileageTarget</span>,</span><br><span class="line">              <span class="attr">maxSpaceTime</span>: a.<span class="property">data</span>.<span class="property">maxSpaceTime</span>,</span><br><span class="line">              <span class="attr">lineArray</span>: o,</span><br><span class="line">              <span class="attr">stopArray</span>: a.<span class="property">data</span>.<span class="property">lineArray</span>,</span><br><span class="line">              <span class="attr">searchDiam</span>: a.<span class="property">data</span>.<span class="property">searchDiam</span>,</span><br><span class="line">              <span class="attr">uploadType</span>: a.<span class="property">data</span>.<span class="property">uploadType</span>,</span><br><span class="line">              <span class="attr">uploadDetailNum</span>: a.<span class="property">data</span>.<span class="property">uploadDetailNum</span>,</span><br><span class="line">              <span class="attr">schoolId</span>: a.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">              <span class="attr">runCheckStatus</span>: a.<span class="property">data</span>.<span class="property">runCheckStatus</span>,</span><br><span class="line">              <span class="attr">deviceType</span>: a.<span class="property">data</span>.<span class="property">deviceType</span>,</span><br><span class="line">              <span class="attr">punchCardSum</span>: a.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>,</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="number">0</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">2</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">120</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">5</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">300</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="number">2</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">10</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">600</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">15</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">900</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;detailId&quot;</span>, t.<span class="property">detailId</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>, a.<span class="property">data</span>.<span class="property">schoolId</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>, a.<span class="property">data</span>.<span class="property">uploadDetailNum</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>, a.<span class="property">data</span>.<span class="property">uploadType</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>, a.<span class="property">data</span>.<span class="property">runCheckStatus</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;minTime&quot;</span>, a.<span class="property">data</span>.<span class="property">minTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>, a.<span class="property">data</span>.<span class="property">maxTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>, a.<span class="property">data</span>.<span class="property">mileageTarget</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>, a.<span class="property">data</span>.<span class="property">maxSpaceTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>, a.<span class="property">data</span>.<span class="property">deviceType</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>, d.<span class="property">data</span>.<span class="property">startRunDate</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;punchCardSum&quot;</span>, a.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;markers&quot;</span>, d.<span class="property">data</span>.<span class="property">markers</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;lineArray&quot;</span>, d.<span class="property">data</span>.<span class="property">lineArray</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runBitmap&quot;</span>, d.<span class="property">data</span>.<span class="property">runBitmap</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常startRun&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;),</span><br><span class="line">            d.<span class="title function_">selectComponent</span>(<span class="string">&quot;#wlerrorrun&quot;</span>).<span class="title function_">showAlertView</span>(),</span><br><span class="line">            !<span class="number">1</span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">apiStartRun</span>: <span class="keyword">function</span> (<span class="params">a, r</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="variable language_">this</span>,</span><br><span class="line">      s = &#123;&#125;;</span><br><span class="line">    (s.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (s.<span class="property">runType</span> = d.<span class="property">data</span>.<span class="property">runType</span>.<span class="title function_">toString</span>()),</span><br><span class="line">      (s.<span class="property">longitude</span> = a),</span><br><span class="line">      (s.<span class="property">latitude</span> = r);</span><br><span class="line">    <span class="keyword">var</span> u = e.<span class="title function_">sortKey</span>(s, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (s.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(u)),</span><br><span class="line">      (s.<span class="property">lineId</span> = d.<span class="property">data</span>.<span class="property">lineId</span> ? d.<span class="property">data</span>.<span class="property">lineId</span> : <span class="number">0</span>),</span><br><span class="line">      (s.<span class="property">userid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>),</span><br><span class="line">      (s.<span class="property">batchNo</span> = d.<span class="property">data</span>.<span class="property">batchNo</span> ? d.<span class="property">data</span>.<span class="property">batchNo</span> : <span class="string">&quot;&quot;</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/startRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: s,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != a.<span class="property">statusCode</span>))</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常startRun500&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;),</span><br><span class="line">              d.<span class="title function_">selectComponent</span>(<span class="string">&quot;#erroruploading&quot;</span>).<span class="title function_">showAlertView</span>(),</span><br><span class="line">              !<span class="number">1</span></span><br><span class="line">            );</span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> != a.<span class="property">data</span>.<span class="property">retcode</span>) <span class="keyword">return</span>;</span><br><span class="line">          d.<span class="title function_">count_down</span>(d), d.<span class="title function_">onLocationChange</span>();</span><br><span class="line">          <span class="keyword">for</span> (</span><br><span class="line">            <span class="keyword">var</span> i = d.<span class="property">data</span>.<span class="property">markers</span>, o = [], r = [], s = <span class="number">0</span>;</span><br><span class="line">            s &lt; a.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>;</span><br><span class="line">            s++</span><br><span class="line">          ) &#123;</span><br><span class="line">            <span class="keyword">var</span> u = &#123;&#125;;</span><br><span class="line">            (u.<span class="property">id</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceId</span>),</span><br><span class="line">              (u.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">latitude</span>),</span><br><span class="line">              (u.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">longitude</span>),</span><br><span class="line">              (u.<span class="property">deviceType</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceType</span>),</span><br><span class="line">              (u.<span class="property">deviceId</span> = a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceId</span>),</span><br><span class="line">              (u.<span class="property">iconPath</span> = <span class="string">&quot;/images/21_position.png&quot;</span>),</span><br><span class="line">              (u.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">              (u.<span class="property">height</span> = <span class="number">25</span>),</span><br><span class="line">              s == a.<span class="property">data</span>.<span class="property">uploadDetailNum</span> &amp;&amp;</span><br><span class="line">                <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">uploadType</span> &amp;&amp;</span><br><span class="line">                (u.<span class="property">callout</span> = &#123;</span><br><span class="line">                  <span class="attr">content</span>: <span class="string">&quot;上传人脸&quot;</span>,</span><br><span class="line">                  <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                  <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                  <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                  <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                  <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                  <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                  <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">              <span class="number">3</span> == a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceType</span> &amp;&amp;</span><br><span class="line">                (u.<span class="property">callout</span> = &#123;</span><br><span class="line">                  <span class="attr">content</span>: <span class="string">&quot;训练杆&quot;</span>,</span><br><span class="line">                  <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                  <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                  <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                  <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                  <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                  <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                  <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">              i.<span class="title function_">push</span>(u),</span><br><span class="line">              <span class="number">3</span> != a.<span class="property">data</span>.<span class="property">lineArray</span>[s].<span class="property">deviceType</span> ? o.<span class="title function_">push</span>(u) : r.<span class="title function_">push</span>(u);</span><br><span class="line">          &#125;</span><br><span class="line">          (t.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">            d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">startRunDate</span>: <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()),</span><br><span class="line">              <span class="attr">runstatus</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">detailId</span>: a.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">              <span class="attr">aniHeigh</span>: <span class="number">0</span>,</span><br><span class="line">              <span class="attr">markers</span>: i,</span><br><span class="line">              <span class="attr">minTime</span>: a.<span class="property">data</span>.<span class="property">minTime</span>,</span><br><span class="line">              <span class="attr">maxTime</span>: a.<span class="property">data</span>.<span class="property">maxTime</span>,</span><br><span class="line">              <span class="attr">mileageTarget</span>: a.<span class="property">data</span>.<span class="property">mileageTarget</span>,</span><br><span class="line">              <span class="attr">maxSpaceTime</span>: a.<span class="property">data</span>.<span class="property">maxSpaceTime</span>,</span><br><span class="line">              <span class="attr">lineArray</span>: a.<span class="property">data</span>.<span class="property">lineArray</span>,</span><br><span class="line">              <span class="attr">stopArray</span>: a.<span class="property">data</span>.<span class="property">lineArray</span>,</span><br><span class="line">              <span class="attr">searchDiam</span>: a.<span class="property">data</span>.<span class="property">searchDiam</span>,</span><br><span class="line">              <span class="attr">uploadType</span>: a.<span class="property">data</span>.<span class="property">uploadType</span>,</span><br><span class="line">              <span class="attr">uploadDetailNum</span>: a.<span class="property">data</span>.<span class="property">uploadDetailNum</span>,</span><br><span class="line">              <span class="attr">schoolId</span>: a.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">              <span class="attr">runCheckStatus</span>: a.<span class="property">data</span>.<span class="property">runCheckStatus</span>,</span><br><span class="line">              <span class="attr">deviceType</span>: a.<span class="property">data</span>.<span class="property">deviceType</span>,</span><br><span class="line">              <span class="attr">punchCardSum</span>: a.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>,</span><br><span class="line">              <span class="attr">punchCardArray</span>: o,</span><br><span class="line">              <span class="attr">suspendCardArray</span>: r,</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="number">0</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">2</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">120</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">5</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">300</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="number">2</span> == a.<span class="property">data</span>.<span class="property">voiceCount</span></span><br><span class="line">              ? d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">10</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">600</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : d.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">screenSwitch</span>: a.<span class="property">data</span>.<span class="property">screenSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceCount</span>: a.<span class="property">data</span>.<span class="property">voiceCount</span>,</span><br><span class="line">                  <span class="attr">voiceSwitch</span>: a.<span class="property">data</span>.<span class="property">voiceSwitch</span>,</span><br><span class="line">                  <span class="attr">voiceMinute</span>: <span class="number">15</span>,</span><br><span class="line">                  <span class="attr">voiceSecond</span>: <span class="number">900</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;detailId&quot;</span>, t.<span class="property">detailId</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;schoolId&quot;</span>, a.<span class="property">data</span>.<span class="property">schoolId</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;uploadDetailNum&quot;</span>, a.<span class="property">data</span>.<span class="property">uploadDetailNum</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;uploadType&quot;</span>, a.<span class="property">data</span>.<span class="property">uploadType</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runCheckStatus&quot;</span>, a.<span class="property">data</span>.<span class="property">runCheckStatus</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;minTime&quot;</span>, a.<span class="property">data</span>.<span class="property">minTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;maxTime&quot;</span>, a.<span class="property">data</span>.<span class="property">maxTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;mileageTarget&quot;</span>, a.<span class="property">data</span>.<span class="property">mileageTarget</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;maxSpaceTime&quot;</span>, a.<span class="property">data</span>.<span class="property">maxSpaceTime</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;deviceType&quot;</span>, a.<span class="property">data</span>.<span class="property">deviceType</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;startRunDate&quot;</span>, d.<span class="property">data</span>.<span class="property">startRunDate</span>),</span><br><span class="line">            wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常startRun&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;),</span><br><span class="line">            d.<span class="title function_">selectComponent</span>(<span class="string">&quot;#wlerrorrun&quot;</span>).<span class="title function_">showAlertView</span>(),</span><br><span class="line">            !<span class="number">1</span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">schoolRunPunchCard</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;来到school打卡点&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">runPunchCard2</span>: <span class="keyword">function</span> (<span class="params">deviceId,longtitude,latitude,</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="variable language_">this</span>,</span><br><span class="line">      r = &#123;&#125;;</span><br><span class="line">    (r.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (r.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (r.<span class="property">deviceId</span> = deviceId);</span><br><span class="line">    <span class="keyword">var</span> d = e.<span class="title function_">sortKey</span>(r, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (r.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(d)),</span><br><span class="line">      (r.<span class="property">longitude</span> = longtitude),</span><br><span class="line">      (r.<span class="property">latitude</span> = latitude),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/runPunchCard&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: r,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != i.<span class="property">statusCode</span>))</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常runPunchCard500&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == i.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = a.<span class="property">data</span>.<span class="property">lineArray</span>, r = <span class="number">0</span>; r &lt; o.<span class="property">length</span>; r++)</span><br><span class="line">              o[r].<span class="property">deviceId</span> == t &amp;&amp; o.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">var</span> d = a.<span class="property">data</span>.<span class="property">markers</span>;</span><br><span class="line">            <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; d.<span class="property">length</span>; r++)</span><br><span class="line">              d[r].<span class="property">id</span> == t &amp;&amp; (d[r].<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> s = a.<span class="property">data</span>.<span class="property">punchCardArray</span>;</span><br><span class="line">            <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; s.<span class="property">length</span>; r++) s[r].<span class="property">deviceId</span> == t &amp;&amp; s.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">lineArray</span>: o,</span><br><span class="line">              <span class="attr">markers</span>: d,</span><br><span class="line">              <span class="attr">lastDkDeviceid</span>: t,</span><br><span class="line">              <span class="attr">punchCardArray</span>: s,</span><br><span class="line">            &#125;),</span><br><span class="line">              wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>, a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000012&quot;</span> == i.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (o = a.<span class="property">data</span>.<span class="property">lineArray</span>, r = <span class="number">0</span>; r &lt; o.<span class="property">length</span>; r++)</span><br><span class="line">              o[r].<span class="property">deviceId</span> == t &amp;&amp; o.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (d = a.<span class="property">data</span>.<span class="property">markers</span>, r = <span class="number">0</span>; r &lt; d.<span class="property">length</span>; r++)</span><br><span class="line">              d[r].<span class="property">id</span> == t &amp;&amp; (d[r].<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (s = a.<span class="property">data</span>.<span class="property">punchCardArray</span>, r = <span class="number">0</span>; r &lt; s.<span class="property">length</span>; r++)</span><br><span class="line">              s[r].<span class="property">deviceId</span> == t &amp;&amp; s.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">lineArray</span>: o,</span><br><span class="line">              <span class="attr">markers</span>: d,</span><br><span class="line">              <span class="attr">lastDkDeviceid</span>: t,</span><br><span class="line">              <span class="attr">punchCardArray</span>: s,</span><br><span class="line">            &#125;),</span><br><span class="line">              wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>, a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span></span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: i.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常runPunchCard&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">runPunchCard</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>,</span><br><span class="line">      r = &#123;&#125;;</span><br><span class="line">    (r.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (r.<span class="property">detailId</span> = a.<span class="property">data</span>.<span class="property">detailId</span>),</span><br><span class="line">      (r.<span class="property">deviceId</span> = t);</span><br><span class="line">    <span class="keyword">var</span> d = e.<span class="title function_">sortKey</span>(r, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (r.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(d)),</span><br><span class="line">      (r.<span class="property">longitude</span> = a.<span class="property">data</span>.<span class="property">longitude</span>),</span><br><span class="line">      (r.<span class="property">latitude</span> = a.<span class="property">data</span>.<span class="property">latitude</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/runPunchCard&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: r,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != i.<span class="property">statusCode</span>))</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常runPunchCard500&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == i.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> o = a.<span class="property">data</span>.<span class="property">lineArray</span>, r = <span class="number">0</span>; r &lt; o.<span class="property">length</span>; r++)</span><br><span class="line">              o[r].<span class="property">deviceId</span> == t &amp;&amp; o.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">var</span> d = a.<span class="property">data</span>.<span class="property">markers</span>;</span><br><span class="line">            <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; d.<span class="property">length</span>; r++)</span><br><span class="line">              d[r].<span class="property">id</span> == t &amp;&amp; (d[r].<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> s = a.<span class="property">data</span>.<span class="property">punchCardArray</span>;</span><br><span class="line">            <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; s.<span class="property">length</span>; r++) s[r].<span class="property">deviceId</span> == t &amp;&amp; s.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">lineArray</span>: o,</span><br><span class="line">              <span class="attr">markers</span>: d,</span><br><span class="line">              <span class="attr">lastDkDeviceid</span>: t,</span><br><span class="line">              <span class="attr">punchCardArray</span>: s,</span><br><span class="line">            &#125;),</span><br><span class="line">              wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>, a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000012&quot;</span> == i.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (o = a.<span class="property">data</span>.<span class="property">lineArray</span>, r = <span class="number">0</span>; r &lt; o.<span class="property">length</span>; r++)</span><br><span class="line">              o[r].<span class="property">deviceId</span> == t &amp;&amp; o.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (d = a.<span class="property">data</span>.<span class="property">markers</span>, r = <span class="number">0</span>; r &lt; d.<span class="property">length</span>; r++)</span><br><span class="line">              d[r].<span class="property">id</span> == t &amp;&amp; (d[r].<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (s = a.<span class="property">data</span>.<span class="property">punchCardArray</span>, r = <span class="number">0</span>; r &lt; s.<span class="property">length</span>; r++)</span><br><span class="line">              s[r].<span class="property">deviceId</span> == t &amp;&amp; s.<span class="title function_">splice</span>(r, <span class="number">1</span>);</span><br><span class="line">            a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">lineArray</span>: o,</span><br><span class="line">              <span class="attr">markers</span>: d,</span><br><span class="line">              <span class="attr">lastDkDeviceid</span>: t,</span><br><span class="line">              <span class="attr">punchCardArray</span>: s,</span><br><span class="line">            &#125;),</span><br><span class="line">              wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;lastDkDeviceid&quot;</span>, a.<span class="property">data</span>.<span class="property">lastDkDeviceid</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span></span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: i.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常runPunchCard&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getPunchCard</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>,</span><br><span class="line">      n = &#123;&#125;;</span><br><span class="line">    (n.<span class="property">userid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>),</span><br><span class="line">      (n.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>));</span><br><span class="line">    <span class="keyword">var</span> r = e.<span class="title function_">sortKey</span>(n, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (n.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (n.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(r)),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getPunchCard&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: n,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != t.<span class="property">statusCode</span>))</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常getPunchCard500&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (</span><br><span class="line">              <span class="keyword">var</span> e = [], i = <span class="number">0</span>, o = [], n = [], r = <span class="number">0</span>;</span><br><span class="line">              r &lt; t.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>;</span><br><span class="line">              r++</span><br><span class="line">            ) &#123;</span><br><span class="line">              <span class="keyword">var</span> d = &#123;&#125;;</span><br><span class="line">              (d.<span class="property">id</span> = t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceId</span>),</span><br><span class="line">                (d.<span class="property">latitude</span> = t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">latitude</span>),</span><br><span class="line">                (d.<span class="property">longitude</span> = t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">longitude</span>),</span><br><span class="line">                (d.<span class="property">deviceType</span> = t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceType</span>),</span><br><span class="line">                (d.<span class="property">deviceId</span> = t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceId</span>),</span><br><span class="line">                <span class="number">1</span> == t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceStatus</span></span><br><span class="line">                  ? ((d.<span class="property">iconPath</span> = <span class="string">&quot;/images/dak.png&quot;</span>), (i += <span class="number">1</span>))</span><br><span class="line">                  : (d.<span class="property">iconPath</span> = <span class="string">&quot;/images/21_position.png&quot;</span>),</span><br><span class="line">                (d.<span class="property">width</span> = <span class="number">25</span>),</span><br><span class="line">                (d.<span class="property">height</span> = <span class="number">25</span>),</span><br><span class="line">                r == a.<span class="property">data</span>.<span class="property">uploadDetailNum</span> &amp;&amp;</span><br><span class="line">                  <span class="number">1</span> == a.<span class="property">data</span>.<span class="property">uploadType</span> &amp;&amp;</span><br><span class="line">                  (d.<span class="property">callout</span> = &#123;</span><br><span class="line">                    <span class="attr">content</span>: <span class="string">&quot;上传人脸&quot;</span>,</span><br><span class="line">                    <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                    <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                    <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                    <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                    <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                    <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                  &#125;),</span><br><span class="line">                <span class="number">3</span> == t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceType</span> &amp;&amp;</span><br><span class="line">                  (d.<span class="property">callout</span> = &#123;</span><br><span class="line">                    <span class="attr">content</span>: <span class="string">&quot;训练杆&quot;</span>,</span><br><span class="line">                    <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                    <span class="attr">bgColor</span>: <span class="string">&quot;#FFF&quot;</span>,</span><br><span class="line">                    <span class="attr">borderWidth</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">borderColor</span>: <span class="string">&quot;#CCC&quot;</span>,</span><br><span class="line">                    <span class="attr">padding</span>: <span class="number">4</span>,</span><br><span class="line">                    <span class="attr">display</span>: <span class="string">&quot;ALWAYS&quot;</span>,</span><br><span class="line">                    <span class="attr">textAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                  &#125;),</span><br><span class="line">                e.<span class="title function_">push</span>(d),</span><br><span class="line">                <span class="number">3</span> != t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceType</span> &amp;&amp;</span><br><span class="line">                <span class="number">1</span> != t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceStatus</span></span><br><span class="line">                  ? o.<span class="title function_">push</span>(d)</span><br><span class="line">                  : <span class="number">3</span> == t.<span class="property">data</span>.<span class="property">lineArray</span>[r].<span class="property">deviceType</span> &amp;&amp; n.<span class="title function_">push</span>(d);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> s = t.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="string">&quot;1&quot;</span> !== t.<span class="property">deviceStatus</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">            a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">lineArray</span>: s,</span><br><span class="line">              <span class="attr">stopArray</span>: t.<span class="property">data</span>.<span class="property">lineArray</span>,</span><br><span class="line">              <span class="attr">markers</span>: e,</span><br><span class="line">              <span class="attr">punchCardSum</span>: t.<span class="property">data</span>.<span class="property">lineArray</span>.<span class="property">length</span>,</span><br><span class="line">              <span class="attr">punchCardNum</span>: i,</span><br><span class="line">              <span class="attr">punchCardArray</span>: o,</span><br><span class="line">              <span class="attr">suspendCardArray</span>: n,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; <span class="keyword">else</span></span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getPunchCard&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">suspendRunBtn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="number">0</span> !=</span><br><span class="line">      e.<span class="title function_">getDistanceMark</span>(</span><br><span class="line">        a.<span class="property">data</span>.<span class="property">suspendCardArray</span>,</span><br><span class="line">        a.<span class="property">data</span>.<span class="property">latitude</span>,</span><br><span class="line">        a.<span class="property">data</span>.<span class="property">longitude</span>,</span><br><span class="line">        a.<span class="property">data</span>.<span class="property">searchDiam</span></span><br><span class="line">      )</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">var</span> i = &#123;&#125;;</span><br><span class="line">      (i.<span class="property">mobileTime</span> = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) / <span class="number">1e3</span>),</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">          <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">          <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getTimeStatus2&quot;</span>,</span><br><span class="line">          <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">          <span class="attr">data</span>: i,</span><br><span class="line">          <span class="attr">header</span>: &#123;</span><br><span class="line">            <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != i.<span class="property">statusCode</span>))</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常recoveryRun500&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;000000&quot;</span> == i.<span class="property">data</span>.<span class="property">retcode</span>) &#123;</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;暂停成功&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">              &#125;),</span><br><span class="line">                wx.<span class="title function_">offLocationChange</span>();</span><br><span class="line">              e.<span class="title function_">playYuying</span>(<span class="string">&quot;/images/stoprun.mp3&quot;</span>),</span><br><span class="line">                a.<span class="property">data</span>.<span class="property">timeoutArray</span>.<span class="title function_">push</span>(<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>())),</span><br><span class="line">                a.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                  <span class="attr">runstatus</span>: <span class="number">1</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">                t.<span class="title function_">stopRun</span>(),</span><br><span class="line">                wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;timeoutArray&quot;</span>, a.<span class="property">data</span>.<span class="property">timeoutArray</span>),</span><br><span class="line">                wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;runstatus&quot;</span>, <span class="number">1</span>),</span><br><span class="line">                a.<span class="title function_">suspendRun</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: i.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getTimeStatus2&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">      wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;需在训练杆处暂停&quot;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">suspendRun</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = &#123;&#125;;</span><br><span class="line">    (t.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (t.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>)),</span><br><span class="line">      (t.<span class="property">longitude</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">longitude</span>),</span><br><span class="line">      (t.<span class="property">latitude</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">latitude</span>),</span><br><span class="line">      (t.<span class="property">seqNo</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">seqNo</span>);</span><br><span class="line">    <span class="keyword">var</span> a = e.<span class="title function_">sortKey</span>(t, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (t.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(a)),</span><br><span class="line">      (t.<span class="property">suspendTime</span> = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) / <span class="number">1e3</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/suspendRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: t,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常suspendRun500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ||</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常suspendRun&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">recoveryRunBtn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>,</span><br><span class="line">      e = &#123;&#125;;</span><br><span class="line">    (e.<span class="property">mobileTime</span> = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) / <span class="number">1e3</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/getTimeStatus2&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: e,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != e.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常recoveryRun500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == e.<span class="property">data</span>.<span class="property">retcode</span></span><br><span class="line">              ? (wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;继续成功&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;),</span><br><span class="line">                t.<span class="title function_">startLocationUpdateBackground</span>(),</span><br><span class="line">                t.<span class="title function_">onLocationChange</span>())</span><br><span class="line">              : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: e.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">2e3</span>,</span><br><span class="line">                  <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常getTimeStatus2&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">recoveryRun</span>: <span class="keyword">function</span> (<span class="params">t, a</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> n = &#123;&#125;;</span><br><span class="line">    (n.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (n.<span class="property">detailId</span> = wx.<span class="title function_">getStorageSync</span>(<span class="string">&quot;detailId&quot;</span>)),</span><br><span class="line">      (n.<span class="property">longitude</span> = t),</span><br><span class="line">      (n.<span class="property">latitude</span> = a),</span><br><span class="line">      (n.<span class="property">seqNo</span> = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">seqNo</span>);</span><br><span class="line">    <span class="keyword">var</span> r = e.<span class="title function_">sortKey</span>(n, o.<span class="property">globalData</span>.<span class="property">datakey</span>);</span><br><span class="line">    (n.<span class="property">sign</span> = i.<span class="title function_">hexMD5</span>(r)),</span><br><span class="line">      (n.<span class="property">suspendTime</span> = <span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) / <span class="number">1e3</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/recoveryRun&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: n,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常recoveryRun500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ||</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常recoveryRun&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">runSet</span>: <span class="keyword">function</span> (<span class="params">t, e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = &#123;&#125;;</span><br><span class="line">    (a.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (a.<span class="property">userid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">userid</span>),</span><br><span class="line">      wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;/f/api/runSet&quot;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: a,</span><br><span class="line">        <span class="attr">header</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">t</span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            <span class="number">200</span> != t.<span class="property">statusCode</span></span><br><span class="line">              ? wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常runSet500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">              : <span class="string">&quot;000000&quot;</span> == t.<span class="property">data</span>.<span class="property">retcode</span> ||</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: t.<span class="property">data</span>.<span class="property">retmsg</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">hideLoading</span>(),</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试,网络或服务器异常runSet&quot;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">              <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">sdrunPunchCard</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>,</span><br><span class="line">      a = t.<span class="property">data</span>.<span class="property">markers</span>,</span><br><span class="line">      n = e.<span class="title function_">getUploadDistanceMark</span>(</span><br><span class="line">        a,</span><br><span class="line">        t.<span class="property">data</span>.<span class="property">latitude</span>,</span><br><span class="line">        t.<span class="property">data</span>.<span class="property">longitude</span>,</span><br><span class="line">        t.<span class="property">data</span>.<span class="property">searchDiam</span></span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> != n &amp;&amp; <span class="number">1</span> != n &amp;&amp; n) &#123;</span><br><span class="line">      <span class="keyword">var</span> r = &#123;&#125;;</span><br><span class="line">      (r.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">        (r.<span class="property">fileType</span> = <span class="number">1</span>),</span><br><span class="line">        (r.<span class="property">imageType</span> = <span class="number">5</span>),</span><br><span class="line">        (r.<span class="property">schoolId</span> = t.<span class="property">data</span>.<span class="property">schoolId</span>);</span><br><span class="line">      <span class="keyword">var</span> d = e.<span class="title function_">sortKey</span>(r, o.<span class="property">globalData</span>.<span class="property">datakey</span>),</span><br><span class="line">        s = i.<span class="title function_">hexMD5</span>(d);</span><br><span class="line">      wx.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">sizeType</span>: [<span class="string">&quot;compressed&quot;</span>],</span><br><span class="line">        <span class="attr">sourceType</span>: [<span class="string">&quot;camera&quot;</span>],</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> a = e.<span class="property">tempFilePaths</span>[<span class="number">0</span>];</span><br><span class="line">          wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">            <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">            wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">              <span class="attr">filePath</span>: a,</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">              <span class="attr">header</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">formData</span>: &#123;</span><br><span class="line">                <span class="attr">openid</span>: o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>,</span><br><span class="line">                <span class="attr">fileType</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">imageType</span>: <span class="number">5</span>,</span><br><span class="line">                <span class="attr">batchNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="attr">sign</span>: s,</span><br><span class="line">                <span class="attr">detailId</span>: t.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">                <span class="attr">uploadImagetype</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="attr">schoolId</span>: t.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>))</span><br><span class="line">                  wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                  &#125;);</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="keyword">var</span> a = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(e.<span class="property">data</span>);</span><br><span class="line">                  <span class="string">&quot;000000&quot;</span> == a.<span class="property">retcode</span></span><br><span class="line">                    ? (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                        <span class="attr">fileName</span>: a.<span class="property">fileName</span>,</span><br><span class="line">                        <span class="attr">filePath</span>: a.<span class="property">fileUrl</span>,</span><br><span class="line">                        <span class="attr">batchNo</span>: a.<span class="property">batchNo</span>,</span><br><span class="line">                      &#125;),</span><br><span class="line">                      wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;filePath&quot;</span>, a.<span class="property">fileUrl</span>),</span><br><span class="line">                      wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&quot;上传成功&quot;</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                      &#125;))</span><br><span class="line">                    : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&quot;上传失败&quot;</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                        <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                      &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;网络异常&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&quot;照片拍摄失败&quot;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">      wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;未在指定区域&quot;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">sdrunEndPunchCard</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="variable language_">this</span>,</span><br><span class="line">      a = &#123;&#125;;</span><br><span class="line">    (a.<span class="property">openid</span> = o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>),</span><br><span class="line">      (a.<span class="property">fileType</span> = <span class="number">1</span>),</span><br><span class="line">      (a.<span class="property">imageType</span> = <span class="number">5</span>),</span><br><span class="line">      (a.<span class="property">schoolId</span> = t.<span class="property">data</span>.<span class="property">schoolId</span>);</span><br><span class="line">    <span class="keyword">var</span> n = e.<span class="title function_">sortKey</span>(a, o.<span class="property">globalData</span>.<span class="property">datakey</span>),</span><br><span class="line">      r = i.<span class="title function_">hexMD5</span>(n);</span><br><span class="line">    wx.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">sizeType</span>: [<span class="string">&quot;compressed&quot;</span>],</span><br><span class="line">      <span class="attr">sourceType</span>: [<span class="string">&quot;camera&quot;</span>],</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = e.<span class="property">tempFilePaths</span>[<span class="number">0</span>];</span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">          <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">          wx.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: o.<span class="property">globalData</span>.<span class="property">apiurl</span> + <span class="string">&quot;f/api/uploadFile&quot;</span>,</span><br><span class="line">            <span class="attr">filePath</span>: a,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;fileImg&quot;</span>,</span><br><span class="line">            <span class="attr">header</span>: &#123;</span><br><span class="line">              <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">formData</span>: &#123;</span><br><span class="line">              <span class="attr">openid</span>: o.<span class="property">globalData</span>.<span class="property">userStatus</span>.<span class="property">openid</span>,</span><br><span class="line">              <span class="attr">fileType</span>: <span class="number">1</span>,</span><br><span class="line">              <span class="attr">imageType</span>: <span class="number">5</span>,</span><br><span class="line">              <span class="attr">batchNo</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">              <span class="attr">sign</span>: r,</span><br><span class="line">              <span class="attr">detailId</span>: t.<span class="property">data</span>.<span class="property">detailId</span>,</span><br><span class="line">              <span class="attr">uploadImagetype</span>: <span class="number">3</span>,</span><br><span class="line">              <span class="attr">schoolId</span>: t.<span class="property">data</span>.<span class="property">schoolId</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> ((wx.<span class="title function_">hideLoading</span>(), <span class="number">200</span> != e.<span class="property">statusCode</span>))</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                  <span class="attr">title</span>: <span class="string">&quot;人数过多请稍后重试，服务器异常uploadFile500&quot;</span>,</span><br><span class="line">                  <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">              <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> a = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(e.<span class="property">data</span>);</span><br><span class="line">                <span class="string">&quot;000000&quot;</span> == a.<span class="property">retcode</span></span><br><span class="line">                  ? (t.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                      <span class="attr">fileName</span>: a.<span class="property">fileName</span>,</span><br><span class="line">                      <span class="attr">filePath</span>: a.<span class="property">fileUrl</span>,</span><br><span class="line">                      <span class="attr">batchNo</span>: a.<span class="property">batchNo</span>,</span><br><span class="line">                    &#125;),</span><br><span class="line">                    wx.<span class="title function_">setStorageSync</span>(<span class="string">&quot;filePath&quot;</span>, a.<span class="property">fileUrl</span>),</span><br><span class="line">                    wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                      <span class="attr">title</span>: <span class="string">&quot;上传成功&quot;</span>,</span><br><span class="line">                      <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                      <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                      <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                    &#125;))</span><br><span class="line">                  : wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                      <span class="attr">title</span>: <span class="string">&quot;上传失败&quot;</span>,</span><br><span class="line">                      <span class="attr">icon</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">                      <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">                      <span class="attr">mask</span>: !<span class="number">0</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">              wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;网络异常&quot;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">                <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&quot;照片拍摄失败&quot;</span>,</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1e3</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-修改pagas-index-paobu-wxml"><a href="#10-修改pagas-index-paobu-wxml" class="headerlink" title="10.修改pagas&#x2F;index&#x2F;paobu.wxml"></a>10.修改pagas&#x2F;index&#x2F;paobu.wxml</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">daojishi</span> <span class="attr">id</span>=<span class="string">&quot;daojishi&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;isdaojishi&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">daojishi</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav-bar</span> <span class="attr">navbarData</span>=<span class="string">&quot;&#123;&#123;navbarData&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav-bar</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top:&#123;&#123;navheight&#125;&#125;px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span> <span class="attr">class</span>=<span class="string">&quot;map&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myMap&quot;</span> <span class="attr">latitude</span>=<span class="string">&quot;&#123;&#123;initlatitude&#125;&#125;&quot;</span> <span class="attr">layerStyle</span>=<span class="string">&quot;&#123;&#123;layerstyle&#125;&#125;&quot;</span> <span class="attr">longitude</span>=<span class="string">&quot;&#123;&#123;initlongitude&#125;&#125;&quot;</span> <span class="attr">mapStyleId</span>=<span class="string">&quot;style1&quot;</span> <span class="attr">markers</span>=<span class="string">&quot;&#123;&#123;markers&#125;&#125;&quot;</span> <span class="attr">polyline</span>=<span class="string">&quot;&#123;&#123;polylines&#125;&#125;&quot;</span> <span class="attr">showLocation</span>=<span class="string">&quot;true&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%;height:&#123;&#123;screenHeight-navheight&#125;&#125;px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-1&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;label1&quot;</span>&gt;</span>&#123;&#123;fakemeil&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;cover-view class=&quot;label1&quot;&gt;&#123;&#123;meters&#125;&#125;&lt;/cover-view&gt; --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;label1-km&quot;</span>&gt;</span>km<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-box&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:left;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-head&quot;</span>&gt;</span>&#123;&#123;fakemeil&gt;0?av_speed:&#x27;0\&#x27;00&#x27;&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-end&quot;</span>&gt;</span>平均配速<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-box&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:left;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-head&quot;</span>&gt;</span>&#123;&#123;time&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-end&quot;</span>&gt;</span>运动时间<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-box&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runType==4&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-head&quot;</span>&gt;</span>&#123;&#123;punchCardNum&#125;&#125;/&#123;&#123;punchCardSum&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-end&quot;</span>&gt;</span>已打卡/需打卡<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-box&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runType==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-head&quot;</span>&gt;</span>&#123;&#123;punchCardNum&#125;&#125;/&#123;&#123;punchCardSum&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-end&quot;</span>&gt;</span>已打卡/需打卡<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-box&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runType==2&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-head&quot;</span>&gt;</span>&#123;&#123;cal&#125;&#125;<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;top-view-end&quot;</span>&gt;</span>热量（千卡）<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;rule-bg&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;rule&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;rule-test&quot;</span>&gt;</span>有效成绩：目标里程&#123;&#123;mileageTarget&#125;&#125;公里；平均配速&#123;&#123;minTime&#125;&#125;~&#123;&#123;maxTime&#125;&#125;分钟/公里；<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;sdrunPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sdqd&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runCheckStatus==1&amp;&amp;uploadType==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;sdqd-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/sdqd.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;sdrunEndPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sdqd&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runCheckStatus==1&amp;&amp;uploadType==2&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;sdqd-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/sdqd.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;sdrunPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sdqd-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runCheckStatus==1&amp;&amp;uploadType==1&#125;&#125;&quot;</span>&gt;</span> 上传照片 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;sdrunEndPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sdqd-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runCheckStatus==1&amp;&amp;uploadType==2&#125;&#125;&quot;</span>&gt;</span> 上传照片 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;stopNoRun&quot;</span> <span class="attr">class</span>=<span class="string">&quot;onstoprun&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;startType&gt;1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;onstoprun-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/stoprun.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;stopNoRun&quot;</span> <span class="attr">class</span>=<span class="string">&quot;onstoprun-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;startType&gt;1&#125;&#125;&quot;</span>&gt;</span> 强制结束 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;getPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ondevice&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;suspendStatus==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;ondevice-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/refreshqy.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;getPunchCard&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ondevice-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;suspendStatus==1&#125;&#125;&quot;</span>&gt;</span> 更新打卡 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;offyesQuyu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;!offyesqy&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/refreshqy.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;offyesQuyu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;offyesqy&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/stopqy.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;offyesQuyu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;!offyesqy&#125;&#125;&quot;</span>&gt;</span> 地图锁定 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;offyesQuyu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;offyesqy-text&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;offyesqy&#125;&#125;&quot;</span>&gt;</span> 地图滑动 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;fromtoMap&quot;</span> <span class="attr">class</span>=<span class="string">&quot;onlonlat&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">class</span>=<span class="string">&quot;onlonlat-img&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/z_wz.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bindtap</span>=<span class="string">&quot;fromtoMap&quot;</span> <span class="attr">class</span>=<span class="string">&quot;onlonlat-text&quot;</span>&gt;</span> 当前位置 <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;pb-btn-vew&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bind:longpress</span>=<span class="string">&quot;endRunShowBox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-end&quot;</span> <span class="attr">hoverClass</span>=<span class="string">&quot;btn-end2&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;suspendStatus==0&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;ctxt&quot;</span>&gt;</span>长按<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span>结束 <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;endicon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bind:longpress</span>=<span class="string">&quot;endRunShowBox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-endstop&quot;</span> <span class="attr">hoverClass</span>=<span class="string">&quot;btn-end2&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;suspendStatus==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;ctxt&quot;</span>&gt;</span>长按<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span>结束 <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;endicon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bind:longpress</span>=<span class="string">&quot;recoveryRunBtn&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-stop&quot;</span> <span class="attr">hoverClass</span>=<span class="string">&quot;btn-end2&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runstatus==1&amp;&amp;suspendStatus==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;ctxt&quot;</span>&gt;</span>长按<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span>继续 <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;zticon&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">src</span>=<span class="string">&quot;/images/start.png&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:40rpx;height:40rpx;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">bind:longpress</span>=<span class="string">&quot;suspendRunBtn&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-stop&quot;</span> <span class="attr">hoverClass</span>=<span class="string">&quot;btn-end2&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;runstatus==0&amp;&amp;suspendStatus==1&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;ctxt&quot;</span>&gt;</span>长按<span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span>暂停 <span class="tag">&lt;<span class="name">cover-view</span> <span class="attr">class</span>=<span class="string">&quot;zticon&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cover-image</span> <span class="attr">src</span>=<span class="string">&quot;/images/stop.png&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:40rpx;height:40rpx;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">cover-image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">cover-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alertview</span> <span class="attr">bind:cancelEvent</span>=<span class="string">&quot;cancelEvent&quot;</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;endRun&quot;</span> <span class="attr">cancelText</span>=<span class="string">&quot;继续跑&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;结束&quot;</span> <span class="attr">content</span>=<span class="string">&quot;&#123;&#123;endcontent&#125;&#125;&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;&#123;&#123;endcontent1&#125;&#125;&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;&#123;&#123;endcontent2&#125;&#125;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;endalertview&quot;</span> <span class="attr">title</span>=<span class="string">&quot;提 示&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">alertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alertview</span> <span class="attr">bind:cancelEvent</span>=<span class="string">&quot;cancelNoEvent&quot;</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;endNoRun&quot;</span> <span class="attr">cancelText</span>=<span class="string">&quot;继续跑&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;结束&quot;</span> <span class="attr">content</span>=<span class="string">&quot;强制结束将&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;无效&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;此次记录。您确定要结束吗？&quot;</span> <span class="attr">id</span>=<span class="string">&quot;endnoalertview&quot;</span> <span class="attr">title</span>=<span class="string">&quot;提 示&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">alertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inselectalertview</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;closeToindex&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;回到首页&quot;</span> <span class="attr">content</span>=<span class="string">&quot;获取位置信息异常！开始跑步失败。&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;此次运动数据将视为无效。&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;请点击回到首页按钮，检查GPS开启后，重新开始跑步&quot;</span> <span class="attr">id</span>=<span class="string">&quot;errorrun&quot;</span> <span class="attr">title</span>=<span class="string">&quot;警 告&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inselectalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inselectalertview</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;closeToindex&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;回到首页&quot;</span> <span class="attr">content</span>=<span class="string">&quot;网络异常！开始跑步失败。&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;此次运动数据将视为无效。&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;请点击回到首页按钮，检查网络开启后，重新开始跑步&quot;</span> <span class="attr">id</span>=<span class="string">&quot;wlerrorrun&quot;</span> <span class="attr">title</span>=<span class="string">&quot;警 告&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inselectalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inselectalertview</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;closeToindex&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;回到首页&quot;</span> <span class="attr">content</span>=<span class="string">&quot;已完成单日规定的跑步次数！开始跑步失败。&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;此次运动数据将视为无效。&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;请点击回到首页按钮，明日再来跑步&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cserrorrun&quot;</span> <span class="attr">title</span>=<span class="string">&quot;警 告&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inselectalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inselectalertview</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;closeToindex&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;回到首页&quot;</span> <span class="attr">content</span>=<span class="string">&quot;未在规定的跑步时间范围内！开始跑步失败。&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;此次运动数据将视为无效。&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;请点击回到首页按钮，在指定时间跑步&quot;</span> <span class="attr">id</span>=<span class="string">&quot;timeerrorrun&quot;</span> <span class="attr">title</span>=<span class="string">&quot;警 告&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inselectalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inselectalertview</span> <span class="attr">bind:confirmEvent</span>=<span class="string">&quot;closeToindex&quot;</span> <span class="attr">confirmText</span>=<span class="string">&quot;回到首页&quot;</span> <span class="attr">content</span>=<span class="string">&quot;启动跑步异常！上传跑步数据失败。&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;此次运动数据将视为无效。&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;请点击回到首页按钮，重新开始跑步&quot;</span> <span class="attr">id</span>=<span class="string">&quot;erroruploading&quot;</span> <span class="attr">title</span>=<span class="string">&quot;警 告&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inselectalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inalertview</span> <span class="attr">bind:cancelEvent</span>=<span class="string">&quot;closeEvent2&quot;</span> <span class="attr">bind:closeEvent</span>=<span class="string">&quot;closeEvent2&quot;</span> <span class="attr">cancelText</span>=<span class="string">&quot;已设置&quot;</span> <span class="attr">content</span>=<span class="string">&quot;无法获取位置信息，为了更精准的定位，请打开&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;GPS&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;功能并确保已获取小程序定位授权&quot;</span> <span class="attr">id</span>=<span class="string">&quot;gpsalertview&quot;</span> <span class="attr">title</span>=<span class="string">&quot;提 示&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inalertview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inalertview</span> <span class="attr">bind:cancelEvent</span>=<span class="string">&quot;closeBlueEvent&quot;</span> <span class="attr">bind:closeEvent</span>=<span class="string">&quot;closeBlueEvent&quot;</span> <span class="attr">cancelText</span>=<span class="string">&quot;已设置&quot;</span> <span class="attr">content</span>=<span class="string">&quot;请开启您的手机&quot;</span> <span class="attr">content1</span>=<span class="string">&quot;蓝牙&quot;</span> <span class="attr">content2</span>=<span class="string">&quot;功能才能运动&quot;</span> <span class="attr">id</span>=<span class="string">&quot;blueView&quot;</span> <span class="attr">title</span>=<span class="string">&quot;提 示&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">inalertview</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>1.结算窗口显示距离为0，这只是显示错误，不影响结算。<br>2.打开程序后会浮现一个小黑框提示网络错误，但几秒后会消失，不影响。<br>3.只能在学校规定的时间内跑步，后端限制死了，做不到随时开始</p>
<h1 id="完成！！"><a href="#完成！！" class="headerlink" title="完成！！"></a>完成！！</h1><p>接下来点击微信开发者工具中上部的”真机调试“按钮，手机微信扫码，就可以随地开始跑步了😊</p>
<p>但是会注意到只有通过扫“真机调试”的码进入程序才能正常运行，直接打开是会显示网络错误。要解决问题，只需要在直接打开后点击小程序右上角的三点，在上拉菜单里选择开发调试（最后一行最后一个），然后选择“打开调试”，小程序会自动重启，之后就可以正常运行了。</p>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>微信小程序</tag>
        <tag>破解</tag>
      </tags>
  </entry>
  <entry>
    <title>vscode配置vim&amp;&amp;vim的快捷键</title>
    <url>/post/forAll/vim-in-vscode/</url>
    <content><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>💡 在组长的推荐下尝试了一把vim，一开始点进<a href="https://www.runoob.com/linux/linux-vim.html">Linux vi&#x2F;vim | 菜鸟教程 (runoob.com)</a>入门时，看着键盘图看得头皮发麻，各种快捷键用的速度还不如鼠标老老实实一下一下点击，但用了两个星期以后大呼过瘾，甚至觉得这个教程里快捷键有些不够，便去找了一下官方文档，</p>
<h2 id="vscode配置vim："><a href="#vscode配置vim：" class="headerlink" title="vscode配置vim："></a>vscode配置vim：</h2><p>配置过程分两步</p>
<p>1.在vscode的插件市场中下载vim插件</p>
<p><img src="https://img-blog.csdnimg.cn/2e8a3c545a224c0d83be4d3bda485c85.png#pic_center" alt="Untitled"></p>
<p>2.在头部导航栏中点击文件，按 文件&#x2F;首选项&#x2F;设置 的顺序来到设置页，然后拖动滚动条跑到页面最底部，点击 ‘在settings.json中编辑’</p>
<p>3.在settings.json最外部的{}中的最后一个元素后加上以下代码，然后保存，则完成配置，可以使用了。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;vim.easymotion&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.incsearch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.useSystemClipboard&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.useCtrlKeys&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.hlsearch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.insertModeKeyBindings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;j&quot;</span><span class="punctuation">,</span> <span class="string">&quot;j&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;after&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;Esc&gt;&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.normalModeKeyBindingsNonRecursive&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;leader&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;d&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;after&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;d&quot;</span><span class="punctuation">,</span> <span class="string">&quot;d&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;C-n&gt;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;:nohl&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;K&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;lineBreakInsert&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;silent&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.leader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;space&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vim.handleKeys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;&lt;C-a&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;&lt;C-f&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;&lt;C-c&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue.splitEditors.layout.left&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;script&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;scriptSetup&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;styles&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h2 id="vim快捷键"><a href="#vim快捷键" class="headerlink" title="vim快捷键"></a>vim快捷键</h2><p>以下内容为<a href="https://www.runoob.com/linux/linux-vim.html">Linux vi&#x2F;vim | 菜鸟教程 (runoob.com)</a>没有讲到，而我看官方文档后觉得比较常用的快捷键。新手入门还请先从菜鸟教程学习基础。</p>
<p><strong>标记与跳转</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>m{a-zA-Z}</td>
<td>mark current position with mark {a-zA-Z}</td>
</tr>
<tr>
<td>&#96;{a-z}</td>
<td>go to mark {a-z} within current file</td>
</tr>
<tr>
<td>‘.</td>
<td>go to the position of the last change in this file</td>
</tr>
<tr>
<td>‘“</td>
<td>go to the position when last editing this file</td>
</tr>
<tr>
<td>:marks</td>
<td>print the active marks</td>
</tr>
<tr>
<td>🔢 %</td>
<td>goto line N percentage down in the file; N must be given, otherwise it is the % command</td>
</tr>
</tbody></table>
<p><strong>查找</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>search forward for the identifier under the cursor</td>
</tr>
<tr>
<td>g*</td>
<td>like “*”, but also find partial matches</td>
</tr>
<tr>
<td>gd</td>
<td>goto local declaration of identifier under the cursor</td>
</tr>
<tr>
<td>gD</td>
<td>goto global declaration of identifier under the cursor</td>
</tr>
</tbody></table>
<p><strong>光标移动</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>%</td>
<td>find the next brace, bracket, comment, or “#if”&#x2F; “#else”&#x2F;“#endif” in this line and go to its match</td>
</tr>
<tr>
<td>‘&gt;</td>
<td>go to the end of the (previous) Visual area</td>
</tr>
<tr>
<td>‘&lt;</td>
<td>go to the start of the (previous) Visual area</td>
</tr>
<tr>
<td>f{char}</td>
<td>to the Nth occurrence of {char} to the right</td>
</tr>
<tr>
<td>F{char}</td>
<td>to the Nth occurrence of {char} to the left</td>
</tr>
<tr>
<td>t{char}</td>
<td>till before the Nth occurrence of {char} to the right</td>
</tr>
<tr>
<td>T{char}</td>
<td>till before the Nth occurrence of {char} to the left</td>
</tr>
</tbody></table>
<p><strong>普通模式的插入</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>K</td>
<td>上方插入一空行而不进入输入模式</td>
</tr>
<tr>
<td>cc</td>
<td>删除该行至行首且切换为输入模式</td>
</tr>
</tbody></table>
<p><strong>控制滚动条</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>🔢 CTRL-E</td>
<td>window N lines downwards (default: 1)</td>
</tr>
<tr>
<td>🔢 CTRL-Y</td>
<td>window N lines upwards (default: 1)</td>
</tr>
<tr>
<td>🔢 CTRL-D</td>
<td>window N lines Downwards (default: 1&#x2F;2 window)</td>
</tr>
<tr>
<td>🔢 CTRL-U</td>
<td>window N lines Upwards (default: 1&#x2F;2 window)</td>
</tr>
<tr>
<td>zt</td>
<td>redraw, current line at top of window</td>
</tr>
<tr>
<td>z. or zz</td>
<td>redraw, current line at center of window</td>
</tr>
<tr>
<td>zb</td>
<td>redraw, current line at bottom of window</td>
</tr>
<tr>
<td>🔢 zh</td>
<td>scroll screen N characters to the right</td>
</tr>
<tr>
<td>🔢 zl</td>
<td>scroll screen N characters to the left</td>
</tr>
<tr>
<td>🔢 zH</td>
<td>scroll screen half a screenwidth to the right</td>
</tr>
<tr>
<td>🔢 zL</td>
<td>scroll screen half a screenwidth to the left</td>
</tr>
</tbody></table>
<p><strong>视图模式（ CTRL-V ）命令</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>aw</td>
<td>Select a word(不包括符号)</td>
</tr>
<tr>
<td>aW</td>
<td>Select a word(包括符号)</td>
</tr>
<tr>
<td>ap</td>
<td>Select “a paragraph”(上下两个空行之间，)</td>
</tr>
<tr>
<td>a[]&lt;&gt;’’{}””</td>
<td>选择对应的一整个块</td>
</tr>
<tr>
<td>i[]&lt;&gt;’’{}””</td>
<td>选择块中的内容</td>
</tr>
<tr>
<td>at</td>
<td>Select “a tag block”</td>
</tr>
<tr>
<td>it</td>
<td>Select “inner tag block” (from <aaa> to </aaa>)</td>
</tr>
<tr>
<td>I</td>
<td>insert the same text in front of all the selected lines</td>
</tr>
<tr>
<td>A</td>
<td>append the same text after all the selected lines</td>
</tr>
<tr>
<td>c</td>
<td>Change each of the selected lines with the entered text</td>
</tr>
</tbody></table>
<p><strong>插入模式（ii）命令</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>CTRL-W</td>
<td>delete word before the cursor</td>
</tr>
<tr>
<td>CTRL-E</td>
<td>insert the character from below the cursor</td>
</tr>
<tr>
<td>CTRL-Y</td>
<td>insert the character from above the cursor</td>
</tr>
<tr>
<td>CTRL-A</td>
<td>inser previously inserted text</td>
</tr>
<tr>
<td>CTRL-@</td>
<td>insert previously inserted text and stop Insert mode</td>
</tr>
<tr>
<td>CTRL-U</td>
<td>delete all entered characters in the current line before the cursor</td>
</tr>
</tbody></table>
<p><strong>普通模式的命令</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>q{a-Z}</td>
<td>record typed characters into register {a-z}</td>
</tr>
<tr>
<td>q</td>
<td>stop recording</td>
</tr>
<tr>
<td>🔢 @{a-z}</td>
<td>execute the contents of register {a-z} (N times)</td>
</tr>
<tr>
<td>🔢 @@</td>
<td>repeat previous @{a-z} (N times)</td>
</tr>
<tr>
<td>“{char}</td>
<td>use register {char} for the next delete, yank, or put</td>
</tr>
<tr>
<td>“*</td>
<td>use register * to access system clipboard</td>
</tr>
<tr>
<td>:reg</td>
<td>show the contents of all registers</td>
</tr>
<tr>
<td>:reg {arg}</td>
<td>show the contents of registers mentioned in {arg}</td>
</tr>
</tbody></table>
<p><strong>基本命令</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>gp</td>
<td>like p, but leave cursor after the new text</td>
</tr>
<tr>
<td>🔢 CTRL-A</td>
<td>add N to the number at or after the cursor</td>
</tr>
<tr>
<td>🔢 CTRL-X</td>
<td>subtract N from the number at or after the cursor</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>综合</category>
      </categories>
      <tags>
        <tag>vim</tag>
        <tag>VScode</tag>
      </tags>
  </entry>
  <entry>
    <title>快捷键篇</title>
    <url>/post/forAll/%E5%BF%AB%E6%8D%B7%E9%94%AE%E7%AF%87/</url>
    <content><![CDATA[<blockquote>
<p>vim这东西真奇妙，刚上手时觉得巨难用，可一旦习惯后就变得无法忍受没有vim的编辑器了，而且让人干编辑以外的事情也都想用快捷键了。于是专门拿出一段时间学习了一下各种常用的快捷键。随着使用的程序越来越多，此篇博客也会持续更新</p>
</blockquote>
<h1 id="电脑自带"><a href="#电脑自带" class="headerlink" title="电脑自带"></a>电脑自带</h1><h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><table>
<thead>
<tr>
<th>键位</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>win + e</td>
<td>打开文件资源管理器</td>
</tr>
<tr>
<td>ctrl + shift + N</td>
<td>新建文件夹</td>
</tr>
<tr>
<td>shift + Delete</td>
<td>不进入回收站，直接删除</td>
</tr>
<tr>
<td>Alt + Enter</td>
<td>查看文件属性</td>
</tr>
<tr>
<td>backspace</td>
<td>查看上级目录</td>
</tr>
</tbody></table>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="实用操作"><a href="#实用操作" class="headerlink" title="实用操作"></a>实用操作</h3><table>
<thead>
<tr>
<th>键位</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>win + d</td>
<td>快速进入桌面&#x2F;还原</td>
</tr>
<tr>
<td>win + i</td>
<td>打开设置界面</td>
</tr>
<tr>
<td>win + L</td>
<td>锁屏</td>
</tr>
<tr>
<td>win + v</td>
<td>打开粘贴板历史</td>
</tr>
<tr>
<td>ctrl + n</td>
<td>创建同级界面</td>
</tr>
<tr>
<td>ctrl + w</td>
<td>关闭当前界面</td>
</tr>
<tr>
<td>ctrl + shift + Esc</td>
<td>打开任务管理器</td>
</tr>
<tr>
<td>ctrl+tab</td>
<td>向前遍历标签</td>
</tr>
<tr>
<td>ctrl+shift+tab</td>
<td>向后遍历标签</td>
</tr>
<tr>
<td>alt + 空格</td>
<td>显示窗口控制菜单</td>
</tr>
<tr>
<td>win + n</td>
<td>日历</td>
</tr>
<tr>
<td>win + ctrl + q</td>
<td>打开快速助手</td>
</tr>
<tr>
<td>win + shift + s</td>
<td>截图</td>
</tr>
<tr>
<td>win + x</td>
<td>打开电脑管理选项</td>
</tr>
<tr>
<td>win + z</td>
<td>临时速览桌面</td>
</tr>
<tr>
<td>win + 上</td>
<td>最大化窗口</td>
</tr>
</tbody></table>
<h3 id="有趣操作"><a href="#有趣操作" class="headerlink" title="有趣操作"></a>有趣操作</h3><table>
<thead>
<tr>
<th>键位</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>win + .</td>
<td>微软表情</td>
</tr>
<tr>
<td>win + s</td>
<td>搜索程序</td>
</tr>
<tr>
<td>win + 方向键</td>
<td>电脑分屏</td>
</tr>
<tr>
<td>win + h</td>
<td>启动语音输入</td>
</tr>
</tbody></table>
<h3 id="不常用但有用操作"><a href="#不常用但有用操作" class="headerlink" title="不常用但有用操作"></a>不常用但有用操作</h3><table>
<thead>
<tr>
<th>键位</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>win + A</td>
<td>打开快速设置</td>
</tr>
<tr>
<td>win + B + 回车</td>
<td>显示任务栏</td>
</tr>
<tr>
<td>win + 方向键</td>
<td>电脑分屏</td>
</tr>
</tbody></table>
<h1 id="浏览器（Edge）"><a href="#浏览器（Edge）" class="headerlink" title="浏览器（Edge）"></a>浏览器（Edge）</h1><table>
<thead>
<tr>
<th>键位</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>ctrl+t</td>
<td>打开新的标签页</td>
</tr>
<tr>
<td>ctrl+shift+t</td>
<td>恢复被关闭的网页</td>
</tr>
<tr>
<td>ctrl+shift+o</td>
<td>打开收藏夹</td>
</tr>
<tr>
<td>ctrl+h</td>
<td>打开历史</td>
</tr>
<tr>
<td>alt+d</td>
<td>编辑地址栏</td>
</tr>
<tr>
<td>alt+f</td>
<td>打开菜单</td>
</tr>
<tr>
<td>ctrl+j</td>
<td>打开下载栏</td>
</tr>
<tr>
<td>ctrl+shift+k</td>
<td>复制当前标签页</td>
</tr>
<tr>
<td>ctrl+r</td>
<td>带缓存刷新</td>
</tr>
<tr>
<td>ctrl+shift+r</td>
<td>忽略缓存刷新</td>
</tr>
<tr>
<td>ctrl+shift+w</td>
<td>关闭当前窗口</td>
</tr>
<tr>
<td>ctrl+w</td>
<td>关闭当前标签</td>
</tr>
<tr>
<td>ctrl+1..8</td>
<td>切换到第n个标签</td>
</tr>
<tr>
<td>ctrl+9</td>
<td>切换到最后一个标签</td>
</tr>
<tr>
<td>ctrl+shift+n</td>
<td>打开隐私搜索窗口</td>
</tr>
<tr>
<td>ctrl + d</td>
<td>将当前标签添加到收藏夹</td>
</tr>
<tr>
<td>ctrl+shift+e</td>
<td>边栏打开搜索</td>
</tr>
<tr>
<td>ctrl+e</td>
<td>地址栏打开搜索</td>
</tr>
<tr>
<td>ctrl+shift+b</td>
<td>顶部显示收藏夹\隐藏</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>综合</category>
      </categories>
      <tags>
        <tag>快捷键</tag>
      </tags>
  </entry>
  <entry>
    <title>Excel宏的使用</title>
    <url>/post/other/Excel%E5%AE%8F%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<blockquote>
<p>需要对爬虫爬取的excel做处理，但自己手动处理确实太慢，突然想到了excel中还有个东西叫宏，就打算学一学</p>
</blockquote>
<h1 id="求助ai得到代码"><a href="#求助ai得到代码" class="headerlink" title="求助ai得到代码"></a>求助ai得到代码</h1><p>发现宏是通过编辑代码来进行编辑的，所以也先直接求助ai</p>
<blockquote>
<p>请为我编写我需要的宏的代码。我目标的工作的整个流程如下：<br>1.我会选中一块横向长度为1，竖向长度变化的区域。这块区域左侧是一系列数字。<br>2.执行宏<br>宏的作用如下：<br>1.将我选中的区域合并<br>2.将合并区域的内容设置为左侧一系列数字的和<br>如果你对此还有什么问题，请指出，如果没有问题，请为我编写代码</p>
</blockquote>
<p>ai回复</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sub MergeAndSum()</span><br><span class="line">    Dim selectedRange As Range</span><br><span class="line">    Dim sumValue As Double</span><br><span class="line">    </span><br><span class="line">    &#x27; 检查是否选择了单元格</span><br><span class="line">    If Selection.Cells.Count = 1 Then</span><br><span class="line">        MsgBox &quot;请先选择一个区域！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取当前选择的区域</span><br><span class="line">    Set selectedRange = Selection</span><br><span class="line">    </span><br><span class="line">    &#x27; 检查选择的区域是否有效</span><br><span class="line">    If selectedRange.Columns.Count &lt;&gt; 1 Then</span><br><span class="line">        MsgBox &quot;请选择一个横向长度为1的区域！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 初始化总和值</span><br><span class="line">    sumValue = 0</span><br><span class="line">    </span><br><span class="line">    &#x27; 遍历选择的区域，计算总和</span><br><span class="line">    For Each cell In selectedRange</span><br><span class="line">        If IsNumeric(cell.Value) Then</span><br><span class="line">            sumValue = sumValue + cell.Value</span><br><span class="line">        End If</span><br><span class="line">    Next cell</span><br><span class="line">    </span><br><span class="line">    &#x27; 合并选择的区域</span><br><span class="line">    selectedRange.Merge</span><br><span class="line">    </span><br><span class="line">    &#x27; 设置合并区域的内容为总和值</span><br><span class="line">    selectedRange.Value = sumValue</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：wps运行的是js宏，要以上代码是vba宏，若要参考，请使用excel</p>
</blockquote>
<p>尝试运行了一下，果然不行，于是又开始修修改改，不过没想到只改了一次就行了。</p>
<p>最终代码是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sub MergeAndSumLeft()</span><br><span class="line">    Dim selectedRange As Range</span><br><span class="line">    Dim sumValue As Double</span><br><span class="line">    </span><br><span class="line">    &#x27; 检查是否选择了单元格</span><br><span class="line">    If Selection.Cells.Count = 1 Then</span><br><span class="line">        MsgBox &quot;请先选择一个区域！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取当前选择的区域</span><br><span class="line">    Set selectedRange = Selection</span><br><span class="line">    </span><br><span class="line">    &#x27; 检查选择的区域是否有效</span><br><span class="line">    If selectedRange.Columns.Count &lt;&gt; 1 Then</span><br><span class="line">        MsgBox &quot;请选择一个横向长度为1的区域！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 初始化总和值</span><br><span class="line">    sumValue = 0</span><br><span class="line">    </span><br><span class="line">    &#x27; 遍历选择的区域，计算总和</span><br><span class="line">    For Each cell In selectedRange</span><br><span class="line">        If IsNumeric(cell.Offset(0, -1).Value) Then</span><br><span class="line">            sumValue = sumValue + cell.Offset(0, -1).Value</span><br><span class="line">        End If</span><br><span class="line">    Next cell</span><br><span class="line">    </span><br><span class="line">    &#x27; 合并选择的区域</span><br><span class="line">    selectedRange.Merge</span><br><span class="line">    </span><br><span class="line">    &#x27; 设置合并区域的内容为左侧一系列数字的和</span><br><span class="line">    selectedRange.Value = sumValue</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h1 id="给宏绑定快捷键"><a href="#给宏绑定快捷键" class="headerlink" title="给宏绑定快捷键"></a>给宏绑定快捷键</h1><p>每运行一次宏都要在数个位置点来点去，很麻烦，因此想着给宏绑定一下快捷键。</p>
<p>参照链接：</p>
<p><a href="https://jingyan.baidu.com/article/d8072ac4abeddeec95cefd0d.html">在Excel中如何使用快捷键运行宏-百度经验 (baidu.com)</a></p>
<h1 id="将宏设置到全局"><a href="#将宏设置到全局" class="headerlink" title="将宏设置到全局"></a>将宏设置到全局</h1><p>上面那种方法设置的宏只能在输入了相关代码的文件中才可用，但我需要处理的是一系列的文件，因此需要将宏设置到全局。</p>
<p>参考这篇：<a href="https://blog.csdn.net/qq_49195366/article/details/130054885?ops_request_misc=&request_id=&biz_id=102&utm_term=excel%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%AE%8F&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-130054885.142%5Ev94%5EchatsearchT3_1&spm=1018.2226.3001.4187">如何使用Excel自定义函数并且全局使用_excel自定义函数怎么共用_coderyeah的博客-CSDN博客</a></p>
<p>主要过程即为在一个xlsx文件中编辑宏后，保存为xlam格式（c:&#x2F;用户&#x2F;主用户&#x2F;AppData&#x2F;Roaming&#x2F;Microsoft&#x2F;AddIns 目录下，系统默认保存地点就是这里）。之后在“开发者工具”→ “excel加载项” 中勾选对应栏。</p>
<h1 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h1><h2 id="代码基础"><a href="#代码基础" class="headerlink" title="代码基础"></a>代码基础</h2><h3 id="不同类型的变量的声明"><a href="#不同类型的变量的声明" class="headerlink" title="不同类型的变量的声明"></a>不同类型的变量的声明</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; sheet页</span><br><span class="line">Dim ws As Worksheet</span><br><span class="line">&#x27; 设置要操作的工作表</span><br><span class="line">Set ws = ActiveSheet</span><br><span class="line"></span><br><span class="line">&#x27; 数字</span><br><span class="line">Dim i As Long</span><br><span class="line">i = 1</span><br><span class="line"></span><br><span class="line">&#x27; 区域，一个或多个连续的单元格</span><br><span class="line">Dim rng As Range</span><br><span class="line">&#x27; 定义Ai到A5的区域为rng</span><br><span class="line">Set rng = ws.Range(&quot;A&quot; &amp; i &amp; &quot;:A&quot; &amp; 5)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="IF"><a href="#IF" class="headerlink" title="IF"></a>IF</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">If 条件 Then</span><br><span class="line">    &#x27; 如果条件为真时执行的代码</span><br><span class="line">ElseIf 条件2 Then</span><br><span class="line">    &#x27; 如果条件2为真时执行的代码</span><br><span class="line">Else</span><br><span class="line">    &#x27; 如果以上条件都不为真时执行的代码</span><br><span class="line">End If</span><br><span class="line"></span><br><span class="line">&#x27; 例子</span><br><span class="line">Sub ExampleIfStatement()</span><br><span class="line">    Dim num As Integer</span><br><span class="line">    num = 10</span><br><span class="line">    </span><br><span class="line">    &#x27; 简单的If语句</span><br><span class="line">    If num &gt; 5 Then</span><br><span class="line">        MsgBox &quot;数字大于5&quot;</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 带有Else的If语句</span><br><span class="line">    If num &gt; 15 Then</span><br><span class="line">        MsgBox &quot;数字大于15&quot;</span><br><span class="line">    Else</span><br><span class="line">        MsgBox &quot;数字不大于15&quot;</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 多个条件的If语句</span><br><span class="line">    If num &gt; 15 Then</span><br><span class="line">        MsgBox &quot;数字大于15&quot;</span><br><span class="line">    ElseIf num &gt; 10 Then</span><br><span class="line">        MsgBox &quot;数字大于10，但不大于15&quot;</span><br><span class="line">    Else</span><br><span class="line">        MsgBox &quot;数字不大于10&quot;</span><br><span class="line">    End If</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h3 id="For"><a href="#For" class="headerlink" title="For"></a>For</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; For...Next 循环：</span><br><span class="line">&#x27; 用于指定循环次数，通常用于处理数字的范围。它的基本结构如下：</span><br><span class="line"></span><br><span class="line">For [变量] = 初始值 To 终止值 </span><br><span class="line">     循环代码</span><br><span class="line">Next [变量]</span><br><span class="line"></span><br><span class="line">示例:</span><br><span class="line"></span><br><span class="line">Sub ForLoopExample()</span><br><span class="line">    Dim total As Integer</span><br><span class="line">    total = 0</span><br><span class="line">    </span><br><span class="line">    For i = 1 To 10</span><br><span class="line">        total = total + i</span><br><span class="line">    Next i</span><br><span class="line">    </span><br><span class="line">    MsgBox &quot;总和为：&quot; &amp; total</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;-------------------------------------------------------------------&#x27;&#x27;</span><br><span class="line">For Each...Next 循环：</span><br><span class="line">用于循环遍历集合、数组或范围中的元素，而不需要指定循环次数。</span><br><span class="line"></span><br><span class="line">For Each [元素] In 集合</span><br><span class="line">    &#x27; 循环代码</span><br><span class="line">Next [元素]</span><br><span class="line"></span><br><span class="line">示例:</span><br><span class="line"></span><br><span class="line">Sub ForEachLoopExample()</span><br><span class="line">    Dim arr() As Integer</span><br><span class="line">    arr = Array(1, 2, 3, 4, 5)</span><br><span class="line">   </span><br><span class="line">    For Each num In arr</span><br><span class="line">        MsgBox &quot;元素的值为：&quot; &amp; num</span><br><span class="line">    Next num</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h2 id="获取对象"><a href="#获取对象" class="headerlink" title="获取对象"></a>获取对象</h2><h3 id="获取当前正在操作的工作表作为对象"><a href="#获取当前正在操作的工作表作为对象" class="headerlink" title="获取当前正在操作的工作表作为对象"></a>获取当前正在操作的工作表作为对象</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; 检查是否选择了工作表</span><br><span class="line">    If ActiveSheet Is Nothing Then</span><br><span class="line">        MsgBox &quot;请先选择一个工作表！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 设置要操作的工作表</span><br><span class="line">    Set ws = ActiveSheet</span><br></pre></td></tr></table></figure>

<h3 id="获取第n列最后一行的行号"><a href="#获取第n列最后一行的行号" class="headerlink" title="获取第n列最后一行的行号"></a>获取第n列最后一行的行号</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; 获取工作表中第n列最后一行的行号</span><br><span class="line">    lastRow = ws.Cells(ws.Rows.Count, n).End(xlUp).Row</span><br></pre></td></tr></table></figure>

<h2 id="excel操作"><a href="#excel操作" class="headerlink" title="excel操作"></a>excel操作</h2><h3 id="行列的插入与删除"><a href="#行列的插入与删除" class="headerlink" title="行列的插入与删除"></a>行列的插入与删除</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; 插入新列在第n列之前</span><br><span class="line">    Columns(n).Insert Shift:=xlToRight</span><br><span class="line">&#x27; 在第n行前插入一行</span><br><span class="line">    ws.Rows(n).Insert Shift:=xlShiftDown</span><br><span class="line">&#x27; 删除第n行</span><br><span class="line">    ws.Rows(n).Delete</span><br><span class="line">&#x27; 删除第n列</span><br><span class="line">		ws.Columns(n).Delete</span><br></pre></td></tr></table></figure>

<h3 id="合并与解散单元格"><a href="#合并与解散单元格" class="headerlink" title="合并与解散单元格"></a>合并与解散单元格</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; 设置合并区域,Ax为左上角，By为右下角</span><br><span class="line">    Set mergeRange = ws.Range(&quot;A&quot; &amp; x &amp; &quot;:B&quot; &amp; y)</span><br><span class="line">    mergeRange.Merge</span><br><span class="line">&#x27; 解除合并</span><br><span class="line">		mergedRange.UnMerge</span><br></pre></td></tr></table></figure>

<h1 id="常用宏示例"><a href="#常用宏示例" class="headerlink" title="常用宏示例"></a>常用宏示例</h1><h3 id="解开所有合并的单元格，然后删除页面中的空行"><a href="#解开所有合并的单元格，然后删除页面中的空行" class="headerlink" title="解开所有合并的单元格，然后删除页面中的空行"></a>解开所有合并的单元格，然后删除页面中的空行</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sub DeleteBlankRows()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim lastRow As Long</span><br><span class="line">    Dim i As Long</span><br><span class="line">    Dim rng As Range</span><br><span class="line">    &#x27; 检查是否选择了工作表</span><br><span class="line">    If ActiveSheet Is Nothing Then</span><br><span class="line">        MsgBox &quot;请先选择一个工作表！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 设置要操作的工作表</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line">    </span><br><span class="line">    &#x27; 取消合并所有单元格</span><br><span class="line">    On Error Resume Next &#x27; 忽略错误，以防某些单元格没有合并</span><br><span class="line">    Set mergedRange = ws.Cells</span><br><span class="line">    mergedRange.UnMerge</span><br><span class="line">    On Error GoTo 0 &#x27; 恢复错误处理</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取工作表中最后一行的行号</span><br><span class="line">    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</span><br><span class="line">    </span><br><span class="line">    &#x27; 循环遍历每一行，从最后一行向上查找空行并删除</span><br><span class="line">    For i = lastRow To 1 Step -1</span><br><span class="line">        If Application.WorksheetFunction.CountA(ws.Rows(i)) = 0 Then</span><br><span class="line">            &#x27; 如果行中没有非空单元格，则删除该行</span><br><span class="line">            ws.Rows(i).Delete</span><br><span class="line">        End If</span><br><span class="line">    Next i</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<h1 id="进阶示例"><a href="#进阶示例" class="headerlink" title="进阶示例"></a>进阶示例</h1><p>以下为一个vba宏代码的示例。作用的场景是一个第三列为数字，第四列为多个合并了的单元格的表格。作用是在第三列与第四列之间插入一个新列，新列的布局同原本的第四列，但内容是相邻的第三列数字的和</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sub test()</span><br><span class="line">    Dim ws As Worksheet</span><br><span class="line">    Dim lastRow As Long</span><br><span class="line">    Dim i As Long</span><br><span class="line">    Dim cell As Range</span><br><span class="line">    Dim mergeRange As Range</span><br><span class="line">    Dim sumRange As Range</span><br><span class="line">    Dim cellHeight As Long</span><br><span class="line">    Dim value As Long</span><br><span class="line">    </span><br><span class="line">    &#x27; 检查是否选择了工作表</span><br><span class="line">    If ActiveSheet Is Nothing Then</span><br><span class="line">        MsgBox &quot;请先选择一个工作表！&quot;, vbExclamation</span><br><span class="line">        Exit Sub</span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    &#x27; 设置要操作的工作表</span><br><span class="line">    Set ws = ActiveSheet</span><br><span class="line">    </span><br><span class="line">    &#x27; 获取工作表中最后一行的行号</span><br><span class="line">    lastRow = ws.Cells(ws.Rows.Count, 4).End(xlUp).Row</span><br><span class="line">    </span><br><span class="line">    &#x27; 插入新列在第四列之前</span><br><span class="line">    Columns(4).Insert Shift:=xlToRight</span><br><span class="line">    i = 1</span><br><span class="line">    For Each cell In ws.Range(&quot;E1:E&quot; &amp; lastRow)</span><br><span class="line">        If Not IsEmpty(cell) Then</span><br><span class="line">            &#x27; 如果第四列中有数据</span><br><span class="line">            If cell.MergeCells Then</span><br><span class="line">                &#x27; 如果单元格是合并单元格，获取合并单元格的长度</span><br><span class="line">                cellHeight = i + cell.MergeArea.Rows.Count - 1</span><br><span class="line">                &#x27; 合并新的单元格</span><br><span class="line">                Set mergeRange = ws.Range(&quot;D&quot; &amp; i &amp; &quot;:D&quot; &amp; cellHeight)</span><br><span class="line">                mergeRange.Merge</span><br><span class="line">                Set sumRange = ws.Range(&quot;C&quot; &amp; i &amp; &quot;:C&quot; &amp; cellHeight)</span><br><span class="line">                value = WorksheetFunction.Sum(sumRange)</span><br><span class="line">                mergeRange.value = value</span><br><span class="line">                i = cellHeight + 1</span><br><span class="line">            Else</span><br><span class="line">                Set mergeRange = Range(&quot;D&quot; &amp; i)</span><br><span class="line">                Set sumRange = Range(&quot;C&quot; &amp; i)</span><br><span class="line">                mergeRange.value = sumRange.value</span><br><span class="line">                i = i + 1</span><br><span class="line">            End If</span><br><span class="line">        End If</span><br><span class="line">    Next cell</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>Excel</tag>
        <tag>vba</tag>
      </tags>
  </entry>
  <entry>
    <title>对Linux的第一次尝试</title>
    <url>/post/linux/tryLinux/</url>
    <content><![CDATA[<blockquote>
<p>电脑上的VMware在大一入学前就安装好了，一直在硬盘里吃灰。想着大二前怎么也要用一用，于是抓住假期的尾巴，浅玩了一下linux</p>
</blockquote>
<h2 id="linux的安装"><a href="#linux的安装" class="headerlink" title="linux的安装"></a>linux的安装</h2><p>跟着这个教程成功于VMware上安装上了centos7</p>
<p><a href="https://blog.csdn.net/weixin_52799373/article/details/124324077">VMware虚拟机安装Linux教程(超详细)_vmware安装linux虚拟机_七维大脑的博客-CSDN博客</a></p>
<p>然后隔天早上网络还出了点问题，跟着这篇教程修复了</p>
<p><a href="https://blog.csdn.net/m0_55710969/article/details/121331849">Linux [Error]错误：激活连接失败：No suitable device found for this connection.无网络图标【已解决】_hah杨大仙的博客-CSDN博客</a></p>
<h2 id="工具的安装"><a href="#工具的安装" class="headerlink" title="工具的安装"></a>工具的安装</h2><h3 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h3><p><a href="https://blog.csdn.net/weixin_44657888/article/details/117200381">linux如何安装yum_linux安装yum命令步骤_一个懒鬼的博客-CSDN博客</a></p>
<p>yum的安装比较容易，跟着上面这个教程走，没出一点问题</p>
<h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><p><a href="https://blog.csdn.net/qq_38215042/article/details/108768839">Linux安装curl完整步骤_linux 安装 curl_itfallrain的博客-CSDN博客</a></p>
<p>curl的安装麻烦了很多，即使是跟着上面这个教程走，但还是出了很多问题</p>
<ul>
<li>报错无c的编译器：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#于是安装</span></span><br><span class="line">yum groupinstall <span class="string">&quot;Development Tools&quot;</span> </span><br></pre></td></tr></table></figure>

<ul>
<li>报错**<code>configure: error: select TLS backend(s) or disable TLS with --without-ssl.</code>**</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#经搜索得知,这个错误是由于在安装curl时没有指定TLS后端的原因。</span></span><br><span class="line"><span class="comment">#TLS是一种用于保护网络通信的协议，它需要一些库来支持，</span></span><br><span class="line"><span class="comment">#例如OpenSSL、wolfSSL等。</span></span><br><span class="line"><span class="comment">#如果没有安装这些库，或者没有告诉curl使用哪个库，就会出现这个错误。</span></span><br><span class="line"><span class="comment">#于是</span></span><br><span class="line">yum install openssl</span><br></pre></td></tr></table></figure>

<ul>
<li>安装好了openssl, 命令openssl也有正常输出，但是设置prefix时仍然报错<code>-with-openssl was given but OpenSSL could not be detected</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#根据下面这篇文章</span></span><br><span class="line">yum -y install openssl-devel</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/navida/article/details/48315243?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~OPENSEARCH~default-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~OPENSEARCH~default-1.no_search_link">configure: error: –with-ssl&#x3D;openssl was given, but SSL is not available._舟自横的博客-CSDN博客</a></p>
<p>然后就没遇到问题了，开始编译与安装make&amp;&amp;make install，再执行curl –version, 正常输出版本，安装成功。</p>
<h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><p><a href="https://zhuanlan.zhihu.com/p/452605751#:~:text=linux%E4%B8%8B%E5%AE%89%E8%A3%85git%201%201.%E4%B8%8B%E8%BD%BDgit%20%E5%9C%A8%20Git%20-%20Downloads%20%28git-scm.com%29,3%203.%E9%AA%8C%E8%AF%81%E7%89%88%E6%9C%AC%20git%20--version%204%204.make%E7%BC%96%E8%AF%91%E6%97%B6%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98%20%E9%97%AE%E9%A2%981%EF%BC%9A%20">linux下安装git - 知乎 (zhihu.com)</a></p>
<p>教程整体没什么问题，只是最后向&#x2F;ect&#x2F;profile 内添加内容的部分有些晦涩</p>
<p>如果是刚装好的linux，则末尾添加以下两句就可以了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> GIT_HOME=/usr/local/git</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GIT_HOME</span>/bin:</span><br></pre></td></tr></table></figure>

<p><code># source /etc/profile</code> 执行这句命令刷新资源依赖后，尝试git –version验证，确实正常出现了版本号。</p>
<p>但换个终端又出问题了，又无法正常启动，不过好在重启了一下虚拟机，又好了。应该是资源依赖的刷新只停留在执行命令的终端。</p>
<p>尝试连接github</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">#生成ssh钥</span><br><span class="line">ssh-keygen</span><br><span class="line">#控制台输出：</span><br><span class="line">#<span class="title class_">Your</span> public key has been saved <span class="keyword">in</span> /root/.<span class="property">ssh</span>/id_rsa.<span class="property">pub</span></span><br><span class="line">#于是输入命令</span><br><span class="line">vim /root/.<span class="property">ssh</span>/id_rsa.<span class="property">pub</span></span><br><span class="line">#复制文件里的内容，粘贴到github添加ssh钥位置</span><br><span class="line">#输入命令，检测连接情况</span><br><span class="line">ssh -T git@github.<span class="property">com</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>laTex的使用</title>
    <url>/post/other/use%20of%20laTex/</url>
    <content><![CDATA[<blockquote>
<p>被总监叫去一起写论文，因此需要学习一下latex的使用方法</p>
</blockquote>
<p>平台：<a href="https://www.overleaf.com/">overleaf</a></p>
<p>使用领域：攥写论文</p>
<h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125; <span class="comment">%开头，定义文档的类型为article</span></span><br><span class="line"><span class="keyword">\title</span>&#123;Sections and Chapters&#125; <span class="comment">%标题</span></span><br><span class="line"><span class="keyword">\author</span>&#123;Gubert Farnsworth&#125; <span class="comment">%作者</span></span><br><span class="line"><span class="keyword">\date</span>&#123;August 2022&#125; <span class="built_in">&amp;</span>日期</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125; <span class="comment">%开始文章主体</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">\maketitle</span> <span class="comment">%将标题、作者、日期设置为封面图</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">\tableofcontents</span> <span class="comment">%根据内容自动生成目录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125; <span class="comment">%第一部分</span></span><br><span class="line">   </span><br><span class="line">This is the first section.</span><br><span class="line">      </span><br><span class="line">Lorem  ipsum  dolor  sit  amet,  consectetuer  adipiscing  </span><br><span class="line">elit.   Etiam  lobortisfacilisis sem.  Nullam nec mi et </span><br><span class="line">neque pharetra sollicitudin.  Praesent imperdietmi nec ante. </span><br><span class="line">Donec ullamcorper, felis non sodales...</span><br><span class="line">       </span><br><span class="line"><span class="keyword">\section</span>*&#123;Unnumbered Section&#125; <span class="comment">%另外</span></span><br><span class="line"><span class="keyword">\addcontentsline</span>&#123;toc&#125;&#123;section&#125;&#123;Unnumbered Section&#125; <span class="comment">%不缩进文本</span></span><br><span class="line"></span><br><span class="line">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.  </span><br><span class="line">Etiam lobortis facilisissem.  Nullam nec mi et neque pharetra </span><br><span class="line">sollicitudin.  Praesent imperdiet mi necante...</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Second Section&#125; <span class="comment">%第二部分</span></span><br><span class="line">       </span><br><span class="line">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.  </span><br><span class="line">Etiam lobortis facilisissem.  Nullam nec mi et neque pharetra </span><br><span class="line">sollicitudin.  Praesent imperdiet mi necante...</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125; <span class="comment">%文档结束</span></span><br></pre></td></tr></table></figure>

<h2 id="文本标签介绍"><a href="#文本标签介绍" class="headerlink" title="文本标签介绍"></a>文本标签介绍</h2><table>
<thead>
<tr>
<th>标签名</th>
<th>解释</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>title</td>
<td>标题</td>
<td>\title{My first LaTeX document}</td>
</tr>
<tr>
<td>author</td>
<td>作者</td>
<td>\author{Hubert Farnsworth}</td>
</tr>
<tr>
<td>thanks</td>
<td>鸣谢，加在&#x2F;author中，在注释中显示</td>
<td>\author{Hubert Farnsworth\thanks{Funded by the Overleaf team.}}</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
<td>\date{August 2022}</td>
</tr>
<tr>
<td>today</td>
<td>日期的平替，每次编译后改变日期</td>
<td>\today</td>
</tr>
<tr>
<td>maketitle</td>
<td>将title\author\date标签实例化</td>
<td>见文章示例</td>
</tr>
<tr>
<td>textbf</td>
<td>粗体</td>
<td>Some of the \textbf{greatest}</td>
</tr>
<tr>
<td>textit</td>
<td>斜体</td>
<td>were made by \textbf{\textit{accident}}.</td>
</tr>
<tr>
<td>underline</td>
<td>下划线</td>
<td>discoveries in \underline{science}</td>
</tr>
<tr>
<td>itemize与item</td>
<td>无序号列举</td>
<td>\begin{itemize} \item this is 1 \item this is 2 \end{itemize}</td>
</tr>
<tr>
<td>enumerate与item</td>
<td>有序号列举</td>
<td>\begin{enumerate} \item this is 1 \item this is 2 \end{enumerate}</td>
</tr>
<tr>
<td>\\</td>
<td>换行</td>
<td>then add \ a manual</td>
</tr>
</tbody></table>
<h2 id="图片标签介绍"><a href="#图片标签介绍" class="headerlink" title="图片标签介绍"></a>图片标签介绍</h2><h3 id="引入图片"><a href="#引入图片" class="headerlink" title="引入图片"></a>引入图片</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;graphicx&#125; <span class="comment">%LaTeX package to import graphics</span></span><br><span class="line"><span class="keyword">\graphicspath</span>&#123;&#123;images/&#125;&#125; <span class="comment">%图片存储在文件夹images里</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">The universe is immense and it seems to be homogeneous, </span><br><span class="line">on a large scale, everywhere we look.</span><br><span class="line"></span><br><span class="line"><span class="keyword">\includegraphics</span>&#123;universe&#125;  <span class="comment">%一个名为universe.jpg的图片，加不加后缀都可</span></span><br><span class="line"> </span><br><span class="line">There&#x27;s a picture of a galaxy above.</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h3 id="图片操作"><a href="#图片操作" class="headerlink" title="图片操作"></a>图片操作</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;graphicx&#125;</span><br><span class="line"><span class="keyword">\graphicspath</span>&#123;&#123;images/&#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[h]</span><br><span class="line">    <span class="keyword">\centering</span></span><br><span class="line">    <span class="keyword">\includegraphics</span>[width=0.75<span class="keyword">\textwidth</span>]&#123;mesh&#125; <span class="comment">%设置图片的宽度</span></span><br><span class="line">    <span class="keyword">\caption</span>&#123;A nice plot.&#125; <span class="comment">%设置下标文字</span></span><br><span class="line">    <span class="keyword">\label</span>&#123;fig:mesh1&#125; <span class="comment">%设置引用名，之后可通过引用名指代该图片的序号</span></span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line"> <span class="comment">%使用引用名指代图片序号,下方渲染的结果为“figure1”</span></span><br><span class="line">As you can see in figure <span class="keyword">\ref</span>&#123;fig:mesh1&#125;, the function grows near the origin. This example is on page <span class="keyword">\pageref</span>&#123;fig:mesh1&#125;.</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="comment">%无边框表格</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;c c c&#125;</span><br><span class="line"> cell1 <span class="built_in">&amp;</span> cell2 <span class="built_in">&amp;</span> cell3 <span class="keyword">\\</span> </span><br><span class="line"> cell4 <span class="built_in">&amp;</span> cell5 <span class="built_in">&amp;</span> cell6 <span class="keyword">\\</span>  </span><br><span class="line"> cell7 <span class="built_in">&amp;</span> cell8 <span class="built_in">&amp;</span> cell9    </span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">%竖边框表格</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;|c|c|c|&#125; </span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> cell1 <span class="built_in">&amp;</span> cell2 <span class="built_in">&amp;</span> cell3 <span class="keyword">\\</span> </span><br><span class="line"> cell4 <span class="built_in">&amp;</span> cell5 <span class="built_in">&amp;</span> cell6 <span class="keyword">\\</span> </span><br><span class="line"> cell7 <span class="built_in">&amp;</span> cell8 <span class="built_in">&amp;</span> cell9 <span class="keyword">\\</span> </span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">%横边框表格</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line"> <span class="keyword">\begin</span>&#123;tabular&#125;&#123;||c c c c||&#125; </span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> Col1 <span class="built_in">&amp;</span> Col2 <span class="built_in">&amp;</span> Col2 <span class="built_in">&amp;</span> Col3 <span class="keyword">\\</span> [0.5ex] </span><br><span class="line"> <span class="keyword">\hline</span><span class="keyword">\hline</span></span><br><span class="line"> 1 <span class="built_in">&amp;</span> 6 <span class="built_in">&amp;</span> 87837 <span class="built_in">&amp;</span> 787 <span class="keyword">\\</span> </span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> 2 <span class="built_in">&amp;</span> 7 <span class="built_in">&amp;</span> 78 <span class="built_in">&amp;</span> 5415 <span class="keyword">\\</span></span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> 3 <span class="built_in">&amp;</span> 545 <span class="built_in">&amp;</span> 778 <span class="built_in">&amp;</span> 7507 <span class="keyword">\\</span></span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> 4 <span class="built_in">&amp;</span> 545 <span class="built_in">&amp;</span> 18744 <span class="built_in">&amp;</span> 7560 <span class="keyword">\\</span></span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"> 5 <span class="built_in">&amp;</span> 88 <span class="built_in">&amp;</span> 788 <span class="built_in">&amp;</span> 6344 <span class="keyword">\\</span> [1ex] </span><br><span class="line"> <span class="keyword">\hline</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文章布局"><a href="#文章布局" class="headerlink" title="文章布局"></a>文章布局</h2><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;abstract&#125; <span class="comment">%摘要</span></span><br><span class="line">This is a simple paragraph at the beginning of the </span><br><span class="line">document. A brief introduction about the main subject.</span><br><span class="line"><span class="keyword">\end</span>&#123;abstract&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;book&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\chapter</span>&#123;First Chapter&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Introduction&#125; <span class="comment">%会自动生成序号，效果类似notion中的heading</span></span><br><span class="line"></span><br><span class="line">This is the first section.</span><br><span class="line"></span><br><span class="line">Lorem  ipsum  dolor  sit  amet,  consectetuer  adipiscing  </span><br><span class="line">elit. Etiam  lobortisfacilisis sem.  Nullam nec mi et </span><br><span class="line">neque pharetra sollicitudin.  Praesent imperdietmi nec ante. </span><br><span class="line">Donec ullamcorper, felis non sodales...</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;Second Section&#125;</span><br><span class="line"></span><br><span class="line">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.  </span><br><span class="line">Etiam lobortis facilisissem.  Nullam nec mi et neque pharetra </span><br><span class="line">sollicitudin.  Praesent imperdiet mi necante...</span><br><span class="line"></span><br><span class="line"><span class="keyword">\subsection</span>&#123;First Subsection&#125;</span><br><span class="line">Praesent imperdietmi nec ante. Donec ullamcorper, felis non sodales...</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>*&#123;Unnumbered Section&#125;</span><br><span class="line">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.  </span><br><span class="line">Etiam lobortis facilisissem...</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">%\part&#123;part&#125;</span></span><br><span class="line"><span class="comment">%\chapter&#123;chapter&#125;</span></span><br><span class="line"><span class="comment">%\section&#123;section&#125;</span></span><br><span class="line"><span class="comment">%\subsection&#123;subsection&#125;</span></span><br><span class="line"><span class="comment">%\subsubsection&#123;subsubsection&#125;</span></span><br><span class="line"><span class="comment">%\paragraph&#123;paragraph&#125;</span></span><br><span class="line"><span class="comment">%\subparagraph&#123;subparagraph&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h2><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">Subscripts in math mode are written as <span class="built_in">$</span>a<span class="built_in">_</span>b<span class="built_in">$</span> and superscripts are written as <span class="built_in">$</span>a<span class="built_in">^</span>b<span class="built_in">$</span>. These can be combined and nested to write expressions such as</span><br><span class="line"></span><br><span class="line"><span class="keyword">\[</span> T<span class="built_in">^</span>&#123;i<span class="built_in">_</span>1 i<span class="built_in">_</span>2 <span class="keyword">\dots</span> i<span class="built_in">_</span>p&#125;<span class="built_in">_</span>&#123;j<span class="built_in">_</span>1 j<span class="built_in">_</span>2 <span class="keyword">\dots</span> j<span class="built_in">_</span>q&#125; = T(x<span class="built_in">^</span>&#123;i<span class="built_in">_</span>1&#125;,<span class="keyword">\dots</span>,x<span class="built_in">^</span>&#123;i<span class="built_in">_</span>p&#125;,e<span class="built_in">_</span>&#123;j<span class="built_in">_</span>1&#125;,<span class="keyword">\dots</span>,e<span class="built_in">_</span>&#123;j<span class="built_in">_</span>q&#125;) <span class="keyword">\]</span></span><br><span class="line"><span class="comment">%^为上标，_为下标，\dots为省略号， </span></span><br><span class="line"></span><br><span class="line">We write integrals using <span class="built_in">$</span><span class="keyword">\int</span><span class="built_in">$</span> and fractions using <span class="built_in">$</span><span class="keyword">\frac</span>&#123;a&#125;&#123;b&#125;<span class="built_in">$</span>. Limits are placed on integrals using superscripts and subscripts:</span><br><span class="line"><span class="comment">%\int 为积分符号</span></span><br><span class="line"><span class="keyword">\[</span> <span class="keyword">\int</span><span class="built_in">_</span>0<span class="built_in">^</span>1 <span class="keyword">\frac</span>&#123;dx&#125;&#123;e<span class="built_in">^</span>x&#125; =  <span class="keyword">\frac</span>&#123;e-1&#125;&#123;e&#125; <span class="keyword">\]</span></span><br><span class="line"><span class="comment">%从0积分到1；\frac为分数的分号，之后的第一个为分母，第二个为分子；</span></span><br><span class="line">Lower case Greek letters are written as <span class="built_in">$</span><span class="keyword">\omega</span><span class="built_in">$</span> <span class="built_in">$</span><span class="keyword">\delta</span><span class="built_in">$</span> etc. while upper case Greek letters are written as <span class="built_in">$</span><span class="keyword">\Omega</span><span class="built_in">$</span> <span class="built_in">$</span><span class="keyword">\Delta</span><span class="built_in">$</span>.</span><br><span class="line"><span class="comment">%对应读音的希腊文字</span></span><br><span class="line">Mathematical operators are prefixed with a backslash as <span class="built_in">$</span><span class="keyword">\sin</span>(<span class="keyword">\beta</span>)<span class="built_in">$</span>, <span class="built_in">$</span><span class="keyword">\cos</span>(<span class="keyword">\alpha</span>)<span class="built_in">$</span>, <span class="built_in">$</span><span class="keyword">\log</span>(x)<span class="built_in">$</span> etc.</span><br><span class="line"><span class="comment">%三角函数与对数</span></span><br><span class="line">This is a simple math expression <span class="keyword">\(</span><span class="keyword">\sqrt</span>&#123;x<span class="built_in">^</span>2+1&#125;<span class="keyword">\)</span> inside text. </span><br><span class="line"><span class="comment">%\sqrt 根号</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="论文示例"><a href="#论文示例" class="headerlink" title="论文示例"></a>论文示例</h2><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="meta">% !TeX program = xelatex</span></span><br><span class="line"><span class="meta">% !TEX root = main.tex</span></span><br><span class="line"><span class="meta">% !TeX encoding = UTF-8</span></span><br><span class="line"><span class="keyword">\documentclass</span>[10.5pt,compsoc]&#123;CjC&#125;</span><br><span class="line"><span class="comment">%\usepackage&#123;CJKutf8&#125;</span></span><br><span class="line"><span class="comment">%\usepackage&#123;CJK&#125;</span></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;graphicx&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;footmisc&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;subfigure&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;url&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;multirow&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[noadjust]&#123;cite&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath,amsthm&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amssymb,amsfonts&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;booktabs&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;color&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;ccaption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;booktabs&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;float&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;fancyhdr&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;caption&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;xcolor,stfloats&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;comment&#125;</span><br><span class="line"><span class="keyword">\setcounter</span>&#123;page&#125;&#123;1&#125;</span><br><span class="line"><span class="keyword">\graphicspath</span>&#123;&#123;figures/&#125;&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;cuted&#125;<span class="comment">%flushend,</span></span><br><span class="line"><span class="keyword">\usepackage</span>&#123;captionhack&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;epstopdf&#125;</span><br><span class="line"><span class="comment">%\usepackage&#123;ccmap&#125;</span></span><br><span class="line"><span class="comment">%\CJKtilde</span></span><br><span class="line"><span class="comment">%\usepackage&#123;CJKpunct&#125; </span></span><br><span class="line"><span class="comment">%\usepackage[lite,subscriptcorrection,slantedGreek,nofontinfo]&#123;mtpro2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%===============================%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%\firstfootname&#123; \quad \quad &#125;</span></span><br><span class="line"><span class="keyword">\headevenname</span>&#123;<span class="keyword">\mbox</span>&#123;<span class="keyword">\quad</span>&#125; <span class="keyword">\hfill</span>  <span class="keyword">\mbox</span>&#123;<span class="keyword">\zihao</span>&#123;-5&#125;&#123;<span class="keyword">\songti</span>  计<span class="keyword">\quad</span> <span class="keyword">\quad</span> 算<span class="keyword">\quad</span> <span class="keyword">\quad</span> 机<span class="keyword">\quad</span> <span class="keyword">\quad</span> 学<span class="keyword">\quad</span> <span class="keyword">\quad</span> 报 &#125; <span class="keyword">\hspace</span> &#123;50mm&#125; <span class="keyword">\mbox</span>&#123;<span class="keyword">\songti</span>  2019 年 &#125;&#125;&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\headoddname</span>&#123;<span class="keyword">\songti</span>  ? 期 <span class="keyword">\hfill</span></span><br><span class="line">作者姓名等：论文题目 &#125;<span class="comment">%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%footnote use of *</span></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\thefootnote</span>&#125;&#123;<span class="keyword">\fnsymbol</span>&#123;footnote&#125;&#125;</span><br><span class="line"><span class="keyword">\setcounter</span>&#123;footnote&#125;&#123;0&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span><span class="keyword">\footnotelayout</span>&#123;<span class="keyword">\zihao</span>&#123;5-&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\newtheoremstyle</span>&#123;mystyle&#125;&#123;0pt&#125;&#123;0pt&#125;&#123;<span class="keyword">\normalfont</span>&#125;&#123;1em&#125;&#123;<span class="keyword">\bf</span>&#125;&#123;&#125;&#123;1em&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\theoremstyle</span>&#123;mystyle&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span><span class="keyword">\figurename</span>&#123;figure~&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\thesubfigure</span>&#125;&#123;(<span class="keyword">\alph</span>&#123;subfigure&#125;)&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\upcite</span>&#125;[1]&#123;<span class="keyword">\textsuperscript</span>&#123;<span class="keyword">\cite</span>&#123;<span class="params">#1</span>&#125;&#125;&#125;</span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\labelenumi</span>&#125;&#123;(<span class="keyword">\arabic</span>&#123;enumi&#125;)&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\tabincell</span>&#125;[2]&#123;<span class="keyword">\begin</span>&#123;tabular&#125;&#123;@&#123;&#125;<span class="params">#1</span>@&#123;&#125;&#125;<span class="params">#2</span><span class="keyword">\end</span>&#123;tabular&#125;&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\abc</span>&#125;&#123;<span class="keyword">\color</span>&#123;white&#125;<span class="keyword">\vrule</span> width 2pt&#125;</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\renewcommand</span>&#123;<span class="keyword">\@biblabel</span>&#125;[1]&#123;[<span class="params">#1</span>]<span class="keyword">\hfill</span>&#125;</span><br><span class="line"><span class="keyword">\makeatother</span></span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\parindent</span>&#123;2em&#125;</span><br><span class="line"><span class="comment">%\renewcommand&#123;\hth&#125;&#123;\heiti &#125;</span></span><br><span class="line"><span class="comment">%\renewcommand&#123;\htss&#125;&#123;\begin&#123;CJK*&#125;&#123;UTF8&#125;&#123;song&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\hyphenpenalty</span>=50000</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\newcommand</span><span class="keyword">\mysmall</span>&#123;<span class="keyword">\@setfontsize</span><span class="keyword">\mysmall</span>&#123;7&#125;&#123;9.5&#125;&#125;</span><br><span class="line"><span class="keyword">\newenvironment</span>&#123;tablehere&#125;</span><br><span class="line">  &#123;<span class="keyword">\def</span><span class="keyword">\@captype</span>&#123;table&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\let</span><span class="keyword">\temp</span><span class="keyword">\footnote</span></span><br><span class="line"><span class="keyword">\renewcommand</span> <span class="keyword">\footnote</span>[1]&#123;<span class="keyword">\temp</span>&#123;<span class="keyword">\zihao</span>&#123;-5&#125;<span class="params">#1</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\thispagestyle</span>&#123;plain&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\thispagestyle</span>&#123;empty&#125;<span class="comment">%</span></span><br><span class="line"><span class="keyword">\pagestyle</span>&#123;CjCheadings&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;table*&#125;[!t]</span><br><span class="line"><span class="keyword">\vspace</span> &#123;-13mm&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;p&#123;168mm&#125;&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;</span><br><span class="line"><span class="keyword">\songti</span> </span><br><span class="line">第??卷<span class="keyword">\quad</span> 第?期 <span class="keyword">\hfill</span> 计<span class="keyword">\quad</span> 算<span class="keyword">\quad</span> 机<span class="keyword">\quad</span> 学<span class="keyword">\quad</span> 报<span class="keyword">\hfill</span> Vol. ??  No. ?</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;<span class="keyword">\songti</span>  </span><br><span class="line">20??年?月 <span class="keyword">\hfill</span> CHINESE JOURNAL OF COMPUTERS <span class="keyword">\hfill</span> ???. 20?? <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\hline</span><span class="keyword">\\</span>[-4.5mm]</span><br><span class="line"><span class="keyword">\hline</span><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\vspace</span>&#123;11mm&#125;</span><br><span class="line"><span class="keyword">\heiti</span>  </span><br><span class="line">&#123;<span class="keyword">\zihao</span>&#123;2&#125; 基于WebSocket协议的云平台性能优化 &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vskip</span> 5mm</span><br><span class="line"></span><br><span class="line">&#123;<span class="keyword">\zihao</span>&#123;3&#125; <span class="keyword">\fangsong</span> </span><br><span class="line">白日糖<span class="built_in">$</span><span class="built_in">^</span>&#123;1)&#125;<span class="built_in">$</span><span class="keyword">\quad</span>  zency<span class="built_in">$</span><span class="built_in">^</span>&#123;2),3)&#125;<span class="built_in">$</span> <span class="keyword">\quad</span> 作者名<span class="built_in">$</span><span class="built_in">^</span>&#123;3) &#125;<span class="built_in">$</span>(<span class="built_in">$</span><span class="built_in">^</span>*<span class="built_in">$</span>字体为3号仿宋*作者)</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vspace</span>&#123;5mm&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\songti</span> </span><br><span class="line"><span class="built_in">$</span><span class="built_in">^</span>&#123;1)&#125;<span class="built_in">$</span>(单位全名 部门(系)全名, 市(或直辖市) 国家名 邮政编码)</span><br><span class="line">*字体为6号宋体*单位</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\songti</span>  </span><br><span class="line"><span class="built_in">$</span><span class="built_in">^</span>&#123;2)&#125;<span class="built_in">$</span>(单位全名 部门(系)全名, 市(或直辖市) 国家名</span><br><span class="line">邮政编码)*中英文单位名称、作者姓名须一致*&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\songti</span>  </span><br><span class="line"><span class="built_in">$</span><span class="built_in">^</span>&#123;3)&#125;<span class="built_in">$</span>(单位全名 部门(系)全名, 市(或直辖市) 国家名 邮政编码)</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\heiti</span> </span><br><span class="line">论文定稿后，作者署名、单位无特殊情况不能变更。若变更，须提交签章申请，国家名为中国可以不写，省会城市不写省的名称，其他国家必须写国家名。</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vskip</span> 5mm</span><br><span class="line">&#123;<span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;p&#123;160mm&#125;&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;&#123;</span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\baselineskip</span>&#125;&#123;16pt&#125;<span class="keyword">\selectfont</span>&#123;</span><br><span class="line"><span class="keyword">\noindent</span><span class="keyword">\heiti</span> 摘<span class="keyword">\quad</span> 要<span class="keyword">\quad</span>   <span class="keyword">\songti</span> </span><br><span class="line"></span><br><span class="line">可是，为了避免雪之下她们察觉我独自帮一色的忙，只有在校外会合这个方法。在现在的雪之下面前接受学生会委托，对她而言太过残忍；把一色完全拒在门外的话，又未免太不负责任。虽然也可以单独不让雪之下参与，这样做又好像深深地背叛她。考虑侍奉社的现状后，最好的方法还是由我以个人身分行动。</span><br><span class="line"></span><br><span class="line">话说回来，一色光是这样便心动的话，她得格外注意才行，否则连旅行都没办法好好放松。难道每次空服员姐姐帮忙抬行李，她都要心动一次？应该不至于吧……不对，搞不好会喔（美丽空服员姐姐的参数补正）。不对，再等一下，即使不是空服员，做粗工的大姐姐说不定也很让人心动……果然有工作的女性最棒了（家庭主夫志向的参数补正）！</span><br><span class="line"></span><br><span class="line">如果我们是过去作客，接受对方招待，自然没有必要在意这些细节，但今天我们是跟对方共同举办活动，在地位上平起平坐，就算只是点缀会议的点心，也必须维持跟对方相当的水准。</span><br><span class="line"></span><br><span class="line">一色用相当讨喜的方式打招呼，走进房间，我跟着进去后，大家也没有安静下来的迹象，甚至连看都不看过来一眼。看来他们聊得正高兴，对我没有半点兴趣。</span><br><span class="line"></span><br><span class="line"><span class="comment">% *中文摘要内容置于此处(英文摘要中要有这些内容)，字体为小5号宋体。摘要贡献部分，要有数据支持，不要出现``...大大提高&#x27;&#x27;、``...显著改善&#x27;&#x27;等描述，正确的描述是``比&#123;\ldots&#125;提高X&#123;\%&#125;&#x27;&#x27;、``在&#123;\ldots&#125;上改善X&#123;\%&#125;&#x27;&#x27;。*摘要</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">\par</span>&#125;&#125;<span class="keyword">\\</span>[2mm]</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;&#123;<span class="keyword">\noindent</span></span><br><span class="line"><span class="keyword">\heiti</span> 关键词  <span class="keyword">\quad</span> <span class="keyword">\songti</span>  &#123;青春；恋爱；我的；果然；有问题&#125;</span><br><span class="line"><span class="comment">% &#123;*关键词（中文关键字与英文关键字对应且一致，应有5-7个关键词)；关键词；关键词；关键词*  &#125;</span></span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">\\</span>[2mm]</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;&#123;<span class="keyword">\heiti</span> 中图法分类号 	<span class="keyword">\songti</span>  </span><br><span class="line">TP <span class="keyword">\rm</span>&#123;<span class="keyword">\quad</span> <span class="keyword">\quad</span> <span class="keyword">\quad</span>     &#125;</span><br><span class="line"><span class="keyword">\heiti</span> DOI号: <span class="keyword">\songti</span>  </span><br><span class="line">*投稿时不提供DOI号 &#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vskip</span> 7mm</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;3&#125;&#123; &#123;<span class="keyword">\heiti</span> Title *（中英文题目一致)字体为4号Times New Roman,加粗* Title &#125;&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\vspace</span> &#123;5mm&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;&#123; &#123;<span class="keyword">\heiti</span> NAME Name-Name<span class="built_in">$</span><span class="built_in">^</span>&#123;1)&#125;<span class="built_in">$</span> NAME Name<span class="built_in">$</span><span class="built_in">^</span>&#123;2)&#125;<span class="built_in">$</span> NAME Name-Name<span class="built_in">$</span><span class="built_in">^</span>&#123;3)&#125;<span class="built_in">$</span> *字体为5号Times</span><br><span class="line">new Roman*Name </span><br><span class="line">&#125;&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\vspace</span> &#123;2mm&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\heiti</span> &#123;<span class="built_in">$</span><span class="built_in">^</span>&#123;1)&#125;<span class="built_in">$</span>(Department of ****, University, City ZipCode, China) *字体为6号Times</span><br><span class="line">new Roman* Depart.Correspond&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\heiti</span> &#123;<span class="built_in">$</span><span class="built_in">^</span>&#123;2)&#125;<span class="built_in">$</span>(Department of ****, University, City ZipCode)*中国不写国家名*&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;6&#125;&#123;<span class="keyword">\heiti</span> &#123;<span class="built_in">$</span><span class="built_in">^</span>&#123;3)&#125;<span class="built_in">$</span>(Department of ****, University, City ZipCode, country)*外国写国家名*&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;p&#123;160mm&#125;&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;&#123;</span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\baselineskip</span>&#125;&#123;18pt&#125;<span class="keyword">\selectfont</span>&#123;</span><br><span class="line">&#123;<span class="keyword">\bf</span> Abstract&#125;<span class="keyword">\quad</span> <span class="keyword">\begin</span>&#123;heiti&#125; (<span class="keyword">\textbf</span>&#123;500英文单词，内容包含中文摘要的内容&#125;).</span><br><span class="line">字体为Times new Roman,字号5号* Abstract <span class="keyword">\end</span>&#123;heiti&#125;</span><br><span class="line"><span class="keyword">\par</span>&#125;&#125;<span class="keyword">\\</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\baselineskip</span>&#125;&#123;18pt&#125;<span class="keyword">\selectfont</span>&#123;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;&#123;<span class="keyword">\noindent</span> Do not modify the amount of space before and after the artworks. One- or two-column format artworks are preferred. and Tables, create a new break line and paste the resized artworks where desired. Do not modify the amount of space before and after the artworks. One- or two-column format artworks are preferred. All Schemes, Equations, Figures, and Tables should be mentioned in the text consecutively and numbered with Arabic numerals, and appear below where they are mentioned for the first time in the main text. To insert Schemes, Equations, Figures, and Tables, create a new break line and paste the resized artworks where desired. Do not modify the amount of space before and after the artworks. One- or two-column format artworks are preferred.Do not modify the amount of space before and after the artworks. One- or two-column format artworks are preferred. and Tables, create a new break line and paste the resized artworks where desired. Do not modify the amount of space before and after the artworks. One- or two-column format artworks are preferred. All Schemes, Equations, Figures, and Tables should be mentioned in the text consecutively and numbered with Arabic numerals, and appear below where they are mentioned for the first time in the main text.</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vspace</span> &#123;5mm&#125;</span><br><span class="line">&#123;<span class="keyword">\bf</span> Keywords&#125;<span class="keyword">\quad</span> <span class="keyword">\heiti</span> 中文关键字与英文关键字对应且一致，<span class="keyword">\textbf</span>&#123;不要用英文缩写&#125;);</span><br><span class="line">key word; key word; key word* *字体为5号Times new Roman * Key words &#125;<span class="keyword">\par</span>&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\setlength</span>&#123;<span class="keyword">\tabcolsep</span>&#125;&#123;2pt&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;p&#123;0.05cm&#125;p&#123;16.15cm&#125;&#125;</span><br><span class="line"><span class="keyword">\multicolumn</span>&#123;2&#125;&#123;l&#125;&#123;<span class="keyword">\rule</span>[4mm]&#123;40mm&#125;&#123;0.1mm&#125;&#125;<span class="keyword">\\</span>[-3mm]</span><br><span class="line"><span class="built_in">&amp;</span><span class="keyword">\begin</span>&#123;songti&#125;</span><br><span class="line">收稿日期：<span class="keyword">\quad</span> <span class="keyword">\quad</span> -<span class="keyword">\quad</span> -<span class="keyword">\quad</span> ；最终修改稿收到日期：<span class="keyword">\quad</span> <span class="keyword">\quad</span> -<span class="keyword">\quad</span> -<span class="keyword">\quad</span> .*投稿时不填写此项*. 本课题得到… …基金中文完整名称(No.项目号)、… …基金中文完整名称(No.项目号)、… … 基金中文完整名称(No.项目号)资助.作者名1(通信作者)，性别，xxxx年生，学位(或目前学历)，职称，是/否计算机学会(CCF)会员（提供会员号),主要研究领域为*****、****.E-mail: **************.作者名2（通信作者)，性别，xxxx年生，学位(或目前学历)，职称，是/否计算机学会(CCF)会员（提供会员号),主要研究领域为*****、****.E-mail: **************. 作者名3（通信作者)，性别，xxxx年生，学位(或目前学历)，职称，是/否计算机学会(CCF)会员（提供会员号),主要研究领域为*****、****.E-mail: **************.(给出的电子邮件地址应不会因出国、毕业、更换工作单位等原因而变动。请给出所有作者的电子邮件)</span><br><span class="line">第1作者手机号码(投稿时必须提供，以便紧急联系，发表时会删除): … …, E-mail: … …*此部分6号宋体*</span><br><span class="line"><span class="keyword">\end</span>&#123;songti&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;<span class="keyword">\end</span>&#123;table*&#125;</span><br><span class="line"><span class="keyword">\clearpage</span><span class="keyword">\clearpage</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;strip&#125;</span><br><span class="line"><span class="keyword">\vspace</span> &#123;-13mm&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;strip&#125;</span><br><span class="line">    <span class="keyword">\linespread</span>&#123;1.15&#125;</span><br><span class="line"><span class="keyword">\heiti</span> </span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;</span><br><span class="line"><span class="keyword">\vskip</span> 1mm</span><br><span class="line"><span class="keyword">\section</span> &#123;引言&#125;</span><br><span class="line"><span class="comment">% &#123;一级标题*字体为4号黑体*标题1&#125;</span></span><br><span class="line"><span class="comment">% \textbf&#123;对投稿的基本要求&#125;：</span></span><br><span class="line"><span class="keyword">\songti</span>  </span><br><span class="line">我并不排斥枯燥的劳动，尽管不断重复相同流程的机械性作业会耗损精神，我的精神早已被磨光，或者说是被磨到产生抵抗力，所以只要不用费心思伤脑筋，对我来说便是轻松的工作。创新的innovation！用对话跟交涉negotiation！解决反感就是我们的solution！会议以这样的感觉进行下去，他们早已超越新手跳hip hop的境界，脑袋嗨到突破天际了。</span><br><span class="line"></span><br><span class="line">比较让我在意的是，发言者几乎都是海滨综合高中学生会，总武高中这边虽然出席会议，从头到尾没说到几句话。但是，听到对方一连串菁英言论之后，他们大概也不敢献丑，连担任会长的一色都插不上话。即使现在没问题，我还是担心她之后会付出惨痛的代价。不受欢迎的男生很容易上当，所以会发生各式各样的悲剧喔……不受欢迎的男生纯情又直性子，外加始终如一的专情，是会错意的高危险群。这样一想，不受欢迎的男生岂不是超级大好人？那为什么还不受欢迎，真是太不可思议了！</span><br><span class="line"></span><br><span class="line"><span class="comment">% 此处插入一张WebSocket示例图</span></span><br><span class="line">我承认自己暗示过一色，要善用自身立场的优势，但我可没有说得那么直白——不对，那根本是一色听过我的话，独自发展出的理论……糟糕，我好像在不知不觉中养了一头怪物，那群人会不会因为这个女的而分裂……</span><br><span class="line"></span><br><span class="line">这时我才恍然大悟，原来是二年级的……虽然不知道名字，我好像在校内看过他，想不到那个人就是学生会副会长。没办法，大家通常只记得会长是谁，底下的人几乎都懒得去看。</span><br><span class="line"></span><br><span class="line">小雪离开暖被桌，但还是想找地方取暖，于是跳到小町的腿上，蜷起身体开始打盹。已经睡一整天了，现在还要睡吗？唉，当猫咪真好。我也好想过那样的生活。</span><br><span class="line"></span><br><span class="line"><span class="comment">% (1) 研究性论文主体应包括引言(重点论述研究的科学问题、意义、解决思路、价值、贡献等)、相关工作(为与引言部分独立的一个章节)、主要成果论述、关键实现技术、验证(对比实验或理论证明)、结论(结束语)等内容；系统实现或实验应有关键点的详细论述，以便读者能够重复实现论文所述成果。实验应有具体的实验环境设置、全面细致的数据对比分析。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% (2) 综述应包括引言、问题与挑战、研究现状分析、未来研究方向、结论等内容。以分析、对比为主，避免堆砌文献或一般性介绍、叙述。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% (3) 定理证明、公式推导、大篇幅的数学论述、原始数据，放到论文最后的附录中。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% &#123;\bf 稿件提交时的基本要求：&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% (1) 本模板中要求的各项内容正确齐全，无遗漏；</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% (2) 语句通顺，无中文、英文语法错误，易于阅读理解，符号使用正确，图、表清晰无误；</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% (3) 在学术、技术上，论文内容正确无误，各项内容确定。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;相关工作&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\songti</span></span><br><span class="line">既然是那个理由，我当然不吝于跑腿。虽然之前没特别想过，我考高中的时候，小町的确帮了许多忙。而且，平常都是由她负责大部分的家事，现在轮到她应考，那些<span class="keyword">\cite</span>&#123;fette2011websocket&#125;。家里有个能干的妹妹是件好事，但也非常辛苦——我打算这么为自己辩解，但母亲丝毫不在意我的反应，从包包拿出钱包。<span class="keyword">\cite</span>&#123;9581663&#125;，小町看着她疲惫的身影，嘟哝：</span><br><span class="line"></span><br><span class="line">虽然没什么参加的动力，现阶段大部分的工作都由海滨综合高中负责，所以我们只需负责他们交办的事项。那群人进行脑力激荡、热烈讨论，一副干劲十足的样子——不用说<span class="keyword">\cite</span>&#123;6197172&#125;。由一年级学生担任会长，是个意料之外的棘手问题。虽然我们只差一岁，这一岁在高中里，可是代表整整一学年的落差。不同年级间互相顾虑，会造成沟通上的阻碍。</span><br><span class="line"></span><br><span class="line">对于已经非常努力的人，实在不应该再说「加油」。而且由我这个不怎么努力的人来说，搞不好<span class="keyword">\cite</span>&#123;tomasetti2021analysis&#125;，我顿时涌出泪水。哥哥可是全心全意说出这句话的耶！我还让煞车灯闪了三下（注19出自美梦成真「未来预想图Ⅱ」之歌词：「送我下车后，你目送我走过转向，总会闪三下煞车灯。这是『我·爱·你』的暗号」。）你知不知道！</span><br><span class="line"></span><br><span class="line">我起身后，由比滨开口道别，雪之下也说「代我向小町问好」。我稍微挥手表示知道，随即走出社办。不一会儿，留在室内的由比滨便谈起小町的考试。</span><br><span class="line"> </span><br><span class="line"><span class="keyword">\vspace</span>&#123;6mm&#125;<span class="keyword">\section</span>&#123;青春恋爱物语&#125;</span><br><span class="line"></span><br><span class="line">我的好哥哥技能又在无意间自动发动，哀哉比企谷！如果我真的别有意图，一定会害羞得掌心冒汗。啊，这样一想，我的掌心真的开始冒汗了。</span><br><span class="line"></span><br><span class="line"><span class="comment">% 此部分介绍云平台智控</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\vspace</span>&#123;7mm&#125;<span class="keyword">\section</span>&#123;实验设计&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\songti</span></span><br><span class="line">活动日期是圣诞节前夕，地点在这栋公民会馆的大礼堂，目的是以促进地方交流、为地方奉献心力为主旨的志愿服务。活动设定的对象是邻近托儿所的幼童，以及利用日间照护中心的年长者。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;数据压缩/二进制传输&#125;：「进行brainstorm的时候，我们不会否定彼此的意见。要是受限于时间与人力因素，无法扩大活动规模，我们便要讨论如何突破这个困难，而不是立刻提出结论。因此，你的意见是不行的。」</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;错误处理和恢复&#125;：回到正题，增加参与的学校数没有什么好处。目前才两间学校，便已经没办法达成共识，要是再加进更多人的意见，只会没完没了，并且导致工作量增加。这个情况说什么也得避免……</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;心跳/连接复用&#125;：很遗憾地，胜利的喜悦维持不了多久，玉绳便竖起食指，提出另一个想法。</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;均衡负载&#125;：不只是折本，其他人也大多赞成。玉绳满意地点点头，把提案视为可决，开始下达今后的指示。</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line">为了评估以上优化策略的效果，我们将通过针对性的实验设计对优化前后的WebSocket性能进行比较。实验中的云平台环境服务器端为...。客户端为Chrome浏览器120版本，并利用浏览器所提供的DevTools开发者工具进行性能监控和评估。我们将特别关注以下几个方面：</span><br><span class="line"></span><br><span class="line"><span class="comment">% 量化评估ms mb/s xx小时无错误 </span></span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;系统响应速度&#125;：通过测量请求响应时间，评估系统在处理高并发请求时的响应能力和延迟情况。</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;数据处理能力&#125;：评估系统在海量数据压力下的数据处理速度，以及优化方案对网络带宽利用的改进。</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;系统稳定性和可靠性&#125;：通过长时间运行测试，检测优化策略对于系统稳定性的贡献，尤其是在网络条件不稳定和负荷激增时的表现。</span><br><span class="line">    <span class="keyword">\item</span> <span class="keyword">\textbf</span>&#123;资源利用效率&#125;：评估系统在服务器资源分配和处理能力方面的效果。</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line"></span><br><span class="line">我跟折本明明念同一所国中，她怎么可能不知道这种问题？但是，仔细想想，我自己也没有半点印象，当时的学生会是哪些人组成。没有印象的话，代表他们没在我的心中留下创伤，说不定是一群好人喔！既然是一群好人，却对他们没有半点印象，我不禁感到一阵愧疚。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\subsection</span>&#123;数据压缩/二进制传输&#125;</span><br><span class="line"></span><br><span class="line">尽管嘴巴上否认，在这将近一年的期间内，我经历过校庆、运动会之类大大小小的活动，因此累积了不少经验值。跟过去比较起来，现在我对这类工作的抗性的确提高许多。</span><br><span class="line"></span><br><span class="line"><span class="keyword">\subsection</span>&#123;错误处理和恢复&#125;</span><br><span class="line"></span><br><span class="line">主动抛出错误（丢包等）</span><br><span class="line"></span><br><span class="line"><span class="keyword">\subsection</span>&#123;心跳机制/连接复用&#125;</span><br><span class="line"></span><br><span class="line">折本闻言，盯着这里寻思一会儿</span><br><span class="line"></span><br><span class="line"><span class="keyword">\subsection</span>&#123;均衡负载&#125;</span><br><span class="line"></span><br><span class="line">双服务器</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;结果和分析&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\section</span>&#123;展望&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="keyword">\heiti</span> <span class="keyword">\subsection</span>&#123;二级标题 *字体为5号黑体*标题2&#125; &#125;</span><br><span class="line"><span class="keyword">\subsubsection</span>&#123;三级标题 *字体为5号宋体*标题3&#125;</span><br><span class="line">*正文部分, 字体为5号宋体* 正文文字</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;figure&#125;[htbp]</span><br><span class="line"><span class="keyword">\centerline</span>&#123;<span class="keyword">\includegraphics</span>[width=3.15in,height=1.98in]&#123;CJC1.pdf&#125;&#125;</span><br><span class="line">图X<span class="keyword">\quad</span>  图片说明 *字体为小5号，图片应为黑白图，图中的子图要有子图说明*</span><br><span class="line"><span class="keyword">\label</span>&#123;fig1&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;figure&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[htbp]</span><br><span class="line"><span class="keyword">\centering</span> &#123;<span class="keyword">\heiti</span> 表X<span class="keyword">\quad</span> 表说明 *表说明采用黑体* &#125;</span><br><span class="line"><span class="keyword">\vspace</span> &#123;-2.5mm&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;center&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabular&#125;&#123;ll&#125;</span><br><span class="line"><span class="keyword">\toprule</span></span><br><span class="line">*示例表格*<span class="built_in">&amp;</span>*第1行为表头,表头要有内容* <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\hline</span></span><br><span class="line"><span class="built_in">&amp;</span></span><br><span class="line"> <span class="keyword">\\</span></span><br><span class="line"><span class="built_in">&amp;</span></span><br><span class="line"> <span class="keyword">\\</span></span><br><span class="line"><span class="built_in">&amp;</span></span><br><span class="line"> <span class="keyword">\\</span></span><br><span class="line"><span class="built_in">&amp;</span></span><br><span class="line"> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\bottomrule</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line"><span class="keyword">\label</span>&#123;tab1&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;center&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\heiti</span> 过程X. <span class="keyword">\quad</span> 过程名称</span><br><span class="line"></span><br><span class="line">&#123;<span class="keyword">\zihao</span>&#123;5-&#125;*《计算机学报》的方法过程描述字体为小5号宋体，IF、THEN等伪代码关键词全部用大写字母，变量和函数名称用斜体*&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\heiti</span> 算法<span class="keyword">\textbf</span>&#123;Y&#125; .<span class="keyword">\quad</span> 算法名称.</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\noindent</span> 输入：&#123;<span class="keyword">\ldots</span>&#125; &#123;<span class="keyword">\ldots</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\noindent</span> 输出：&#123;<span class="keyword">\ldots</span>&#125; &#123;<span class="keyword">\ldots</span>&#125;</span><br><span class="line"></span><br><span class="line">*《计算机学报》的算法描述字体为小5号宋体, IF、THEN等伪代码关键词全部用大写字母，变量和函数名称用斜体*&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vspace</span> &#123;3mm&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;&#123;</span><br><span class="line"><span class="keyword">\noindent</span> <span class="keyword">\heiti</span> 致<span class="keyword">\quad</span> 谢 <span class="keyword">\quad</span>  <span class="keyword">\kaishu</span>   *致谢内容.* 致谢 &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\vspace</span> &#123;5mm&#125;</span><br><span class="line"><span class="keyword">\centerline</span></span><br><span class="line">&#123;<span class="keyword">\zihao</span>&#123;5&#125;</span><br><span class="line"><span class="keyword">\heiti</span> 参~考~文~献 &#125;</span><br><span class="line"><span class="keyword">\vspace</span>&#123;7mm&#125;</span><br><span class="line"><span class="keyword">\bibliographystyle</span>&#123;unsrt&#125;</span><br><span class="line"><span class="keyword">\bibliography</span>&#123;references&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">% \begin&#123;thebibliography&#125;&#123;99&#125;</span></span><br><span class="line"><span class="comment">% \zihao&#123;5-&#125; \addtolength&#123;\itemsep&#125;&#123;-1em&#125;</span></span><br><span class="line"><span class="comment">% \vspace&#123;1.5mm&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[1]&#123;1&#125;</span></span><br><span class="line"><span class="comment">% 网上的文献(举例：The Cooperative</span></span><br><span class="line"><span class="comment">% Association for Internet Data Analysis(CAIDA),http://www.caida.org/data</span></span><br><span class="line"><span class="comment">% 2010,7,18) \textbf&#123;*请采用脚注放于正文出现处，每页的脚注从1开始编序号*&#125;\footnote&#123;The Cooperative Association for Internet Data</span></span><br><span class="line"><span class="comment">% Analysis (CAIDA), http://www.caida.org/data 2010, 7, 18&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[2]&#123;2&#125; 中文的参考文献需给出中英文对照。形式如[3]。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[3]&#123;3&#125; Zhou Yong-Bin, Feng Deng-Guo. Design and analysis of cryptographic</span></span><br><span class="line"><span class="comment">% protocols for RFID. Chinese Journal of Computers, 2006, 29(4): 581-589 (in</span></span><br><span class="line"><span class="comment">% Chinese) \newline</span></span><br><span class="line"><span class="comment">% (周永彬, 冯登国. RFID安全协议的设计与分析. 计算机学报, 2006, 29(4): 581-589)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[4]&#123;4&#125; 期刊、会议、书籍名称不能用缩写。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[5]&#123;5&#125; 作者(外国人姓在前，名在后可缩写, 后同).</span></span><br><span class="line"><span class="comment">% 题目(英文题目第一字母大写，其它均小写)：副标题(如果有). 刊名(全称), 年,</span></span><br><span class="line"><span class="comment">% 卷(期): 页码 \textbf&#123;*期刊论文格式*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[6]&#123;6&#125;作者.</span></span><br><span class="line"><span class="comment">% 文章题目(英文题目第1字母大写，其它均小写)：副标题(如果有)//Proceedings of</span></span><br><span class="line"><span class="comment">% the &#123;\ldots&#125; (会议名称). 会议召开城市, 会议召开城市所在国家, 年: 页码</span></span><br><span class="line"><span class="comment">% \textbf&#123;*会议论文集论文格式*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[7]&#123;7&#125;作者. 文章题目(英文题目第一字母大写, 其它均小写):</span></span><br><span class="line"><span class="comment">% 副标题(如果有)//编者. 文集标题. 出版地: 出版社, 出版年: 页码</span></span><br><span class="line"><span class="comment">% \textbf&#123;*文集格式*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[8]&#123;8&#125;作者. 书名: 副标题(如果有). 版次(初版不写). 出版社地点: 出版社,</span></span><br><span class="line"><span class="comment">% 出版年 \textbf&#123;*书籍格式*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[9]&#123;9&#125;作者. 文章题目[博士学位论文/硕士学位论文]. 单位名称,单位地点, 年</span></span><br><span class="line"><span class="comment">% \textbf&#123;*学位论文格式*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[10]&#123;10&#125;作者. 文章题目(英文题目第一字母大写，其它均小写). 单位地点: 单位,</span></span><br><span class="line"><span class="comment">% 技术报告: 报告编号, 年 \textbf&#123;*技术报告*&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% \bibitem[11]&#123;11&#125;专利拥有人. 专利名称，专利授权国家，专利授权日期</span></span><br><span class="line"><span class="comment">% \textbf&#123;*技术专利*&#125;</span></span><br><span class="line"><span class="comment">% \end&#123;thebibliography&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;strip&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;strip&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\noindent</span> &#123;<span class="keyword">\zihao</span>&#123;5&#125;<span class="keyword">\bf</span>&#123;附录X&#125;.&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="keyword">\zihao</span>&#123;5-&#125;<span class="keyword">\setlength</span><span class="keyword">\parindent</span>&#123;2em&#125;</span><br><span class="line">*<span class="keyword">\textbf</span>&#123;附录内容&#125;置于此处，字体为小5号宋体。附录内容包括：<span class="keyword">\textbf</span>&#123;详细的定理证明、公式推导、原始数据&#125;等*&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;strip&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;strip&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;biography&#125;[yourphotofilename.jpg]</span><br><span class="line"><span class="keyword">\noindent</span></span><br><span class="line"><span class="keyword">\textbf</span>&#123;First A. Author&#125;<span class="keyword">\ </span><span class="keyword">\ </span>*计算机学报第1作者提供照片电子图片，尺寸为1寸。英文作者介绍内容包括：出生年,学位(或目前学历),职称,主要研究领域(<span class="keyword">\textbf</span>&#123;与中文作者介绍中的研究方向一致&#125;).*</span><br><span class="line">*字体为小5号Times New Roman*</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;biography&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;biography&#125;[yourphotofilename.jpg]</span><br><span class="line"><span class="keyword">\noindent</span></span><br><span class="line"><span class="keyword">\textbf</span>&#123;Second B. Author&#125; *英文作者介绍内容包括：出生年,学位(或目前学历),职称,主要研究领域(<span class="keyword">\textbf</span>&#123;与中文作者介绍中的研究方向一致&#125;)。*</span><br><span class="line">*字体为小5号Times New Roman*</span><br><span class="line"><span class="keyword">\end</span>&#123;biography&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;strip&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;strip&#125;</span><br><span class="line"><span class="keyword">\zihao</span>&#123;5&#125;</span><br><span class="line"><span class="keyword">\noindent</span> <span class="keyword">\textbf</span>&#123;Background&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\zihao</span>&#123;5-&#125;&#123;</span><br><span class="line"><span class="keyword">\setlength</span><span class="keyword">\parindent</span>&#123;2em&#125;</span><br><span class="line">*论文背景介绍为<span class="keyword">\textbf</span>&#123;英文&#125;，字体为小5号Times New Roman体*</span><br><span class="line"></span><br><span class="line">论文后面为400单词左右的英文背景介绍。介绍的内容包括：</span><br><span class="line"></span><br><span class="line">本文研究的问题属于哪一个领域的什么问题。该类问题目前国际上解决到什么程度。</span><br><span class="line"></span><br><span class="line">本文将问题解决到什么程度。</span><br><span class="line"></span><br><span class="line">课题所属的项目。</span><br><span class="line"></span><br><span class="line">项目的意义。</span><br><span class="line"></span><br><span class="line">本研究群体以往在这个方向上的研究成果。</span><br><span class="line"></span><br><span class="line">本文的成果是解决大课题中的哪一部分，如果涉及863<span class="built_in">$</span><span class="keyword">\backslash</span> <span class="built_in">$</span>973以及其项目、基金、研究计划，注意这些项目的英文名称应书写正确。&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>laTex</tag>
      </tags>
  </entry>
  <entry>
    <title>前端工程化</title>
    <url>/post/fontEnd/factorlizeFont/</url>
    <content><![CDATA[<h1 id="规范化git-commit提交的message"><a href="#规范化git-commit提交的message" class="headerlink" title="规范化git commit提交的message"></a>规范化git commit提交的message</h1><blockquote>
<p>由于各种各样的原因，无论是团队合作还是个人项目，commit历史中总会夹杂着各种简短而不知所谓的message, 不太方便维护，为了缓解这一问题，前端可以使用commitizen包重新调整commit的流程，并实现message的规范化</p>
</blockquote>
<p>1.安装相关包 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g commitizen</span><br><span class="line">npm install -D cz-git</span><br></pre></td></tr></table></figure>

<p>2.在package.json中添加config项, 并在scripts中添加一项</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cmt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;git-cz&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;config&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commitizen&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node_modules/cz-git&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>3.于项目根目录创建文件.commitlintrc.js（如果package.json中的type项值为module的话，文件后缀改为.cjs）</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .commitlintrc.js</span></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">import(&#x27;cz-git&#x27;).UserConfig</span>&#125; */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">        <span class="comment">// @see: https://commitlint.js.org/#/reference-rules</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">prompt</span>: &#123;</span><br><span class="line">        <span class="attr">alias</span>: &#123; <span class="attr">fd</span>: <span class="string">&quot;docs: fix typos&quot;</span> &#125;,</span><br><span class="line">        <span class="attr">messages</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;选择你要提交的类型 :&quot;</span>,</span><br><span class="line">            <span class="attr">scope</span>: <span class="string">&quot;选择一个提交范围（可选）:&quot;</span>,</span><br><span class="line">            <span class="attr">customScope</span>: <span class="string">&quot;请输入自定义的提交范围 :&quot;</span>,</span><br><span class="line">            <span class="attr">subject</span>: <span class="string">&quot;填写简短精炼的变更描述 :\n&quot;</span>,</span><br><span class="line">            <span class="attr">body</span>: <span class="string">&#x27;填写更加详细的变更描述（可选）。使用 &quot;|&quot; 换行 :\n&#x27;</span>,</span><br><span class="line">            <span class="attr">breaking</span>: <span class="string">&#x27;列举非兼容性重大的变更（可选）。使用 &quot;|&quot; 换行 :\n&#x27;</span>,</span><br><span class="line">            <span class="attr">footerPrefixesSelect</span>: <span class="string">&quot;选择关联issue前缀（可选）:&quot;</span>,</span><br><span class="line">            <span class="attr">customFooterPrefix</span>: <span class="string">&quot;输入自定义issue前缀 :&quot;</span>,</span><br><span class="line">            <span class="attr">footer</span>: <span class="string">&quot;列举关联issue (可选) 例如: #31, #I3244 :\n&quot;</span>,</span><br><span class="line">            <span class="attr">confirmCommit</span>: <span class="string">&quot;是否提交或修改commit ?&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">types</span>: [</span><br><span class="line">		        &#123; <span class="attr">value</span>: <span class="string">&quot;新增功能✨&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;新增功能:✨     例如增加了一个新的页面、组件、接口&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;修复缺陷🪲&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;修复缺陷:🪲      例如修复了一个崩溃，逻辑错误，样式问题。&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;文档更新📝&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;文档更新:📝     例如添加了注释，修改了README文件，API文档&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;代码格式💄&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;代码格式:💄     例如调整了缩进，空格，换行，或者括号&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;代码重构♻️&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;代码重构:♻️      例如提取了函数，合并了两个类，或者移动了文件&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;性能提升⚡️&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;性能提升:⚡     ️例如减少了内存占用，提高了运行速度，或者减少了网络请求&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;持续集成🎡&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;持续集成:🎡     例如添加了一个测试用例，修改了一个构建脚本，或者更新了一个依赖库&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;回退代码🔙&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;回退代码:🔙     撤销了之前的一次或多次提交&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;其他修改🧹&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;其他修改:🧹     例如修改了一些配置文件，删除了一些无用的代码，或者添加了一些日志。&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;合并分支🎋&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;合并分支:🎋     合并了两个或多个分支的代码&quot;</span> &#125;,   </span><br><span class="line">				],</span><br><span class="line">        <span class="comment">// 是否使用Emoji</span></span><br><span class="line">        <span class="attr">useEmoji</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">emojiAlign</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">        <span class="attr">useAI</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">aiNumber</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">themeColorCode</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">scopes</span>: [],</span><br><span class="line">        <span class="attr">allowCustomScopes</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">allowEmptyScopes</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">customScopesAlign</span>: <span class="string">&quot;bottom&quot;</span>,</span><br><span class="line">        <span class="attr">customScopesAlias</span>: <span class="string">&quot;custom&quot;</span>,</span><br><span class="line">        <span class="attr">emptyScopesAlias</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">        <span class="attr">upperCaseSubject</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">markBreakingChangeMode</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">allowBreakingChanges</span>: [<span class="string">&quot;feat&quot;</span>, <span class="string">&quot;fix&quot;</span>],</span><br><span class="line">        <span class="attr">breaklineNumber</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">breaklineChar</span>: <span class="string">&quot;|&quot;</span>,</span><br><span class="line">        <span class="attr">skipQuestions</span>: [],</span><br><span class="line">        <span class="attr">issuePrefixes</span>: [</span><br><span class="line">            <span class="comment">// 如果使用 gitee 作为开发管理</span></span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;link&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;link:     链接 ISSUES 进行中&quot;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="string">&quot;closed&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;closed:   标记 ISSUES 已完成&quot;</span> &#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">customIssuePrefixAlign</span>: <span class="string">&quot;top&quot;</span>,</span><br><span class="line">        <span class="attr">emptyIssuePrefixAlias</span>: <span class="string">&quot;skip&quot;</span>,</span><br><span class="line">        <span class="attr">customIssuePrefixAlias</span>: <span class="string">&quot;custom&quot;</span>,</span><br><span class="line">        <span class="attr">allowCustomIssuePrefix</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">allowEmptyIssuePrefix</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">confirmColorize</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">maxHeaderLength</span>: <span class="title class_">Infinity</span>,</span><br><span class="line">        <span class="attr">maxSubjectLength</span>: <span class="title class_">Infinity</span>,</span><br><span class="line">        <span class="attr">minSubjectLength</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">scopeOverrides</span>: <span class="literal">undefined</span>,</span><br><span class="line">        <span class="attr">defaultBody</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">defaultIssues</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">defaultScope</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">defaultSubject</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>之后，将 npm cmt代替git commit使用</p>
<p>效果如图<br><img src="https://img-blog.csdnimg.cn/2de648ce078546c7b1927785959bd030.jpeg#pic_center" alt="终端内容"><br><img src="https://img-blog.csdnimg.cn/b2f710efa8a846ab875c2f3b1cf1f3ad.jpeg#pic_center" alt="github上的显示"></p>
<h1 id="commit时自动检查以及格式化代码"><a href="#commit时自动检查以及格式化代码" class="headerlink" title="commit时自动检查以及格式化代码"></a>commit时自动检查以及格式化代码</h1><blockquote>
<p>在编写代码时可能为了快捷，并没有注意代码的格式，比如缩进、空格等，单人项目还好，对自己的代码风格较为熟悉，可当项目为多人协作开发时，这会导致合作时的不便，因此就有了husky，在commit时自动处理代码</p>
</blockquote>
<blockquote>
<p>husky通过给git添加hook来实现为git添加功能，理论上来说它所能做的远不只自动格式化代码</p>
</blockquote>
<p>1.下载对应的包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">//一步到位式，向package.json添加scripts，并创建了一个样例hook，并配置了hook的path</span><br><span class="line">	//npm</span><br><span class="line">	npx husky-init &amp;&amp; npm install</span><br><span class="line">	//pnpm</span><br><span class="line">	pnpm dlx husky-init &amp;&amp; pnpm install</span><br><span class="line"></span><br><span class="line">//逐步式</span><br><span class="line">npm install husky --save-dev</span><br><span class="line">npx husky install</span><br><span class="line">npm pkg <span class="built_in">set</span> scripts.prepare=<span class="string">&quot;husky install&quot;</span></span><br></pre></td></tr></table></figure>

<p>1.5(可选)新建hook</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx husky add filename <span class="string">&quot;命令&quot;</span></span><br><span class="line">//例如npx husky add .husky/pre-commit <span class="string">&quot;npm test&quot;</span></span><br><span class="line">//命令（npm <span class="built_in">test</span>）执行失败时自动中断commit</span><br></pre></td></tr></table></figure>

<p>不难发现，husky的作用只是在git某一个命令执行前&#x2F;中&#x2F;后执行另外一个指定命令。因此实际上除前端以外，后端、或者算法也能够使用husky来规范化团队的git</p>
<p>而我们目前希望它做的是commit前格式化代码，因此我们需要一个将代码格式化的命令</p>
<p>在此，我使用的是Prettier包与lint-staged</p>
<p>Prettier是一个前端的代码格式化包，能够格式化<em>JavaScript · TypeScript · Flow · JSX · JSONCSS · SCSS · LessHTML · Vue · AngularGraphQL · Markdown · YAML。</em>可谓是非常满足前端的需要</p>
<p>而lint-staged是代码检查器，检查代码是否有语法错误，其github主页的about为“🚫💩 — Run linters on git staged files”, 可见该包是用来缓解💩 山构建过程的</p>
<p>2.下载Prettier与lint-staged</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i --save-dev prettier lint-staged</span><br></pre></td></tr></table></figure>

<p>3.项目根目录下创建文件.prettierrc.json 与 .prettierignore。内容空白即可，若需要自定义配置，请参考官方文档 <a href="https://prettier.io/docs/en/install">Install · Prettier</a></p>
<p>4.整合husky、Prettier以及lint-staged</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">//npm</span><br><span class="line">npx husky add .husky/pre-commit <span class="string">&quot;npx lint-staged&quot;</span></span><br><span class="line"></span><br><span class="line">//pnpm</span><br><span class="line">pnpm <span class="built_in">exec</span> husky add .husky/pre-commit <span class="string">&quot;pnpm exec lint-staged&quot;</span></span><br></pre></td></tr></table></figure>

<p>并且在package.json中添加内容</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;lint-staged&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;**/*&quot;</span><span class="punctuation">:</span> <span class="string">&quot;prettier --write --ignore-unknown&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>完成！现在git的整个流程如图<br><img src="https://img-blog.csdnimg.cn/7e07847eed60432ab69cdf76e96ca121.png" alt="在这里插入图片描述"></p>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>工程化</tag>
      </tags>
  </entry>
  <entry>
    <title>电脑应用</title>
    <url>/post/other/%E7%94%B5%E8%84%91%E5%BA%94%E7%94%A8%20/</url>
    <content><![CDATA[<blockquote>
<p>随着在电脑上安装的工具越来越多，对自己的小破电脑也越来越喜欢，因此打算记录下这台电脑上的工具配置，以便以后更换电脑时能很快的回归现在的使用习惯。</p>
</blockquote>
<h1 id="效率工具"><a href="#效率工具" class="headerlink" title="效率工具"></a>效率工具</h1><h2 id="MyKeymap"><a href="#MyKeymap" class="headerlink" title="MyKeymap"></a>MyKeymap</h2><p>官网：<a href="https://xianyukang.com/MyKeymap.html">MyKeymap 简介 | 咸鱼阿康 (xianyukang.com)</a></p>
<p>超级好用的快捷键工具，将大写锁定键更改为命令前置键，然后使用快捷命令启动程序&amp;召唤窗口&amp;控制系统&amp;自定义的按键映射。新机必装！！</p>
<h1 id="编程工具"><a href="#编程工具" class="headerlink" title="编程工具"></a>编程工具</h1><h2 id="Vscode"><a href="#Vscode" class="headerlink" title="Vscode"></a>Vscode</h2><p>官网：<a href="https://code.visualstudio.com/">Visual Studio Code - Code Editing. Redefined</a></p>
<p>宇宙IDE,没什么好说的</p>
<h2 id="Pycharm-IDEA-Android-Studio-微信开发者工具"><a href="#Pycharm-IDEA-Android-Studio-微信开发者工具" class="headerlink" title="Pycharm&#x2F;IDEA&#x2F;Android Studio&#x2F;微信开发者工具"></a>Pycharm&#x2F;IDEA&#x2F;Android Studio&#x2F;微信开发者工具</h2><p>python&#x2F;java&#x2F;安卓&#x2F;微信小程序 的开发工具。Vscode其实一个也够了，但纯爱战神不接受一个IDE写两种语言😡</p>
<h2 id="Postman"><a href="#Postman" class="headerlink" title="Postman"></a>Postman</h2><p>官网： <a href="https://www.postman.com/downloads/">Download Postman | Get Started for Free</a></p>
<p>调接口的优秀应用</p>
<h2 id="Burp-suit-Proxifier"><a href="#Burp-suit-Proxifier" class="headerlink" title="Burp suit&amp;Proxifier"></a>Burp suit&amp;Proxifier</h2><p>抓包两兄弟，Proxifier负责转接请求，Burp suit负责查看&#x2F;修改请求</p>
<h2 id="Mysql-Navicate"><a href="#Mysql-Navicate" class="headerlink" title="Mysql&amp;Navicate"></a>Mysql&amp;Navicate</h2><p>数据库与管理平台</p>
<h2 id="Xshell"><a href="#Xshell" class="headerlink" title="Xshell"></a>Xshell</h2><p>服务器连接器</p>
<h1 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h1><h2 id="Notion"><a href="#Notion" class="headerlink" title="Notion"></a>Notion</h2><p>官网：<a href="https://www.notion.so/zh-cn">Notion – The all-in-one workspace for your notes, tasks, wikis, and databases.</a></p>
<p>攥写文稿，类似Word, 但无论从界面美观度或是功能都薄纱Word。</p>
<h2 id="V2ray-Clash"><a href="#V2ray-Clash" class="headerlink" title="V2ray&#x2F;Clash"></a>V2ray&#x2F;Clash</h2><p>走向世界的大门</p>
<h2 id="IDM"><a href="#IDM" class="headerlink" title="IDM"></a>IDM</h2><p><a href="https://www.internetdownloadmanager.com/">Internet Download Manager: The fastest download accelerator</a></p>
<p>下载工具</p>
<h2 id="spaceSinffer"><a href="#spaceSinffer" class="headerlink" title="spaceSinffer"></a>spaceSinffer</h2><p>官网：<a href="http://www.uderzo.it/main_products/space_sniffer/">SpaceSniffer, find lost disk space the easy way. (uderzo.it)</a></p>
<p>图像化地了解谁占了你的硬盘空间</p>
<h2 id="Verycapture"><a href="#Verycapture" class="headerlink" title="Verycapture"></a>Verycapture</h2><p>官网：<a href="https://verycapture.com/cn/index.html">verycapture - 音视频解决方案</a></p>
<p>截图工具，功能多过window自带的截图</p>
<h2 id="BandicamPortable"><a href="#BandicamPortable" class="headerlink" title="BandicamPortable"></a>BandicamPortable</h2><p>官网：<a href="https://www.bandicam.cn/">[官方]Bandicam（班迪录屏）高清电脑屏幕录制软件</a></p>
<p>录屏工具</p>
<h1 id="无需多言的应用"><a href="#无需多言的应用" class="headerlink" title="无需多言的应用"></a>无需多言的应用</h1><table>
<thead>
<tr>
<th>qq&amp;微信</th>
</tr>
</thead>
<tbody><tr>
<td>腾讯会议</td>
</tr>
<tr>
<td>steam</td>
</tr>
<tr>
<td>Edge&#x2F;Chrome</td>
</tr>
<tr>
<td>百度网盘</td>
</tr>
</tbody></table>
<h1 id="Edge插件"><a href="#Edge插件" class="headerlink" title="Edge插件"></a>Edge插件</h1><h2 id="暴力猴-篡改猴"><a href="#暴力猴-篡改猴" class="headerlink" title="暴力猴&amp;篡改猴"></a>暴力猴&amp;篡改猴</h2><p>两个脚本插件</p>
<h2 id="Global-Speed"><a href="#Global-Speed" class="headerlink" title="Global Speed"></a>Global Speed</h2><p>控制视频播放速度</p>
<h2 id="Wappalyzer"><a href="#Wappalyzer" class="headerlink" title="Wappalyzer"></a>Wappalyzer</h2><p>显示网页使用的技术框架</p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>App</tag>
      </tags>
  </entry>
  <entry>
    <title>搜索の技巧</title>
    <url>/post/forAll/%E6%90%9C%E7%B4%A2%E3%81%AE%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<blockquote>
<p>💡 要成为一名合格的cv工程师，搜索是极为重要的技能。我这方面似乎还比较欠缺，每次搜索能否找到期望的结果基本取决于运气。自认为不能这样下去了，所以拿了一段时间来专门学习搜索的技巧，故有此文。</p>
</blockquote>
<h1 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h1><table>
<thead>
<tr>
<th>关键字&#x2F;符号</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>“”</td>
<td>搜索结果中必须出现与“”中内容完全相同的部分</td>
</tr>
<tr>
<td>A -B</td>
<td>搜索包含A但不包含B的结果（请注意A后面的空格不能省略）</td>
</tr>
<tr>
<td>site:</td>
<td>在某个网站内搜索，比如：site:<a href="https://link.zhihu.com/?target=http://pan.baidu.com">https://link.zhihu.com/?target=http%3A//pan.baidu.com</a></td>
</tr>
<tr>
<td>info:</td>
<td>搜索指定网站的一些基本信息。</td>
</tr>
</tbody></table>
<h1 id="github搜索"><a href="#github搜索" class="headerlink" title="github搜索"></a>github搜索</h1><blockquote>
<p>官方文档见：<a href="https://docs.github.com/zh/search-github/getting-started-with-searching-on-github/about-searching-on-github">关于在 GitHub 上搜索 - GitHub 文档</a></p>
</blockquote>
<h2 id="范围查询"><a href="#范围查询" class="headerlink" title="范围查询"></a>范围查询</h2><table>
<thead>
<tr>
<th>示例</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>vue stars:&gt;1000</td>
<td>匹配含有 vue，stars数大于1000的仓库</td>
</tr>
<tr>
<td>vue topics:&gt;&#x3D;5</td>
<td>有5个或更多主题的仓库</td>
</tr>
<tr>
<td>vue size:&lt;10000</td>
<td>匹配含有“vue”字样代码且大小小于10kb的文件</td>
</tr>
<tr>
<td>vue created&lt;&#x3D;<em>YYYY</em>-<em>MM</em>-<em>DD</em></td>
<td>日期前创建的议题，除created外，还有pushed</td>
</tr>
<tr>
<td>vue stars:10…*</td>
<td>star大于等于10</td>
</tr>
<tr>
<td>vue stars:*…10</td>
<td>小于等于10</td>
</tr>
<tr>
<td>vue stars:10…50</td>
<td>10到50</td>
</tr>
</tbody></table>
<h2 id="搜索属性"><a href="#搜索属性" class="headerlink" title="搜索属性"></a>搜索属性</h2><table>
<thead>
<tr>
<th>属性名</th>
<th>解释</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>stars</td>
<td>stars数</td>
<td>int</td>
</tr>
<tr>
<td>topics</td>
<td>主题数</td>
<td>int&#x2F;string</td>
</tr>
<tr>
<td>size</td>
<td>文件大小</td>
<td>int</td>
</tr>
<tr>
<td>framework</td>
<td>框架</td>
<td>string</td>
</tr>
<tr>
<td>language</td>
<td>语言</td>
<td>string</td>
</tr>
<tr>
<td>author</td>
<td>作者</td>
<td>string</td>
</tr>
<tr>
<td>org</td>
<td>组织</td>
<td>string</td>
</tr>
<tr>
<td>forks</td>
<td>forks数</td>
<td>int</td>
</tr>
<tr>
<td>followers</td>
<td>关注者</td>
<td>int</td>
</tr>
<tr>
<td>extension</td>
<td></td>
<td>string</td>
</tr>
<tr>
<td>license</td>
<td>许可证</td>
<td>string</td>
</tr>
<tr>
<td>is</td>
<td>仓库公共还是私有</td>
<td>public&#x2F;privat</td>
</tr>
<tr>
<td>mirror</td>
<td>是否为镜像</td>
<td>bool</td>
</tr>
<tr>
<td>archived</td>
<td>是否已存档</td>
<td>bool</td>
</tr>
<tr>
<td>help-wanted-issues</td>
<td>标签为该属性的议题数</td>
<td>int</td>
</tr>
<tr>
<td>good-first-issues</td>
<td>标签为该属性的议题数</td>
<td>int</td>
</tr>
</tbody></table>
<h2 id="搜索位置"><a href="#搜索位置" class="headerlink" title="搜索位置"></a>搜索位置</h2><table>
<thead>
<tr>
<th>示例</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>vue in:name</td>
<td>名称含有vue</td>
</tr>
<tr>
<td>vue in:name,description</td>
<td>名称与说明</td>
</tr>
<tr>
<td>vue in:readme</td>
<td></td>
</tr>
</tbody></table>
<h2 id="排除"><a href="#排除" class="headerlink" title="排除"></a>排除</h2><table>
<thead>
<tr>
<th>示例</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>hello NOT world</td>
<td>匹配含有hello不含world的仓库</td>
</tr>
<tr>
<td>vue -language:javascript</td>
<td>排除以js编写的仓库</td>
</tr>
</tbody></table>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><table>
<thead>
<tr>
<th>示例</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>cats NOT “hello world”</td>
<td>含有空格的查询需要被引号包裹起来</td>
</tr>
</tbody></table>
<h2 id="使用可视界面搜索"><a href="#使用可视界面搜索" class="headerlink" title="使用可视界面搜索"></a>使用可视界面搜索</h2><p><a href="https://github.com/search/advanced">https://github.com/search/advanced</a></p>
<h2 id="Issue搜索"><a href="#Issue搜索" class="headerlink" title="Issue搜索"></a>Issue搜索</h2><table>
<thead>
<tr>
<th>encoding user:heroku</th>
<th>Encoding issues across the Heroku organization.</th>
</tr>
</thead>
<tbody><tr>
<td>cat is:open</td>
<td>Find cat issues that are open.</td>
</tr>
<tr>
<td>strange comments:&gt;42</td>
<td>Issues with more than 42 comments.</td>
</tr>
<tr>
<td>hard label:bug</td>
<td>Hard issues labeled as a bug.</td>
</tr>
<tr>
<td>author:mojombo</td>
<td>All issues authored by mojombo.</td>
</tr>
<tr>
<td>mentions:tpope</td>
<td>All issues mentioning tpope.</td>
</tr>
<tr>
<td>assignee:rtomayko</td>
<td>All issues assigned to rtomayko.</td>
</tr>
<tr>
<td>exception created:&gt;2012-12-31</td>
<td>Created since the beginning of 2013.</td>
</tr>
<tr>
<td>exception updated:&lt;2013-01-01</td>
<td>Last updated before 2013.</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>综合</category>
      </categories>
      <tags>
        <tag>搜索</tag>
      </tags>
  </entry>
  <entry>
    <title>beautifulSoup与openpyxl的初步学习</title>
    <url>/post/python/beautifulSoup%E4%B8%8Eopenpyxl%E7%9A%84%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<blockquote>
<p>出于公司要求，需要爬取一个网站的信息，所以临时学一下爬虫</p>
</blockquote>
<blockquote>
<p>试验网址：<a href="http://www.xiaoyuanzhaopin.net/bjsyxx/">http://www.xiaoyuanzhaopin.net/bjsyxx/</a></p>
</blockquote>
<h1 id="通过ai获取初步代码"><a href="#通过ai获取初步代码" class="headerlink" title="通过ai获取初步代码"></a>通过ai获取初步代码</h1><p>根据文档学完代码后总会感觉有些不知道从何开始，所以这次尝试根据代码学代码，一边改一边学。而初步的代码，打算从ai那里获得。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">prompt:</span><br><span class="line">我需要从网址“http://www.xiaoyuanzhaopin.net/bjsyxx/”获取信息，请你为我设计一个爬虫。这个网页的结构如下：</span><br><span class="line">该网页中具有多个&lt;table&gt;标签，每个&lt;table&gt;标签有子元素&lt;tbody&gt;，&lt;tbody&gt;的子元素是数个&lt;tr&gt;,每个&lt;tr&gt;有一个子元素&lt;td&gt;,&lt;td&gt;标签中有两个子&lt;a&gt;标签。我需要的内容在第二个&lt;a&gt;标签跳转到的页面中。</span><br><span class="line">跳转到的页面有两处含有我需要的信息：</span><br><span class="line">第一处：一个class为“entry-header”的&lt;header&gt;标签，其中有一个class为”entry-title”的&lt;h1&gt;标签，我需要这个&lt;h1&gt;标签内的text。</span><br><span class="line">第二处：一个class为”entry-content”的&lt;div&gt;标签，其子元素是多个&lt;p&gt;标签以及一个&lt;figure&gt;标签。&lt;p&gt;标签中要么仅含有text,要么含有一个&lt;a&gt;标签。如果仅含有text，则提取text；如果是&lt;a&gt;标签，则同时保留&lt;a&gt;标签中的text以及链接。&lt;figure&gt;标签中含有一个&lt;tbody&gt;，&lt;tbody&gt;中含有多个&lt;tr&gt;，每个&lt;tr&gt;中有一个&lt;td&gt;,每个&lt;td&gt;中有一个&lt;a&gt;，我需要&lt;a&gt;中的text以及链接。</span><br><span class="line">最终以json格式输出，json中键值说明如下：</span><br><span class="line">1.title: 值为&lt;h1&gt;标签中的text,类型为string</span><br><span class="line">2.content: 值为&lt;p&gt;标签中的内容，类型为&#123;title2 : string, src : string&#125;，title2为&lt;p&gt;标签或其中&lt;a&gt;标签的text, src为&lt;a&gt;标签跳转的链接，如过没有a标签则为””。</span><br><span class="line">3.addContent:值为&lt;figure&gt;中的&lt;a&gt;的内容，类型为&#123;title3 : string, src : string&#125;。title3为&lt;a&gt;标签的text, src为&lt;a&gt;标签跳转的链接</span><br><span class="line">如果你还有什么疑问，请提出，如果没有，请帮我生成相应代码。</span><br></pre></td></tr></table></figure>
<p>AI的回复如下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数来提取目标信息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_info</span>(<span class="params">url</span>):</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;无法访问网页: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取标题信息</span></span><br><span class="line">    title = soup.find(<span class="string">&#x27;h1&#x27;</span>, class_=<span class="string">&#x27;entry-title&#x27;</span>).text.strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取内容信息</span></span><br><span class="line">    content = []</span><br><span class="line">    content_div = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;entry-content&#x27;</span>)</span><br><span class="line">    paragraphs = content_div.find_all(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> paragraph <span class="keyword">in</span> paragraphs:</span><br><span class="line">        <span class="keyword">if</span> paragraph.a:</span><br><span class="line">            content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title2&#x27;</span>: paragraph.a.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: paragraph.a[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">            &#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title2&#x27;</span>: paragraph.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取附加内容信息</span></span><br><span class="line">    add_content = []</span><br><span class="line">    figure = content_div.find(<span class="string">&#x27;figure&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> figure:</span><br><span class="line">        figure_links = figure.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> figure_links:</span><br><span class="line">            add_content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title3&#x27;</span>: link.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: link[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将结果以JSON格式输出</span></span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;title&#x27;</span>: title,</span><br><span class="line">        <span class="string">&#x27;content&#x27;</span>: content,</span><br><span class="line">        <span class="string">&#x27;addContent&#x27;</span>: add_content</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取主页面中的所有链接</span></span><br><span class="line">main_url = <span class="string">&quot;http://www.xiaoyuanzhaopin.net/bjsyxx/&quot;</span></span><br><span class="line">main_response = requests.get(main_url)</span><br><span class="line">main_soup = BeautifulSoup(main_response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">main_links = main_soup.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储所有网页的信息</span></span><br><span class="line">all_results = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历每个链接并提取信息</span></span><br><span class="line"><span class="keyword">for</span> link <span class="keyword">in</span> main_links:</span><br><span class="line">    link_url = link.get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> link_url <span class="keyword">and</span> link_url.startswith(<span class="string">&#x27;http&#x27;</span>):</span><br><span class="line">        result = extract_info(link_url)</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            all_results.append(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将所有结果以JSON格式输出</span></span><br><span class="line">output_json = json.dumps(all_results, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(output_json)</span><br></pre></td></tr></table></figure>

<p>gpt确实很厉害，大概的轮廓一下子就出来了。</p>
<h1 id="根据遇到的问题修改代码"><a href="#根据遇到的问题修改代码" class="headerlink" title="根据遇到的问题修改代码"></a>根据遇到的问题修改代码</h1><p>在尝试运行的过程中，发现了一系列的问题，但从 gpt生成的初步代码已然能看出函数的用法，于是尝试照着规律修改代码，并且再次询问了一次gpt，使结果会输出到一个excel的表格中。最终代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, Alignment, Border, Side</span><br><span class="line"><span class="keyword">from</span> openpyxl.utils <span class="keyword">import</span> get_column_letter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数来提取目标信息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_info</span>(<span class="params">url,position</span>):</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;无法访问网页: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取标题信息</span></span><br><span class="line">    title = soup.find(<span class="string">&#x27;h1&#x27;</span>, class_=<span class="string">&#x27;entry-title&#x27;</span>).text.strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取内容信息</span></span><br><span class="line">    content = []</span><br><span class="line">    content_div = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;entry-content&#x27;</span>)</span><br><span class="line">    paragraphs = content_div.find_all(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> paragraph <span class="keyword">in</span> paragraphs:</span><br><span class="line">        <span class="keyword">if</span> paragraph.a:</span><br><span class="line">            links = paragraph.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">                content.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;title&#x27;</span>: link.text.strip(),</span><br><span class="line">                    <span class="string">&#x27;src&#x27;</span>: link[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> paragraph.img:</span><br><span class="line">            imgs = paragraph.find_all(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line">            i = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> imgs:</span><br><span class="line">                content.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;图片&#x27;</span>+ <span class="built_in">str</span>(i) +<span class="string">&#x27;-&#x27;</span>+title,</span><br><span class="line">                    <span class="string">&#x27;src&#x27;</span>: img[<span class="string">&#x27;src&#x27;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line">                i=i+<span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: paragraph.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">    ulists = content_div.find(<span class="string">&#x27;ul&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(ulists):</span><br><span class="line">        ulistsrcs = ulists.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> ulistsrc <span class="keyword">in</span> ulistsrcs:</span><br><span class="line">            content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: ulistsrc.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: ulistsrc[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">            &#125;)</span><br><span class="line">    olists = content_div.find(<span class="string">&#x27;ol&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(olists):</span><br><span class="line">        olistsrcs = olists.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> olistsrc <span class="keyword">in</span> olistsrcs:</span><br><span class="line">            content.append(&#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: olistsrc.text.strip(),</span><br><span class="line">                <span class="string">&#x27;src&#x27;</span>: olistsrc[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">            &#125;)</span><br><span class="line">    <span class="comment"># 提取附加内容信息</span></span><br><span class="line">    figures = content_div.find_all(<span class="string">&#x27;figure&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> figures:</span><br><span class="line">        <span class="keyword">for</span> figure <span class="keyword">in</span> figures:</span><br><span class="line">            figure_links = figure.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            len_links = <span class="built_in">len</span>(figure_links)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_links - <span class="number">1</span>):</span><br><span class="line">                content.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;title&#x27;</span>: figure_links[i].text.strip(),</span><br><span class="line">                    <span class="string">&#x27;src&#x27;</span>: figure_links[i][<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将结果以JSON格式输出</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(content)!= <span class="number">0</span>:</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">&#x27;title&#x27;</span>: title,</span><br><span class="line">            <span class="string">&#x27;content&#x27;</span>: content,</span><br><span class="line">            <span class="string">&#x27;position&#x27;</span>:position,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    errschool.append(title)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储所有网页的信息</span></span><br><span class="line">all_results = []</span><br><span class="line"><span class="comment"># 储存出现问题的学校</span></span><br><span class="line">errschool = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">creat_excel</span>(<span class="params">data,location</span>):</span><br><span class="line">    <span class="comment"># 创建一个新的Excel工作簿</span></span><br><span class="line">    workbook = openpyxl.Workbook()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个新的工作表</span></span><br><span class="line">    worksheet = workbook.active</span><br><span class="line">    worksheet.title = <span class="string">&quot;Data&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义样式</span></span><br><span class="line">    title_font = Font(size=<span class="number">12</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    title_alignment = Alignment(vertical=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    url_font = Font(color=<span class="string">&quot;0000FF&quot;</span>, underline=<span class="string">&quot;single&quot;</span>)</span><br><span class="line">    border = Border(left=Side(style=<span class="string">&#x27;thin&#x27;</span>), right=Side(style=<span class="string">&#x27;thin&#x27;</span>), top=Side(style=<span class="string">&#x27;thin&#x27;</span>),</span><br><span class="line">                    bottom=Side(style=<span class="string">&#x27;thin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入表头</span></span><br><span class="line">    worksheet[<span class="string">&#x27;A1&#x27;</span>] = <span class="string">&quot;学校&quot;</span></span><br><span class="line">    worksheet[<span class="string">&#x27;B1&#x27;</span>] = <span class="string">&quot;位置&quot;</span></span><br><span class="line">    worksheet[<span class="string">&#x27;C1&#x27;</span>] = <span class="string">&quot;内容&quot;</span></span><br><span class="line">    worksheet[<span class="string">&#x27;D1&#x27;</span>] = <span class="string">&quot;链接&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#设置样式</span></span><br><span class="line">    <span class="keyword">for</span> col_letter <span class="keyword">in</span> [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>]:</span><br><span class="line">        cell = worksheet[<span class="string">f&#x27;<span class="subst">&#123;col_letter&#125;</span>1&#x27;</span>]</span><br><span class="line">        cell.font = title_font</span><br><span class="line">        cell.alignment = title_alignment</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入数据</span></span><br><span class="line">    row_num = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        title = item[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        position = item[<span class="string">&#x27;position&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取相同标题的结束行号</span></span><br><span class="line">        end_row = row_num + <span class="built_in">len</span>(item[<span class="string">&#x27;content&#x27;</span>]) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> content_item <span class="keyword">in</span> item[<span class="string">&#x27;content&#x27;</span>]:</span><br><span class="line">            content_title = content_item[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">            content_src = content_item[<span class="string">&#x27;src&#x27;</span>]</span><br><span class="line"></span><br><span class="line">            worksheet[<span class="string">f&#x27;A<span class="subst">&#123;row_num&#125;</span>&#x27;</span>] = title</span><br><span class="line">            worksheet[<span class="string">f&#x27;B<span class="subst">&#123;row_num&#125;</span>&#x27;</span>] = position</span><br><span class="line">            worksheet[<span class="string">f&#x27;C<span class="subst">&#123;row_num&#125;</span>&#x27;</span>] = content_title</span><br><span class="line">            worksheet[<span class="string">f&#x27;D<span class="subst">&#123;row_num&#125;</span>&#x27;</span>] = content_src</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 设置单元格样式</span></span><br><span class="line">            <span class="keyword">for</span> col_letter <span class="keyword">in</span> [<span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]:</span><br><span class="line">                cell = worksheet[<span class="string">f&#x27;<span class="subst">&#123;col_letter&#125;</span><span class="subst">&#123;row_num&#125;</span>&#x27;</span>]</span><br><span class="line">                cell.border = border</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> col_letter <span class="keyword">in</span> [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]:</span><br><span class="line">                cell = worksheet[<span class="string">f&#x27;<span class="subst">&#123;col_letter&#125;</span><span class="subst">&#123;row_num&#125;</span>&#x27;</span>]</span><br><span class="line">                cell.border = border</span><br><span class="line">                cell.alignment = title_alignment</span><br><span class="line">                cell.font = title_font</span><br><span class="line">            <span class="comment"># 设置链接样式</span></span><br><span class="line">            worksheet[<span class="string">f&#x27;D<span class="subst">&#123;row_num&#125;</span>&#x27;</span>].font = url_font</span><br><span class="line">            worksheet[<span class="string">f&#x27;D<span class="subst">&#123;row_num&#125;</span>&#x27;</span>].hyperlink = content_src</span><br><span class="line"></span><br><span class="line">            row_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 合并相同标题的单元格</span></span><br><span class="line">        worksheet.merge_cells(<span class="string">f&#x27;A<span class="subst">&#123;row_num - <span class="built_in">len</span>(item[<span class="string">&quot;content&quot;</span>])&#125;</span>:A<span class="subst">&#123;end_row&#125;</span>&#x27;</span>)</span><br><span class="line">        worksheet.merge_cells(<span class="string">f&#x27;B<span class="subst">&#123;row_num - <span class="built_in">len</span>(item[<span class="string">&quot;content&quot;</span>])&#125;</span>:B<span class="subst">&#123;end_row&#125;</span>&#x27;</span>)</span><br><span class="line">        row_num += <span class="number">1</span>  <span class="comment"># 换行</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> column <span class="keyword">in</span> worksheet.columns:</span><br><span class="line">        max_length = <span class="number">0</span></span><br><span class="line">        column = [cell <span class="keyword">for</span> cell <span class="keyword">in</span> column]</span><br><span class="line">        <span class="keyword">for</span> cell <span class="keyword">in</span> column:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(cell.value)) &gt; max_length:</span><br><span class="line">                    max_length = <span class="built_in">len</span>(cell.value)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        adjusted_width = (max_length + <span class="number">2</span>)</span><br><span class="line">        worksheet.column_dimensions[get_column_letter(column[<span class="number">0</span>].column)].width = adjusted_width</span><br><span class="line">    worksheet.column_dimensions[<span class="string">&#x27;A&#x27;</span>].width = <span class="number">32</span></span><br><span class="line">    worksheet.column_dimensions[<span class="string">&#x27;B&#x27;</span>].width = <span class="number">9</span></span><br><span class="line">    worksheet.column_dimensions[<span class="string">&#x27;C&#x27;</span>].width = <span class="number">60</span></span><br><span class="line">    <span class="comment"># 指定输出的Excel文件路径</span></span><br><span class="line">    output_excel_path = <span class="string">f&#x27;./excelInfo/<span class="subst">&#123;location&#125;</span>.xlsx&#x27;</span></span><br><span class="line">    <span class="comment"># 保存Excel文件</span></span><br><span class="line">    workbook.save(output_excel_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;数据已成功写入 <span class="subst">&#123;output_excel_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">creat_json</span>(<span class="params">data,location</span>):</span><br><span class="line">    <span class="comment"># 将数据写入 JSON 文件</span></span><br><span class="line">    output_file_path = <span class="string">f&#x27;./jsonInfo/<span class="subst">&#123;location&#125;</span>.json&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> json_file:</span><br><span class="line">        json.dump(data, json_file, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;数据已成功写入 <span class="subst">&#123;output_file_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按间距中的绿色按钮以运行脚本。</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># result = extract_info(&#x27;http://www.xiaoyuanzhaopin.net/tsinghua-syxx/&#x27;)</span></span><br><span class="line">    main_url = <span class="string">&quot;http://www.xiaoyuanzhaopin.net/fjsyxx/&quot;</span></span><br><span class="line">    location = <span class="string">&#x27;福建&#x27;</span></span><br><span class="line">    main_response = requests.get(main_url)</span><br><span class="line">    main_soup = BeautifulSoup(main_response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    main_content = main_soup.find(<span class="string">&#x27;div&#x27;</span>,class_=<span class="string">&#x27;entry-content&#x27;</span>)</span><br><span class="line">    tables = main_content.find_all(<span class="string">&#x27;table&#x27;</span>)</span><br><span class="line">    main_links=[]</span><br><span class="line">    <span class="keyword">for</span> table <span class="keyword">in</span> tables:</span><br><span class="line">        <span class="comment"># 查找&lt;td&gt;标签</span></span><br><span class="line">        td_elements = table.find_all(<span class="string">&#x27;td&#x27;</span>)</span><br><span class="line">        <span class="comment"># 提取&lt;td&gt;标签中的&lt;a&gt;标签</span></span><br><span class="line">        <span class="keyword">for</span> td <span class="keyword">in</span> td_elements:</span><br><span class="line">            a_elements = td.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(a_elements)==<span class="number">2</span>:</span><br><span class="line">                link = &#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: a_elements[<span class="number">0</span>].text.strip(),</span><br><span class="line">                    <span class="string">&#x27;text&#x27;</span>: a_elements[<span class="number">1</span>].text.strip(),</span><br><span class="line">                    <span class="string">&#x27;href&#x27;</span>: a_elements[<span class="number">1</span>][<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">                &#125;</span><br><span class="line">                main_links.append(link)</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> main_links:</span><br><span class="line">        time.sleep(<span class="number">0.7</span>)</span><br><span class="line">        link_url = link.get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">        result = extract_info(link_url,link.get(<span class="string">&#x27;position&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            all_results.append(result)</span><br><span class="line"></span><br><span class="line">    creat_json(all_results,location)</span><br><span class="line">    creat_excel(all_results,location)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(all_results))</span><br><span class="line">    <span class="built_in">print</span>(errschool)</span><br></pre></td></tr></table></figure>

<h1 id="从代码中学习"><a href="#从代码中学习" class="headerlink" title="从代码中学习"></a>从代码中学习</h1><p>发现通过代码实例来学习的效率确实要高很多，一下子就学会beautifulSoup和openpyxl的基础用法了。</p>
<h2 id="beautifulSoup"><a href="#beautifulSoup" class="headerlink" title="beautifulSoup"></a>beautifulSoup</h2><h3 id="获取页面的beautifulSoup对象"><a href="#获取页面的beautifulSoup对象" class="headerlink" title="获取页面的beautifulSoup对象"></a>获取页面的beautifulSoup对象</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">response = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> response.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;无法访问网页: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="根据需要获取标签"><a href="#根据需要获取标签" class="headerlink" title="根据需要获取标签"></a>根据需要获取标签</h3><table>
<thead>
<tr>
<th>soup.find(‘标签名’, [class_&#x3D;’类名’])</th>
<th>返回符合的第一个元素，元素仍然是soup对象</th>
</tr>
</thead>
<tbody><tr>
<td>soup.find_all(‘标签名’, [class_&#x3D;’类名’])</td>
<td>获取符合的所有元素，返回数组。数组中的每一个元素仍是soup对象</td>
</tr>
</tbody></table>
<h3 id="获取标签的属性值"><a href="#获取标签的属性值" class="headerlink" title="获取标签的属性值"></a>获取标签的属性值</h3><table>
<thead>
<tr>
<th>soup.text.strip()</th>
<th>获取标签内部的文本</th>
</tr>
</thead>
<tbody><tr>
<td>soup[’src’]</td>
<td>获取标签的src属性值</td>
</tr>
<tr>
<td>soup[’herf’]</td>
<td>获取标签的herf值</td>
</tr>
</tbody></table>
<p>爬取页面需要的东西好像就这些也就够了。</p>
<h2 id="openpyxl"><a href="#openpyxl" class="headerlink" title="openpyxl"></a>openpyxl</h2><h3 id="创建一个新的Excel对象"><a href="#创建一个新的Excel对象" class="headerlink" title="创建一个新的Excel对象"></a>创建一个新的Excel对象</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">workbook = openpyxl.Workbook()</span><br></pre></td></tr></table></figure>

<h3 id="创建一页新的sheet"><a href="#创建一页新的sheet" class="headerlink" title="创建一页新的sheet"></a>创建一页新的sheet</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">worksheet = workbook.active</span><br><span class="line">worksheet.title = <span class="string">&quot;sheet名&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="在特定的位置写入信息"><a href="#在特定的位置写入信息" class="headerlink" title="在特定的位置写入信息"></a>在特定的位置写入信息</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">worksheet[<span class="string">&#x27;A1&#x27;</span>] = <span class="string">&quot;学校&quot;</span></span><br><span class="line">worksheet[<span class="string">&#x27;B1&#x27;</span>] = <span class="string">&quot;内容&quot;</span></span><br><span class="line">worksheet[<span class="string">&#x27;C1&#x27;</span>] = <span class="string">&quot;链接&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="合并需要合并的单元格"><a href="#合并需要合并的单元格" class="headerlink" title="合并需要合并的单元格"></a>合并需要合并的单元格</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># merge_cells(&quot;左上角单位格：右下角单位格&quot;)</span></span><br><span class="line">worksheet.merge_cells(<span class="string">f&#x27;A<span class="subst">&#123;row_num - <span class="built_in">len</span>(item[<span class="string">&quot;content&quot;</span>])&#125;</span>:A<span class="subst">&#123;end_row&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="设置样式"><a href="#设置样式" class="headerlink" title="设置样式"></a>设置样式</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 定义样式</span></span><br><span class="line">    title_font = Font(size=<span class="number">12</span>, bold=<span class="literal">True</span>)</span><br><span class="line">    title_alignment = Alignment(vertical=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line">    url_font = Font(color=<span class="string">&quot;0000FF&quot;</span>, underline=<span class="string">&quot;single&quot;</span>)</span><br><span class="line">    border = Border(left=Side(style=<span class="string">&#x27;thin&#x27;</span>), right=Side(style=<span class="string">&#x27;thin&#x27;</span>), top=Side(style=<span class="string">&#x27;thin&#x27;</span>),bottom=Side(style=<span class="string">&#x27;thin&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置样式</span></span><br><span class="line">		cell = worksheet[<span class="string">f&#x27;A<span class="subst">&#123;row_num&#125;</span>&#x27;</span>]</span><br><span class="line">    cell.border = border</span><br><span class="line">    cell.alignment = title_alignment</span><br><span class="line">    cell.font = title_font</span><br><span class="line"><span class="comment"># 设置链接样式</span></span><br><span class="line">    worksheet[<span class="string">f&#x27;C<span class="subst">&#123;row_num&#125;</span>&#x27;</span>].font = url_font</span><br><span class="line">    worksheet[<span class="string">f&#x27;C<span class="subst">&#123;row_num&#125;</span>&#x27;</span>].hyperlink = content_src</span><br></pre></td></tr></table></figure>

<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 指定输出的Excel文件路径</span></span><br><span class="line">  output_excel_path = <span class="string">&#x27;output.xlsx&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 保存Excel文件</span></span><br><span class="line">  workbook.save(output_excel_path)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;数据已成功写入 <span class="subst">&#123;output_excel_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>只要掌握这些函数，把爬取的内容放到excel里就也没什么问题了</p>
<blockquote>
<p>发现通过ai生成基础代码来学习的效率真的很高，而且学习的过程也有趣许多，很容易看到学到的每一点东西的作用，不过似乎有点功利了。但先功利着吧，有意思毕竟也很重要呀！😉</p>
</blockquote>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>beautifulSoup</tag>
        <tag>openpyxl</tag>
      </tags>
  </entry>
</search>
